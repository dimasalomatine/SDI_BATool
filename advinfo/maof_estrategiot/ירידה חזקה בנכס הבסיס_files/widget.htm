<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- saved from url=(0246)https://my.nanorep.com/widget/widget.html?account=migdal#doctype=xhtml&referer=aHR0cHM6Ly93d3cubWlnZGFsLmNvLmlsL0hlL0ZpbmFuY2lhbFdvcmxkL01hZ2F6aW5lL1ppdlBuaW5pL1N0cmF0ZWdpZXMvUGFnZXMvc2hvcnRzaW50ZXRpYy5hc3B4&isFloat=true&notifyclick=true&cnf=true -->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	
	<title>nanoRep Widget</title>
	
	<!-- includes -->
    
    <script type="text/javascript">function initializeNS(a){var b=a.split(".");var d=window;for(var c=0;c<b.length;++c){d=d[b[c]];if(typeof(d)==="undefined"||!d){return{}}}return d}function isNSexists(a){var b=a.split(".");var d=window;for(var c=0;c<b.length;++c){d=d[b[c]];if(typeof(d)==="undefined"||!d){return false}}return true}ISQ=initializeNS("ISQ");nanoRep=ISQ;ISQ.version="2.3.1.21";var debugLevel=0;ISQ.Base=function Class(){};ISQ.Base.polymorphismCtor=function(b,a){a=ISQ.Tools.toArray(a);if(this.mBase!==null&&typeof(this.mBase.prototype.polymorphismCtor)==="function"){this.initBase.apply(this,a);this.mBase.prototype.polymorphismCtor(b,a)}this.ctor.apply(b,a)};ISQ.Base.extend=function(d){var b=function(){if(typeof(d)==="object"&&d.abstractClass&&this instanceof b){throw ("Trying to create an instance of an abstract class")}if(this.mBase!==null&&typeof(this.mBase.abstractClass)==="object"){for(var e in this.mBase.abstractClass){if(typeof(this[e])!=="function"){throw ("un-implemented abstract method: "+e)}}}this.polymorphismCtor(this,arguments);if(debugLevel>2){profiler.registerObjectCreation(this)}};for(var c in this.prototype){b.prototype[c]=this.prototype[c]}if(typeof(d)==="object"&&d.abstractClass){b.abstractClass={}}b.prototype.polymorphismCtor=ISQ.Base.polymorphismCtor;b.extend=this.extend;b.prototype.mBase=this;if(typeof(d)!=="object"||typeof(d.name)!=="string"){throw ("Class name is missing (ctorObject.name)")}var a=d.name.Trim();if(!a){throw ("Invalid class name")}b.prototype.__className__=b.__className__=a;return b};ISQ.Base.__className__="Base Class";ISQ.Base.prototype.__className__="Base Class";ISQ.Base.prototype.mBase=null;ISQ.Base.prototype.mIsDisposed=false;ISQ.Base.prototype.ctor=function(){};ISQ.Base.prototype.dtor=function(){delete this.mBase};ISQ.Base.prototype.initBase=function(){};ISQ.Base.prototype.isDisposed=function(){return this.mIsDisposed};ISQ.Base.prototype.executeBaseMethod=function(b,a){if(!this.mBase){throw ("ISQ.Base.prototype.executeBaseMethod: no base!")}this.mBase.prototype[b].apply(this,a||[])};ISQ.Base.prototype.dispose=function(){if(this.mIsDisposed){return false
}this.mIsDisposed=true;var b=this.dtor.apply(this,arguments);if(b===false){this.mIsDisposed=false;return false}if(debugLevel>2){profiler.registerObjectDisposal(this)}var a=this.mBase;while(a!==null){a.prototype.dtor.apply(this,arguments);a=a.prototype.mBase}this.__dispose__();return true};ISQ.Base.prototype.__dispose__=function(){for(var b in this){try{switch(b){case"mBase":case"__dispose__":case"polymorphismCtor":case"extend":case"__className__":continue;break}if(typeof(this[b])==="undefined"||this[b]===null){continue}if(typeof(this[b])!=="function"&&typeof(this[b])!=="object"){continue}if(typeof(this[b].dispose)==="function"){this[b].dispose()}if(this[b] instanceof Array){for(var c in this[b]){if(this[b][c]&&typeof(this[b][c].dispose)==="function"){this[b][c].dispose()}}}delete this[b]}catch(a){if(debugLevel>1){alert("base::__dispose__: error disposing:"+b)}}}};ISQ.Base.prototype.isDerivedOf=function(a,c){c=c===true;if(c&&this.__className__===a.__className__){return false}if(this.__className__===a.__className__){return true}var d=false;var b=this.mBase;while(b!==null&&!d){if(a.__className__===b.__className__){d=true}b=b.prototype.mBase}return d};ISQ.Base.isDerivedOf=function(a,b){if(a===null){return false}if(typeof(a)!=="object"||typeof(a.isDerivedOf)!=="function"){return false}return a.isDerivedOf(b)};ISQ.Profiler=function(){this.mAllocationArray=new Array();this.mDisposalArray=new Array();this.mCurrentArray=new Array();this.mPointerArray=new Array()};ISQ.Profiler.prototype.dispose=function(){delete this.mAllocationArray;delete this.mDisposalArray;delete this.mCurrentArray;delete this.mPointerArray};ISQ.Profiler.prototype.registerObjectCreation=function(c){var a=c.__className__;var b=this.mAllocationArray[a];if(typeof(b)==="undefined"){b=0}this.mAllocationArray[a]=++b;var b=this.mCurrentArray[a];if(typeof(b)==="undefined"){b=0}this.mCurrentArray[a]=++b;var d=this.mPointerArray[a];if(!d){d=new Array();this.mPointerArray[a]=d}d.push(c)};ISQ.Profiler.prototype.registerObjectDisposal=function(d){if(this.inCleaningProcedure){return
}var a=d.__className__;var b=this.mDisposalArray[a];if(typeof(b)==="undefined"){b=0}this.mDisposalArray[a]=++b;b=this.mCurrentArray[a];this.mCurrentArray[a]=--b;var e=this.mPointerArray[a];if(e){for(var c=0;c<e.length;++c){if(e[c]===d){e.splice(c,1);break}}}};ISQ.Profiler.prototype.reset=function(){this.inCleaningProcedure=false;this.mAllocationArray=new Array();this.mDisposalArray=new Array();this.mCurrentArray=new Array();this.mPointerArray=new Array()};ISQ.Profiler.prototype.validatePointerArray=function(){var a=new Array();for(var c in this.mPointerArray){var b=this.mPointerArray[c];var d=this.mCurrentArray[c];if(d!==b.length){a[c]=true}}return a};ISQ.Profiler.prototype.analyzeHandlers=function(){var e=this.mPointerArray["ISQ.Handler"];var a=new Array();for(var d=0;d<e.length;++d){var c=e[d];var b=c.context;if(!ISQ.Base.isDerivedOf(b,ISQ.Base)){continue}if(b.isDisposed()){a.push({name:b.__className__,instance:b,func:c.func})}}return a};ISQ.Profiler.prototype.emptyEvents=function(){var c=this.mPointerArray["ISQ.Event"];var a=0;for(var b=0;b<c.length;++b){if(c[b].count()===0){++a}}return a};ISQ.Profiler.prototype.emptyEventsContainers=function(){var c=new Array();var f;for(var a in this.mPointerArray){if(a==="ISQ.Handler"||a=="ISQ.Event"){continue}for(var d=0;d<this.mPointerArray[a].length;++d){f=this.mPointerArray[a][d];for(var g in f){try{switch(g){case"dispose":case"mIsDisposed":case"ctor":case"dtor":case"mBase":case"__dispose__":case"polymorphismCtor":case"extend":case"__className__":continue;break}if(typeof(f[g])==="undefined"||f[g]===null){continue}if(typeof(f[g])!=="function"&&typeof(f[g])!=="object"){continue}if(f[g].__className__==="ISQ.Event"){if(f[g].count()===0){if(!c[a]){c[a]=new Array()}if(typeof(c[a][g])==="undefined"){c[a][g]=1}else{++c[a][g]}}}}catch(b){}}}}return c};ISQ.Profiler.prototype.inCleaningProcedure=false;ISQ.Profiler.prototype.allocations=function(){return this.mAllocationArray};ISQ.Profiler.prototype.current=function(){return this.mCurrentArray};ISQ.Profiler.prototype.disposals=function(){return this.mDisposalArray
};ISQ.Profiler.prototype.pointers=function(){return this.mPointerArray};if(typeof(profiler)==="undefined"&&debugLevel>2){profiler=new ISQ.Profiler()};</script>
    <script type="text/javascript">Date.prototype.ToString=function(d,m){d=d+"";var j=new Array();var k;for(var f=0;f<d.length;++f){var a=d.charAt(f);if(a==="%"&&f!==d.length-1){k=d.charAt(++f);switch(k){case"d":var b=this.getDate();if(b<10){b="0"+b}j.push(b);break;case"m":var h="";if(d.charAt(f+1)==="m"){++f;h=this.getMonth()+1;switch(h){case 1:if(m){h=m.jan}else{h="Jan"}break;case 2:if(m){h=m.feb}else{h="Feb"}break;case 3:if(m){h=m.mar}else{h="Mar"}break;case 4:if(m){h=m.apr}else{h="Apr"}break;case 5:if(m){h=m.may}else{h="May"}break;case 6:if(m){h=m.jun}else{h="Jun"}break;case 7:if(m){h=m.jul}else{h="Jul"}break;case 8:if(m){h=m.aug}else{h="Aug"}break;case 9:if(m){h=m.sep}else{h="Sep"}break;case 10:if(m){h=m.oct}else{h="Oct"}break;case 11:if(m){h=m.nov}else{h="Nov"}break;case 12:if(m){h=m.dec}else{h="Dec"}break}}else{h=this.getMonth()+1;if(h<10){h="0"+h}}j.push(h);break;case"y":var n=this.getYear();if((ISQ.Http.browser.app!=="ie"||ISQ.Http.browser.isIE9||ISQ.Http.browser.isIE10)&&(!ISQ.Http.browser.isOpera||ISQ.Http.browser.full>="opera10.52")){n+=1900}j.push(n);break;case"H":var e=this.getHours();if(e<10){e="0"+e}j.push(e);break;case"M":var g=this.getMinutes();if(g<10){g="0"+g}j.push(g);break;case"S":var l=this.getSeconds();if(l<10){l="0"+l}j.push(l);break;default:j.push(d.charAt(f-1));j.push(d.charAt(f));break}}else{j.push(a)}}return j.join("")};String.prototype.Trim=function(){return this.replace(/^\s+|\s+$/g,"")};String.prototype.startsWith=function(b){if(this.length<b.length){return false}for(var a=0;a<b.length;++a){if(this.charAt(a)!==b.charAt(a)){return false}}return true};String.prototype.endsWith=function(b){if(this.length<b.length){return false}var c=b.length-1;for(var a=this.length-1;a>this.length-1-b.length;--a){if(b.charAt(c--)!==this.charAt(a)){return false}}return true};String.prototype.contains=function(a){return this.indexOf(a)!==-1};String.prototype.LastIndexOf=function(d,c){if(this.length===0||d===null){return -1}if(d.length>this.length){return -1}if(isNaN(c)){c=this.length-d.length}var a=false;for(var b=c;b>=0;--b){a=true;for(var e=0;
e<d.length;++e){if(this.charAt(b+e)!==d.charAt(e)){a=false;break}}if(a){return b}}return -1};String.prototype.LastIndexOf_char=function(a,c){c=c||this.length-1;for(var b=c;b>=0;--b){if(this.charAt(b)===a){return b}}return -1};String.prototype.setCharAt=function(b,a){if(b>this.length-1){return str}return this.substr(0,b)+a+this.substr(b+1)};String.prototype.countCharAppearances=function(a){var b=0;for(var c=0;c<this.length;++c){if(this.charAt(c)==a){++b}}return b};String.prototype.equals=function(e,d){if(!d){d=0}if(d+e.length>=this.length){return false}var c=0;var b=d+e.length;for(var a=d;a<b;++a){if(this.charAt(a)!=e.charAt(c++)){return false}}return true};</script>
    <script type="text/javascript">ISQ.Tools=initializeNS("ISQ.Tools");ISQ.Tools.stateEnum={KEY:5,VALUE:6};ISQ.Tools.stringToPairArray=function(h,b,k,i,j){var c=h.length;if(c===0){return null}var f=new Array();i=i!==false;j=j!==false;var g=ISQ.Tools.stateEnum.KEY;var d="";var a=new Array();var e=0;while(e<c){switch(g){case ISQ.Tools.stateEnum.KEY:if(h.charAt(e)!==b){a.push(h.charAt(e))}else{g=ISQ.Tools.stateEnum.VALUE;d=ISQ.Tools.getStringValue(a,i);a=new Array()}break;case ISQ.Tools.stateEnum.VALUE:if(h.charAt(e)!==k){a.push(h.charAt(e))}else{g=ISQ.Tools.stateEnum.KEY;f[d]=ISQ.Tools.getStringValue(a,j);a=new Array()}break}++e}if(g===ISQ.Tools.stateEnum.VALUE){f[d]=ISQ.Tools.getStringValue(a)}return f};ISQ.Tools.getStringValue=function(a,b){b=b===true;var c=unescape(a.join("").toString()).Trim();if(b){c=c.toLowerCase()}return c};ISQ.Tools.getNumber=function(c,a){var d=typeof(c);if(typeof(c)==="number"){return c}if(typeof(c)!=="string"){c=c.toString()}var b;if(c.contains(".")){b=parseFloat(c)}else{b=parseInt(c)}if(isNaN(b)){return typeof(a)==="number"?a:NaN}return b};ISQ.Tools.verifyNumber=function(b){var a=ISQ.Tools.getNumber(b);if(isNaN(a)){throw ("ISQ.Tools.verifyNumber: given value is not a number")}};ISQ.Tools.getEnumValue=function(a,c){if(typeof(a)!=="object"||c===null){return null}for(var b in a){if(a[b]==c){return b}}return null};ISQ.Tools.getOpacityFromRGBA=function(b){var a=b.LastIndexOf(",");if(a===-1){throw ("ISQ.Tools.getOpacityFromRGBA(): Invalid string")}if(b.countCharAppearances(",")===2){return 100}b=b.substring(a+1);return parseInt(b)};ISQ.Tools.RGBtoHex=function(c,b,a){return ISQ.Tools.toHex(c)+ISQ.Tools.toHex(b)+ISQ.Tools.toHex(a)};ISQ.Tools.RGBtoHex2=function(a){a=a.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);return"#"+ISQ.Tools.toHex(a[1])+ISQ.Tools.toHex(a[2])+ISQ.Tools.toHex(a[3])};ISQ.Tools.toHex=function(a){if(typeof(a)==="string"){a=parseInt(a)}if(typeof(a)!=="number"||a===0){return"00"}a=Math.max(0,a);a=Math.min(a,255);a=Math.round(a);return"0123456789ABCDEF".charAt((a-a%16)/16)+"0123456789ABCDEF".charAt(a%16)};ISQ.Tools.hexToRGB=function(a){var b={r:-1,g:-1,b:-1};
a=(a.charAt(0)=="#")?a.substring(1):a;b.r=parseInt(a.substring(0,2),16);b.g=parseInt(a.substring(2,4),16);b.b=parseInt(a.substring(4,6),16);return b};ISQ.Tools.getPrettyNumber=function(h,d,k){h=parseFloat(h);if(isNaN(h)){return h}d=d||2;if(k){if(h>1000000){return(h/1000000).toFixed(0)+"M"}if(h>1000){return(h/1000).toFixed(0)+"K"}}var j=h+"";var f=j.indexOf(".");var a="";if(f!==-1){a=j.substr(f+1,d);j=j.substr(0,f);h=parseInt(h)}if(h/1000>=1){var b=new Array(j.length+Math.floor((j.length-1)/3));var g=b.length;var c=0;for(var e=j.length-1;e>-1;--e){if(e<j.length-1&&c%3===0){b[g--]=","}b[g--]=j.charAt(e);++c}}else{b=new Array();b.push(j)}if(a===""){return b.join("")}else{return b.join("")+"."+a}};ISQ.Tools.formatPercentage=function(c){var b;var a=Math.abs(c);if(a>1000){b=(c/1000).toFixed(0)+"K "}else{if(a<1){b=c.toFixed(2)}else{if(a<10){b=c.toFixed(1)}else{b=c.toFixed(0)}}}return b+"%"};ISQ.Tools.toArray=function(d){if(d instanceof Array){return d}var b=new Array();if(typeof(d.length)!=="number"){b.push(d)}else{var c;if(d.length===0){for(c in d){b[c]=d[c]}}else{if(d.length>10000){_debug().insertText("Error converting object to an array. Object length: "+d.length);return new Array()}for(c=0;c<d.length;++c){b[c]=d[c]}}}return b};ISQ.Tools.getDateTicks=function(b,d,e,f,j){b=b.Trim();if(b===""){return -1}var c,g,k;var h=d.indexOf("dd");c=b.substr(h,2);if(isNaN(c)){return -1}h=d.indexOf("mm");g=b.substr(h,2);if(isNaN(g)){return -1}h=d.indexOf("yyyy");k=b.substr(h,4);if(isNaN(k)){return -1}var i=new Date();e=typeof(e)=="undefined"?i.getHours():e;f=typeof(f)=="undefined"?i.getMinutes():f;j=typeof(j)=="undefined"?i.getSeconds():j;var a=new Date(k,g-1,c,e,f,j);return Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds())};ISQ.Tools.getIPString=function(c){var b=false;if(c<0){c=-c;b=true}var d=new Array();if(b){d.push(256-(c%256))}else{d.push(c%256)}for(var a=2;a>=0;a--){c=Math.floor(c/256);d.push(".");if(b){d.push(255-(c%256))}else{d.push(c%256)}}return d.join("")};ISQ.Tools.getContentTypeByExtension=function(b,c){var a;
switch(b){case"bmp":a="image/bmp";break;case"gif":a="image/gif";break;case"jpg":case"jpeg":a="image/jpeg";break;case"png":a="image/png";break;case"tiff":case"tif":a="image/tiff";break;case"pdf":a="application/pdf";break;default:a="";break}if(c){return a}switch(b){case"doc":a="application/msword";break;case"docx":a="application/vnd.openxmlformats-officedocument.wordprocessingml.document";break;case"pdf":a="application/pdf";break;case"ppt":a="application/vnd.ms-powerpoint";break;case"pptx":a="application/vnd.openxmlformats-officedocument.presentationml.presentation";break;case"xlsx":a="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet";break;case"xls":a="application/vnd.ms-excel";break;case"csv":a="text/csv";break;case"xml":a="text/xml";break;case"txt":a="text/plain";break;case"zip":a="application/zip";break;case"ogg":a="application/ogg";break;case"mp3":a="audio/mpeg";break;case"wma":a="audio/x-ms-wma";break;case"wav":a="audio/x-wav";break;case"wmv":a="audio/x-ms-wmv";break;case"swf":a="application/x-shockwave-flash";break;case"avi":a="video/avi";break;case"mp4":a="video/mp4";break;case"mpg":case"mpeg":a="video/mpeg";break;case"qt":a="video/quicktime";break;default:a=""}return a};ISQ.Tools.extend=function(b,h){h=h||{};b=b===true;var d=arguments.length;var f=null;for(var c=2;c<d;c++){f=arguments[c];if(typeof(f)==="undefined"||f===null){continue}for(var e in f){var g=h[e],a=f[e];if(h===a){continue}if(typeof(a)==="undefined"){continue}if(b&&a!==null&&typeof(a)==="object"&&!a.nodeType){if(typeof(a.isDerivedOf)!=="function"||!a.isDerivedOf(ISQ.Base)){h[e]=ISQ.Tools.extend(true,g||(a.length!=null?[]:{}),a)}else{h[e]=a}}else{if(a!==undefined){h[e]=a}}}}return h};ISQ.Tools.addArrayToGC=function(b,a){b.add({dispose:function(){for(var c in a){a[c].dispose();a[c]=null}a=null}})};ISQ.Tools.foreach=function(a,b){for(var c in a){var d=null;if(ISQ.Base.isDerivedOf(b,ISQ.Handler)){d=b.handle(a[c],c)}else{d=b(a[c],c)}if(d===false){break}}};window.foreach=ISQ.Tools.foreach;ISQ.Tools.iteration=function(a,b){for(var c=0;
c<a.length;++c){var d=null;if(ISQ.Base.isDerivedOf(b,ISQ.Handler)){d=b.handle(a[c],c)}else{d=b(a[c],c)}if(d===false){break}}};window.iteration=ISQ.Tools.iteration;ISQ.Tools.addRemoveClickOutsideElementsListener=function(c,d,a,b){if(!ISQ.Tools.clickOutsideListeners){ISQ.Tools.clickOutsideListeners=new Array()}if(d){if(!c){throw ("ISQ.Tools.addRemoveClickOutsideElementsListener: invalid id")}if(!ISQ.Base.isDerivedOf(b,ISQ.Handler)){throw ("ISQ.Tools.addRemoveClickOutsideElementsListener: invalid handler")}if(!ISQ.Tools.clickOutsideListeners[c]){ISQ.Tools.clickOutsideListeners[c]={}}if(ISQ.Tools.clickOutsideListeners[c].registered){if(document.removeEventListener){document.removeEventListener("click",ISQ.Tools.clickOutsideListeners[c].func,true)}else{if(document.detachEvent){document.detachEvent("onclick",ISQ.Tools.clickOutsideListeners[c].func)}}}ISQ.Tools.clickOutsideListeners[c].func=function(e){if(ISQ.Tools.clickOutsideElements(e,a)){b.handle()}};ISQ.Tools.clickOutsideListeners[c].registered=true;if(document.addEventListener){document.addEventListener("click",ISQ.Tools.clickOutsideListeners[c].func,true)}else{if(document.attachEvent){document.attachEvent("onclick",ISQ.Tools.clickOutsideListeners[c].func)}}}else{if(ISQ.Tools.clickOutsideListeners[c]&&ISQ.Tools.clickOutsideListeners[c].registered){ISQ.Tools.clickOutsideListeners[c].registered=false;if(document.removeEventListener){document.removeEventListener("click",ISQ.Tools.clickOutsideListeners[c].func,true)}else{if(document.detachEvent){document.detachEvent("onclick",ISQ.Tools.clickOutsideListeners[c].func)}}}}};ISQ.Tools.clickOutsideElements=function(c,b){if(!b||!(b instanceof Array)){return false}var a=ISQ.Html.getDomEvent(c);while(a.target!==document.body){for(var d in b){if(a.target==b[d]){return false}}a.target=a.target.parentNode}if(a.target!==document.body){return false}return true};ISQ.Data=initializeNS("ISQ.Data");ISQ.Data.getEmailAddress=function(e){var a=/[\w-_\&.]+\@[\w-_]+\.+[\w-_.]+/g;var d=e.match(a);if(d===null||d.length===0){return null}var f=new RegExp();
f.compile("[~!#$%^&*()=`'\"\\/><?[]{}|]","g");var b=new Array();for(var c=0;c<d.length;++c){if(d[c].search(f)===-1){b.push(d[c])}}return b};ISQ.Data.checkString=function(e,f){var d=true;var c;switch(f){case"email":var a=/^[\w-_\&.]+\@([\w-_]+\.){1,}[\w-_\.]+$/;var g=new RegExp("[~!#$%^&*()=''\"\\/><?[]{}|]","g");return(e.search(g)===-1)&&(e.match(a))&&(e!=="");break;case"number":var b=/^[-]?[0-9]+\.?[0-9]?$/;return b.test(e);break;case"username":c=new RegExp(".+@.+");return(c.test(e));break;case"url":c=new RegExp("^https?://([a-zA-Z0-9]+.){1,}[a-zA-Z0-9]+");return(c.test(e));break}return d};ISQ.Data.checkTextWidth=function(c,b){var a=_("ellipsisDiv");if(!a){a=createDiv(null,"position:fixed;white-space:nowrap;top:0px;left:0px;z-index:-5;visibility:hidden");a.id="ellipsisDiv"}else{clearNode(a)}ISQ.Data.copyElementFontStyle(b,a);a.innerHTML=c;document.body.insertBefore(a,document.body.firstChild);return a.offsetWidth};ISQ.Data.copyElementFontStyle=function(b,c){if(!c||!b){return}var a=null;if(ISQ.Http.browser.isIE9&&document.body.style.overflow){a=document.body.style.overflow;document.body.style.overflow="hidden"}c.style.fontSize=ISQ.CSS.getElementStyle(b,"font-size");c.style.fontWeight=ISQ.CSS.getElementStyle(b,"font-weight");c.style.fontFamily=ISQ.CSS.getElementStyle(b,"font-family");c.style.fontStyle=ISQ.CSS.getElementStyle(b,"font-style");c.style.textDecoration=ISQ.CSS.getElementStyle(b,"text-decoration");if(a){document.body.style.overflow=a}};ISQ.Data.autoEllipseText=function(j,l,b,e,c,a){var k;var d=false;a=a||null;if(e){k=e.offsetWidth}else{k=ISQ.Data.checkTextWidth(j,b);e=_("ellipsisDiv")}var h=j;if(k>l){d=true;e.innerHTML="";var i=0,f=j.length,g;do{g=i+Math.floor((f-i)/2);e.innerHTML=j.substr(0,g)+"...";if(e.offsetWidth<l){i=g}else{f=g}}while((f-i)>1);if(e.offsetWidth>l){j=j.substr(0,g-1)+"..."}else{j=e.innerHTML}}else{if(c){return}}if(b){b.innerHTML=j;if(d){b.setAttribute("title",h)}}else{return j}};ISQ.Data.jsonToString=function(d,e,c){if(!e){e=new Array()}if(d instanceof Array){e.push("[");for(var b=0;b<d.length;
++b){if(b!==0){e.push(",")}ISQ.Data.jsonToString(d[b],e,true)}e.push("]")}else{if(d===null){e.push("null")}else{if(typeof(d)==="object"){e.push("{");var a=true;for(var b in d){if(!a){e.push(",")}a=false;e.push(b);e.push(": ");ISQ.Data.jsonToString(d[b],e,true)}e.push("}")}else{if(typeof(d)==="string"){e.push("'");e.push(d);e.push("'")}else{e.push(d)}}}}if(!c){return e.join("")}};ISQ.Data.blockCreditCardNumbers=function(h,f){var e=/(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|6(?:011|5[0-9][0-9])[0-9]{12}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|(?:2131|1800|35\d{3})\d{11})/g;var k=h.replace(/ /g,"").replace(/-/g,"").replace(/\n/g,"").replace(/\r/g,"");var m=k;var d=k.match(e);if(!d||d.length==0){return h}for(var a=0;a<d.length;++a){var c=d[a];var g=new Array();for(var b=0;b<c.length;++b){g.push(f)}m=m.replace(c,g.join(""))}var l=0;for(var a=0;a<h.length;++a){if(h.charAt(a)==" "||h.charAt(a)=="-"){continue}if(k.charAt(l)!=m.charAt(l)){h=h.setCharAt(a,f)}l++}return h};ISQ.Data.createLink=function(e,h,f,c,b,g,a){if(!e||!h){return""}if(b&&g){e=ISQ.Data.unHTML(ISQ.Data.breakWords(e))}else{if(b){e=ISQ.Data.breakWords(e)}else{if(g){e=ISQ.Data.unHTML(e)}}}if(a&&!h.startsWith("http://")&&!h.startsWith("https://")){h="http://"+h}var d=new Array();d.push('<a href="');d.push(h);if(f){d.push('" target="');d.push(f)}if(c){d.push('" class="');d.push(c)}d.push('">');d.push(e);d.push("</a>");return d.join("")};ISQ.Data.parseURL=function(a,b){if(!a){return""}return a.replace(/[A-Za-z]+:\/\/[A-Za-z0-9-_]+\.[A-Za-z0-9-_:%&\?\/.=]+/,function(c){return ISQ.Data.createLink(c,c,b)})};ISQ.Data.parseTwitterStatus=function(d){if(!d){return""}var c=new ISQ.Data.EntityParser(d);var a=new Array();var b={};while(c.getNextSegment(b)){b.segment=ISQ.Data.parseURL(b.segment,"_blank");b.segment=b.segment.replace(/[@]+[A-Za-z0-9-_]+/g,function(e){var g=e.replace("@","");var f="http://twitter.com/"+g;return ISQ.Data.createLink(e,f,"_blank")});b.segment=b.segment.replace(/[#]+[A-Za-z0-9-_]+/g,function(e){var f=e.replace("#","%23");var g="http://search.twitter.com/search?q="+f;
return ISQ.Data.createLink(e,g,"_blank")});a.push(b.segment);a.push(b.entity)}return a.join("")};ISQ.Data.parseArticleContext=function(f,e){result=new Array();var d=0,b=false,c=0,a;while(d<f.length){d=f.indexOf(",",c);if(d===-1){d=f.length}b=!b;if(b){a=f.substring(c,d++)}else{if(!e){result[a]=f.substring(c,d++)}else{result.push(f.substring(c,d++))}}c=d}return result};ISQ.Data.uniqueId=function(){var a=new Date;return a.getTime()};ISQ.Data.nowMili=new Date().getTime();ISQ.Data.dayInMs=24*60*60*1000;ISQ.Tools.fixIE7DropDownInIframe=function(a){var c,b;c=+this.getAttribute("size")||1;b=1;if(a==="click"&&c===1){b=this.options.length}this.setAttribute("size",b)};ISQ.Tools.forceNumericValue=function(a,b){if(b){a.setAttribute("maxLength",b)}$(document).ready(function(){$(a).keydown(function(c){if(c.keyCode==46||c.keyCode==8||c.keyCode==9||c.keyCode==27||(c.keyCode==65&&c.ctrlKey===true)||(c.keyCode>=35&&c.keyCode<=39)){return}else{if(c.shiftKey||(c.keyCode<48||c.keyCode>57)&&(c.keyCode<96||c.keyCode>105)){c.preventDefault()}}})})};ISQ.Data.ADDRESS_DELIMITER=String.fromCharCode(187);ISQ.Data.MailAddress=function(a,b){this.address=a||null;this.displayName=b||null;this.isValid=this.validate()};ISQ.Data.MailAddress.prototype.validate=function(){if(!this.address){return false}return ISQ.Data.checkString(this.address,"email")};ISQ.Data.MailAddress.prototype.asString=function(){var a=new Array();if(this.displayName){if(this.displayName.indexOf('"')==-1){a.push('"');a.push(this.displayName.replace(/\"/g,'\\"'));a.push('"')}if(this.address.indexOf("<")==-1){a.push("<");a.push(this.address);a.push(">")}a.push(" ")}else{a.push(this.address)}return a.join("")};ISQ.Data.parseEmailAddress=function(h){if(!h){return null}var d={none:0,address:1,name:2,nameQuotes:3};var b,c;var e=new Array();var a=function(){if(b==null){if(c!=null){e.push(new ISQ.Data.MailAddress(c))}else{throw ("ISQ.Data.parseEmailAddress: Error parsing input string: "+h)}}else{if(c==null){e.push(new ISQ.Data.MailAddress(b))}else{e.push(new ISQ.Data.MailAddress(b,c))}}b=null;
c=null};var i=d.none;var g=0,f=0;for(f=0;f<h.length;++f){switch(i){case d.none:if(/\s/.test(h[f])){continue}else{switch(h[f]){case"<":i=d.address;g=f+1;break;case'"':i=d.nameQuotes;g=f+1;break;case";":case",":a();i=d.none;break;default:i=d.name;g=f;break}}break;case d.address:if(h[f]==">"){b=h.substring(g,f);i=d.none}break;case d.name:switch(h[f]){case"<":c=h.substring(g,f);i=d.address;g=f+1;break;case";":case",":c=h.substring(g,f);a();i=d.none;break}break;case d.nameQuotes:switch(h[f]){case"\\":if(h.length>f+1){++f}break;case'"':c=h.substring(g,f);i=d.none;break}break}}switch(i){case d.address:b=h.substring(g,f);break;case d.name:if(h[f-1]=='"'||h[f-1]==">"){c=h.substring(g,f-1)}else{c=h.substring(g,f)}break}a();i=d.none;return e};ISQ.Data.createDelimitedEmailAddressList=function(h){var g=new Array();var b=new Array();var d=new Array();try{d=ISQ.Data.parseEmailAddress(h)||new Array()}catch(a){b.push(h)}for(var c=0;c<d.length;c++){var f=d[c];if(!f.address||!f.isValid){b.push(f);continue}if(g.length>0){g.push(ISQ.Data.ADDRESS_DELIMITER)}g.push(f.asString())}return{list:g.join(""),errors:b}};ISQ.Data.htmlDecode=function(b){var a=createElement("div");a.innerHTML=b;return a.innerHTML.Trim()};ISQ.Data.getTextFromHtml=function(b){var a=createElement("div");a.innerHTML=b;return($(a).text()).Trim()};ISQ.Data.stripHtml=function(b,d){var g=0,f=-1,c=0;var a=new Array();var e;d=d||"";g=b.indexOf("<"+d,g);while(g>-1){a.push(b.substr(c,g-c));f=b.indexOf(">",g);c=g+1;if(f!=-1){e=b.substr(g+1,f-g-1).toLowerCase();if(e.startsWith("br")||e=="p"){a.push("\n ")}c=f+1}else{a.push("<")}g=b.indexOf("<",c)}if(c!=b.length){a.push(b.substr(c,b.length-c))}return a.join("")};ISQ.Data.unHTML=function(a){if(!a){return""}a=a.replace(/\</g,"&lt;");a=a.replace(/\>/g,"&gt;");a=a.replace(/&lt;wbr\/&gt;/g,"<wbr/>");return a};ISQ.Data.toHTML=function(a){if(!a){return""}a=a.replace(/&lt;/g,"<");a=a.replace(/&gt;/g,">");return a};ISQ.Data.escapeJS=function(a){if(!a){return""}a=a.replace(/\'/g,"\\'");return a};ISQ.Data.processHTMLstring=function(s,j){j=j||{};
var k={text:"",script:""};if(!s){return k}var n=s.indexOf("<");if(n===-1){if(j.decodeEntities){s=ISQ.Data.htmlDecode(s)}if(j.wordBreak){k.text=ISQ.Data.breakWords(s)}else{k.text=s}return k}var c=-1;var h=0;var i=-1;var m=new Array();var l=null;var r;do{if(h!==n){r=s.substring(h,n);if(j.decodeEntities){r=ISQ.Data.htmlDecode(r)}if(j.wordBreak){ISQ.Data.breakWords(r,m,true)}else{m.push(r)}}i=n;c=s.indexOf(">",n+1);if(c===-1){break}var g="";var p=s.charAt(n+1);if(s.charAt(n+2)===" "&&(p==="A"||p==="a")){c=s.indexOf("</a>",n);if(c===-1){break}c+=4;var o=s.substring(n,c);var q=createDiv(null);q.innerHTML=o;var f=q.firstChild;if(q.parentNode!=null){q.parentNode.removeChild(q)}q=null;if(f.nodeName!=="A"){break}var b=f.getAttribute("nanoreplinkid");if(b&&j.questionTagFunction){j.questionTagFunction(m,b,f.innerHTML,o,j.questionTagCustomParams||null)}else{if(f.getAttribute("href")!="javascript:void(0)"&&j.allowLinksInSameWindow!==true){var a=f.getAttribute("target");switch(a){case"blank":case"top":case"_blank":case"_top":case"_parent":case"parent":break;default:f.setAttribute("target","_blank");break}}g=elementToString(f,ISQ.Data.processHTMLstring(f.innerHTML,j).text)}}else{if(s.equals("script ",n+1)||s.equals("script>",n+1)&&j.doNotProcessScriptTag!==true){var e=s.indexOf(">",n+6);if(e===-1){break}var d=s.indexOf("</",e);if(d===-1){break}if(l===null){l=new Array()}l.push(s.substring(e+1,d));l.push(";");c=s.indexOf(">",d+2);if(c===-1){break}++c}else{g=s.substring(n,++c)}}m.push(g);h=c;n=s.indexOf("<",h)}while(n!==-1);if(c===-1){r=s.substring(i);if(j.decodeEntities){r=ISQ.Data.htmlDecode(r)}if(j.wordBreak){ISQ.Data.breakWords(r,m,true)}else{m.push(r)}}else{r=s.substring(h);if(j.decodeEntities){r=ISQ.Data.htmlDecode(r)}if(j.wordBreak){ISQ.Data.breakWords(r,m,true)}else{m.push(r)}}k.text=m.join("");if(l){k.script=l.join("")}return k};ISQ.Data.getDBAnswerAsHtml=function(f,d,c,b){try{return ISQ.Data.processHTMLstring(f,{wordBreak:d!==true,questionTagFunction:c,questionTagCustomParams:b,decodeEntities:false})}catch(a){if(typeof(_debug)==="function"){_debug().insertText("ISQ.Data.getDBAnswerAsHtml exception: "+f)
}return{text:"",error:a}}};ISQ.Data.breakWords=function(e,d,f){if(!e){if(d){return}return""}var c=new ISQ.Data.EntityParser(e);var b={};var a;if(d){a=d}else{a=new Array()}while(c.getNextSegment(b)){ISQ.Data.breakWords_internal(b.segment,a,f);if(b.entity){a.push(b.entity)}}c.dispose();if(d){return}return a.join("")};ISQ.Data.breakWords_internal=function(f,e,g){if(!f||!e){return}var h="<wbr/>";if(ISQ.Http.browser.full.startsWith("safari3")||ISQ.Http.browser.isOpera||ISQ.Http.browser.isIE8||ISQ.Http.browser.isIE9||ISQ.Http.browser.isIE10){h="&#8203;"}if(g&&ISQ.Http.browser.isIE8){h="&shy;"}var c=f.length;var j=0;var d=-1;var a=false;var b=0;for(b=0;b<c;++b){if(f.charAt(b)===" "){j=0}else{if(j>=20&&j%2===0){e.push(f.substring(d+1,b+1));d=b;e.push(h);++j}else{++j}}}e.push(f.substring(d+1))};ISQ.Data.getTextDirAlign=function(f){if(typeof(f)!=="string"){throw ("getTextDirAlign: no txt")}var d={align:"left",dir:"ltr",alignOpp:"right"};var c=0;var e=0;for(var b=0;b<f.length;++b){var a=f.charCodeAt(b);if(a>=48&&a<=57){continue}if(a>=1456&&a<=1524){++e}else{++c}}if(e>=c){d.align="right";d.dir="rtl";d.alignOpp="left"}return d};ISQ.Data.getURLencodedString=function(a){if(!a){return""}return escape(ISQ.Tools.Base64._utf8_encode(a))};ISQ.Data.getURLdecodedString=function(a){if(!a){return""}return ISQ.Tools.Base64._utf8_decode(unescape(a))};ISQ.Data.EntityParser=ISQ.Base.extend({name:"ISQ.Data.EntityParser"});ISQ.Data.EntityParser.prototype.ctor=function(a){if(!a){throw ("ISQ.Data.EntityParser: no txt")}this.mOriginalText=a;this.mIndex=0};ISQ.Data.EntityParser.prototype.dtor=function(){};ISQ.Data.EntityParser.prototype.getNextSegment=function(c){if(this.mIndex==this.mOriginalText.length){return false}var b=this.mOriginalText.indexOf("&",this.mIndex);var a=this.mOriginalText.indexOf(";",b);if(b===-1||a===-1||a-b>8){c.entity=null;c.segment=this.mOriginalText.substring(this.mIndex);this.mIndex=this.mOriginalText.length}else{if(b!==-1){c.entity=this.mOriginalText.substring(b,++a);var d=this.mOriginalText.substring(this.mIndex,b);c.segment=d;
this.mIndex=a}}return true};ISQ.Data.EntityParser.prototype.mOriginalText;ISQ.Data.EntityParser.prototype.mLastEntityFound=null;ISQ.Data.EntityParser.prototype.mAlteredText;ISQ.Data.EntityParser.prototype.mIndex=0;ISQ.Data.EntityParser.prototype.mNextIndex=-1;ISQ.Data.decodeEntities=function(b){if(typeof(jQuery)==="function"){return $("<div/>").html(b).text()}try{if(!ISQ.Data.entityDecoderElement){ISQ.Data.entityDecoderElement=createElement("textarea",document.body,"display:none;visibility:hidden;position:absolute;top:100px;left:13px;")}ISQ.Data.entityDecoderElement.innerHTML=ISQ.Data.unHTML(b);return ISQ.Data.entityDecoderElement.value}catch(a){return b}};ISQ.Data.Xml=initializeNS("ISQ.Data.Xml");ISQ.Data.Xml.toXML=function(c){var d=null;if(ISQ.Http.browser.app==="ie"){try{d=new ActiveXObject("Microsoft.XMLDOM");d.async="false";d.loadXML(c)}catch(a){d=null}}else{try{var b=new DOMParser();d=b.parseFromString(c,"text/xml");b=null}catch(a){d=null}}return d};ISQ.Data.Xml.getChildsByName=function(e,c){if(!e){return null}var b=e.childNodes.length;var d=null;for(var a=0;a<b;++a){if(e.childNodes[a].nodeName===c){if(d===null){d=new Array()}d.push(e.childNodes[a])}}return d};ISQ.Data.Xml.downloadXML=function(c,a){c=c||null;a=a||null;if(!c||typeof(a)!=="function"){return}var b=null;if(ISQ.Http.browser.app==="ie"){b=new ActiveXObject("Microsoft.XMLDOM");b.async=true;b.onreadystatechange=function(){if(b.readyState===4){a(b)}};b.load(c)}else{b=new XMLHttpRequest();if(ISQ.Http.browser.app==="ff"&&(ISQ.Http.browser.version==="3"||ISQ.Http.browser.version==="3.6")){b.onload=function(){var e=b.responseText;var d=new DOMParser();var f=d.parseFromString(e,"text/xml");a(f)}}else{b.onreadystatechange=function(){if(b.readyState===4){var e=b.responseText;var d=new DOMParser();var f=d.parseFromString(e,"text/xml");a(f)}}}b.open("GET",c,true);b.send(null)}};ISQ.Data.Xml.getFirstElementByName=function(e,c){if(!e){return null}if(e.nodeName===c){return e}var a=e.childNodes;if(a.length===0){return null}for(var b=0;b<a.length;++b){var d=ISQ.Data.Xml.getFirstElementByName(a[b],c);
if(d!==null){return d}}return null};ISQ.Tools.FileLoader=initializeNS("ISQ.Tools.FileLoader");ISQ.Tools.FileLoader.ajaxPool=null;ISQ.Tools.FileLoader.getAjaxPool=function(){if(ISQ.Tools.FileLoader.ajaxPool===null){var a=(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7)?1:2;ISQ.Tools.FileLoader.ajaxPool=new Ajax.Pool("/kb",a,Ajax.methodEnum.GET,Ajax.typeEnum.ASYNC,10000);ISQ.Tools.FileLoader.ajaxPool.incomingResponseEvent.addHandler(ISQ.Tools.FileLoader.loadResponse);if(isNSexists("ISQ.Console")){sessionGC().add(ISQ.Tools.FileLoader.ajaxPool)}}return ISQ.Tools.FileLoader.ajaxPool};ISQ.Tools.FileLoader.load=function(h,d,i){if(d&&!ISQ.Base.isDerivedOf(d,ISQ.Handler)){d=new ISQ.Handler(d)}var g=h.indexOf("?");var f;if(g===-1){f=h}else{f=h.substr(0,g)}if(f.endsWith(".js")){var a=ISQ.Tools.FileLoader.getAjaxPool();a.add(null,h,new Ajax.Token({callback:d,tag:i}));return}var c=null;var e=document.getElementsByTagName("head")[0];if(f.endsWith(".css")){c=createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",h);c.async=true;c.defer=true}if(c===null){return}var b=null;if(d){var b=function(){if(i){d.handle(i)}else{d.handle()}d.dispose();d=null}}if(ISQ.Http.browser.app!=="ie"){if(b){(function(){if(!c.sheet){setTimeout(arguments.callee,30);return}b()})()}}else{c.onreadystatechange=function(){if(this.readyState!=="complete"&&this.readyState!=="loaded"){return}if(b){b();b=null}}}e.appendChild(c)};ISQ.Tools.FileLoader.loadResponse=function(response){try{eval(response.text)}catch(ex){_debug().insertText("ISQ.Tools.FileLoader.loadResponse: Error loading js file ( "+response.request.mUrl+").\n"+ex)}if(!response.token||!response.token.callback){return}var tag=response.token.tag;if(tag){response.token.callback.handle(tag)}else{response.token.callback.handle()}response.token.callback.dispose();response.token.callback=null};ISQ.Tools.appendScript=function(c,a){var b=document.createElement("script");b.type="text/javascript";b.async=true;b.defer=true;if(c instanceof Array){c=c.join("")
}if(a){if(ISQ.Http.browser.app!=="ie"){b.onload=a}else{b.onreadystatechange=function(){if(this.readyState!=="complete"&&this.readyState!=="loaded"){return}a()}}}b.src=c;document.getElementsByTagName("head")[0].appendChild(b)};ISQ.Tools.Time=initializeNS("ISQ.Tools.Time");ISQ.Tools.Time.ticksDiff=62135596800000;ISQ.Tools.Time.toClientTicks=function(a){return a-ISQ.Tools.Time.ticksDiff};ISQ.Tools.Time.toServerTicks=function(a){return a+ISQ.Tools.Time.ticksDiff};ISQ.Tools.Time.secondsInTime=function(c,a,d){var b={};d=d||86400;b.days=parseInt(c/d);if(a){b.days=ISQ.Tools.getPrettyNumber(b.days)}c=c%d;b.hours=parseInt(c/3600);c=c%3600;b.minutes=parseInt(c/60);b.seconds=c%60;return b};ISQ.Tools.Time.stringToSpan=function(h){if(!h.contains(":")){throw ("ISQ.Tools.Time.stringToSpan: Incorrect string format")}var g=h.split(":");if(g.length>4){throw ("ISQ.Tools.Time.stringToSpan: Incorrect string format")}var b=0,c=0,e=0,f=0;for(var d=0;d<g.length;++d){if(g[d].startsWith("0")){var a=0;while(g[d].charAt(a)==="0"){++a}if(a!==g[d].length){g[d]=g[d].substring(a)}}}if(g.length==4){b=parseInt(g[0]);c=parseInt(g[1]);e=parseInt(g[2]);f=parseInt(g[3])}if(g.length==3){c=parseInt(g[0]);e=parseInt(g[1]);f=parseInt(g[2])}if(g.length==2){c=parseInt(g[0]);e=parseInt(g[1])}return{days:b,hours:c,minutes:e,seconds:f}};ISQ.Tools.Time.drawSLATime=function(d,b,c){var e=new Array();var a=false;if(b){ISQ.Tools.Time.appendTimeToStringBuilder(b,e)}else{if(d){ISQ.Tools.Time.appendTimeToStringBuilder(d,e)}}if(e.length===0){e.push(" N/A ")}c.innerHTML=e.join("")};ISQ.Tools.Time.appendTimeToStringBuilder=function(e,d,a){a=a!==false;var b=d.length;var c=false;if(e.days>0){d.push(e.days);d.push("d");a=false}if(e.hours!=0||e.days>0){if(d.length!==b){d.push(" ")}d.push(e.hours);d.push("h");a=false;c=true}if(e.days===0&&(e.minutes>0||c)){if(d.length!==b){d.push(" ")}d.push(e.minutes);d.push("m")}if((a&&e.seconds>0)||d.length===b){if(d.length!==b){d.push(" ")}d.push(e.seconds);d.push("s")}};ISQ.Tools.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(j){var k="";
var a,b,c,d,e,f,g;var h=0;while(h<j.length){a=j.charCodeAt(h++);b=j.charCodeAt(h++);c=j.charCodeAt(h++);d=a>>2;e=((a&3)<<4)|(b>>4);f=((b&15)<<2)|(c>>6);g=c&63;if(isNaN(b)){f=g=64}else{if(isNaN(c)){g=64}}k=k+this._keyStr.charAt(d)+this._keyStr.charAt(e)+this._keyStr.charAt(f)+this._keyStr.charAt(g)}return k},decode:function(j){var k="";var a,b,c;var d,e,f,g;var h=0;j=j.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(h<j.length){d=this._keyStr.indexOf(j.charAt(h++));e=this._keyStr.indexOf(j.charAt(h++));f=this._keyStr.indexOf(j.charAt(h++));g=this._keyStr.indexOf(j.charAt(h++));a=(d<<2)|(e>>4);b=((e&15)<<4)|(f>>2);c=((f&3)<<6)|g;k=k+String.fromCharCode(a);if(f!=64){k=k+String.fromCharCode(b)}if(g!=64){k=k+String.fromCharCode(c)}}return k},_utf8_encode:function(d){d=d.replace(/\r\n/g,"\n");var e="";for(var b=0;b<d.length;b++){var a=d.charCodeAt(b);if(a<128){e+=String.fromCharCode(a)}else{if((a>127)&&(a<2048)){e+=String.fromCharCode((a>>6)|192);e+=String.fromCharCode((a&63)|128)}else{e+=String.fromCharCode((a>>12)|224);e+=String.fromCharCode(((a>>6)&63)|128);e+=String.fromCharCode((a&63)|128)}}}return e},_utf8_decode:function(e){var d="";var b=0;var a=c1=c2=0;while(b<e.length){a=e.charCodeAt(b);if(a<128){d+=String.fromCharCode(a);b++}else{if((a>191)&&(a<224)){c2=e.charCodeAt(b+1);d+=String.fromCharCode(((a&31)<<6)|(c2&63));b+=2}else{c2=e.charCodeAt(b+1);c3=e.charCodeAt(b+2);d+=String.fromCharCode(((a&15)<<12)|((c2&63)<<6)|(c3&63));b+=3}}}return d},encodeString:function(d){if(!d){return""}var a=false;for(var b=0;b<d.length&&!a;++b){if(d.charCodeAt(b)>127){a=true}}var c;if(a){d=ISQ.Tools.Base64._utf8_encode(d)}return ISQ.Tools.Base64.encode(d)},decodeString:function(a){var d=ISQ.Tools.Base64.decode(a);var b=false;for(var c=0;c<d.length&&!b;++c){if(d.charCodeAt(c)>127){b=true}}if(b){d=ISQ.Tools.Base64._utf8_decode(d)}return d}};ISQ.Tools.BigUInt256=null;ISQ.Tools.ConvertFromByteArray=function(b,j,d){if(ISQ.Tools.BigUInt256===null){ISQ.Tools.BigUInt256=new ISQ.Tools.BigUInt("256")}var e;var a;switch(j){case"Int64":e=d+8;break;case"Int32":e=d+4;
break;default:throw ("ISQ.Tools.ConvertFromByteArray: invalid type");break}if(b.length<e){throw ("ISQ.Tools.ConvertFromByteArray: invalid offset")}var a=new ISQ.Tools.BigUInt("0");for(var c=e-1;c>=d;--c){var f=a.multiply(ISQ.Tools.BigUInt256);a=f;var h=new ISQ.Tools.BigUInt(b.charCodeAt(c));f=a.add(h);a=f}var g=a.toString();return g};ISQ.Tools.ConvertToByteArray=function(g,h){if(ISQ.Tools.BigUInt256===null){ISQ.Tools.BigUInt256=new ISQ.Tools.BigUInt("256")}var b="";var a;var d=0;switch(h){case"Int64":d=8;break;case"Int32":d=4;break;default:throw ("ISQ.Tools.ConvertFromByteArray: invalid type");break}var a=new ISQ.Tools.BigUInt(g);for(var c=0;c<d;++c){var e={};var f=a.divide(ISQ.Tools.BigUInt256,e);a=f;b=b+String.fromCharCode(e.value.toString())}return b};ISQ.Tools.getHex=function(g){var a=new ISQ.Tools.BigUInt(16);var c=new ISQ.Tools.BigUInt(g);var f=new Array();var e={value:null};var b=0;while(true&&++b<=100){c=c.divide(a,e);var d=e.value.toString();switch(d){case"":f.push("0");break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":f.push(d);break;case"10":f.push("A");break;case"11":f.push("B");break;case"12":f.push("C");break;case"13":f.push("D");break;case"14":f.push("E");break;case"15":f.push("F");break}var d=c.toString();if(!d||d==="0"){break}}f.reverse();return f.join("")};ISQ.Tools.compareArrays=function(a,b,f){if(a===b){return true}if(!a&&!b){return true}if(!a||!b){return false}if(a.length!==b.length){return false}for(var d in a){var g=a[d];var c=false;for(var e in b){if(b[e]===g){c=true;break}}if(!c){return false}}if(f){return true}return ISQ.Tools.compareArrays(b,a,true)};ISQ.Tools.reverseArray=function(a){var d=a.length;for(var b=0;b<a.length;++b){var e=0;for(var c=1;c<d;++c){var f=a[e];a[e]=a[c];a[c]=f;++e}--d}};ISQ.Tools.disposeArray=function(a){if(!a){return}for(var b=0;b<a.length;++b){if(!a[b]){continue}if(a[b] instanceof Array){ISQ.Tools.disposeArray(a[b]);continue}if(typeof(a[b].dispose)==="function"){a[b].dispose()}a[b]=null;delete a[b]}};ISQ.Tools.Languages={ar:"Arabic",bg:"Bulgarian",cs:"Czech",da:"Danish",de:"German",el:"Greek, Modern",en:"English",es:"Spanish",et:"Estonian",fi:"Finnish",fr:"French",hi:"Hindi",hu:"Hungarian",id:"Indonesian",it:"Italian",iw:"Hebrew",ja:"Japanese",ko:"Korean",lt:"Lithuanian",lv:"Latvian",nl:"Dutch",no:"Norwegian",pl:"Polish",pt:"Portuguese",ro:"Romanian, Moldavian, Moldovan",ru:"Russian",sk:"Slovak",sl:"Slovene",sv:"Swedish",th:"Thai",tr:"Turkish",uk:"Ukrainian",vi:"Vietnamese",zh:"Chinese"};
ISQ.Tools.LanguageSynonym={"zh-CHS":"Chinese","zh-CHT":"Chinese","zh-CN":"Chinese",he:"Hebrew"};ISQ.Tools.UniformLanguageCode={he:"iw","zh-CHS":"zh","zh-CHT":"zh","zh-CN":"zh"};ISQ.Tools.getUniformLanguageCode=function(a){if(!a){return null}var b=ISQ.Tools.UniformLanguageCode[a];if(b){return b}return a};ISQ.Tools.getLanguageName=function(b){var a=ISQ.Tools.Languages[b];if(!a){a=ISQ.Tools.LanguageSynonym[b]}if(!a){return null}return a};ISQ.Tools.HTML=initializeNS("ISQ.Tools.HTML");ISQ.Tools.HTML.openPopup=function(g,c,h,a,e){var b=(screen.width/2)-(h/2);var f=(screen.height/2)-(a/2);var d=e||"no";return window.open(g,c,"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars="+d+", resizable=no, copyhistory=no, width="+h+", height="+a+", top="+f+", left="+b)};</script>
    <script type="text/javascript">if(typeof(ISQ.Infra)==="undefined"){ISQ.Infra={}}ISQ.Infra.Queue=ISQ.Base.extend({name:"ISQ.Infra.Queue"});ISQ.Infra.Queue.prototype.ctor=function(){};ISQ.Infra.Queue.prototype.dtor=function(){this.reset();delete this.mArray};ISQ.Infra.Queue.prototype.mArray=null;ISQ.Infra.Queue.prototype.mLength=0;ISQ.Infra.Queue.prototype.mDndx=0;ISQ.Infra.Queue.prototype.mEndx=0;ISQ.Infra.Queue.prototype.mCount=0;ISQ.Infra.Queue.prototype.count=function(){return this.mCount};ISQ.Infra.Queue.prototype.init=function(){this.mLength=5;this.mArray=new Array(this.mLength);for(var a=0;a<this.mLength;++a){this.mArray[a]=null}};ISQ.Infra.Queue.prototype.enqueue=function(a){if(a===null){return}if(this.mArray===null){this.init()}if(this.mArray[this.mEndx]!==null){this.enlarge()}this.mArray[this.mEndx++]=a;if(this.mEndx===this.mLength){this.mEndx=0}++this.mCount};ISQ.Infra.Queue.prototype.priorityEnqueue=function(c){if(c===null){return}if(this.mArray===null){this.init()}var a=new Array();a.push(c);var b=this.mCount+1;while(this.mCount>0){a.push(this.dequeue())}this.mDndx=0;this.mEndx=a.length;if(this.mLength<b){this.mLength*=2}this.mCount=b;this.mArray=a};ISQ.Infra.Queue.prototype.enlarge=function(){var a=new Array();var b=this.mCount;while(this.mCount>0){a.push(this.dequeue())}this.mDndx=0;this.mEndx=a.length;this.mLength*=2;this.mCount=b;this.mArray=a};ISQ.Infra.Queue.prototype.dequeue=function(){if(this.mCount===0){return null}if(this.mDndx===this.mLength){this.mDndx=0}var a=this.mArray[this.mDndx];this.mArray[this.mDndx++]=null;--this.mCount;return a};ISQ.Infra.Queue.prototype.reset=function(){this.mDndx=0;this.mEndx=0;this.mCount=0;if(this.mArray!==null){for(var a=0;a<this.mArray.length;++a){if(this.mArray[a]){if(typeof(this.mArray[a].dispose)==="function"){this.mArray[a].dispose()}delete this.mArray[a]}}}};</script>
    <script type="text/javascript">if(typeof(ISQ.Infra)==="undefined"){ISQ.Infra={}}ISQ.Infra.LinkedList=ISQ.Base.extend({name:"ISQ.Infra.LinkedList"});ISQ.Infra.LinkedList.prototype.ctor=function(){};ISQ.Infra.LinkedList.prototype.dtor=function(){var b=this.mHead;while(b!==null){var a=b;b=b.mNext;a.dispose()}this.mHead=null;this.mTail=null;this.mCount=0};ISQ.Infra.LinkedList.prototype.mHead=null;ISQ.Infra.LinkedList.prototype.mTail=null;ISQ.Infra.LinkedList.prototype.mCount=0;ISQ.Infra.LinkedList.prototype.head=function(){return this.mHead};ISQ.Infra.LinkedList.prototype.tail=function(){return this.mTail};ISQ.Infra.LinkedList.prototype.count=function(){return this.mCount};ISQ.Infra.LinkedList.prototype.addFirst=function(b){var a=b;if(!ISQ.Base.isDerivedOf(a,ISQ.Infra.LinkedListNode)){a=new ISQ.Infra.LinkedListNode(b,this)}if(a.mList!==this){throw ("ISQ.Infra.LinkedList.addFirst() ")}if(this.mHead===null){this.mHead=a;this.mTail=a}else{this.mHead.mPrevious=a;a.mNext=this.mHead;this.mHead=a}++this.mCount;return a};ISQ.Infra.LinkedList.prototype.addLast=function(b){var a=b;if(!ISQ.Base.isDerivedOf(a,ISQ.Infra.LinkedListNode)){a=new ISQ.Infra.LinkedListNode(b,this)}if(a.mList!==this){throw ("ISQ.Infra.LinkedList.addLast() tried to remove non-existing value")}if(this.mTail===null){this.mHead=a;this.mTail=a}else{this.mTail.mNext=a;a.mPrevious=this.mTail;this.mTail=a}++this.mCount;return a};ISQ.Infra.LinkedList.prototype.setFirst=function(a){if(this.head()===a){return a}this.remove(a,false);this.addFirst(a);return a};ISQ.Infra.LinkedList.prototype.setLast=function(a){if(this.tail()===a){return a}this.remove(a,false);this.addLast(a);return a};ISQ.Infra.LinkedList.prototype.remove=function(a,b){if(!ISQ.Base.isDerivedOf(a,ISQ.Infra.LinkedListNode)){throw ("ISQ.Infra.LinkedList.remove() Unexpected node type")}if(a.mList!==this){throw ("ISQ.Infra.LinkedList.remove() tried to remove non-existing value")}if(this.mCount===1){this.mHead=null;this.mTail=null}else{if(this.mHead===a){this.mHead=a.mNext;this.mHead.mPrevious=null}else{if(this.mTail===a){this.mTail=a.mPrevious;
this.mTail.mNext=null}else{a.mPrevious.mNext=a.mNext;a.mNext.mPrevious=a.mPrevious}}}a.mNext=null;a.mPrevious=null;--this.mCount;if(b!==false){a.dispose()}};ISQ.Infra.LinkedList.prototype.contains=function(b){var a=this.mHead;while(a!==null){if(a===b){return true}a=a.mNext}return false};ISQ.Infra.LinkedListNode=ISQ.Base.extend({name:"ISQ.Infra.LinkedListNode"});ISQ.Infra.LinkedListNode.prototype.ctor=function(){this.mData=arguments[0];this.mList=arguments[1];this.mPrevious=null;this.mNext=null};ISQ.Infra.LinkedListNode.prototype.dtor=function(){this.mData=null;delete this.mData;delete this.mNext;delete this.mPrevious;delete this.mList};ISQ.Infra.LinkedListNode.prototype.mData=null;ISQ.Infra.LinkedListNode.prototype.mNext=null;ISQ.Infra.LinkedListNode.prototype.mPrevious=null;ISQ.Infra.LinkedListNode.prototype.mList=null;ISQ.Infra.LinkedListNode.prototype.data=function(){if(arguments.length===0){return this.mData}this.mData=arguments[0]};ISQ.Infra.LinkedListNode.prototype.next=function(){return this.mNext};ISQ.Infra.LinkedListNode.prototype.previous=function(){return this.mPrevious};</script>
    <script type="text/javascript">if(typeof(ISQ.Infra)==="undefined"){ISQ.Infra={}}ISQ.Infra.Stack=ISQ.Base.extend({name:"ISQ.Infra.Stack"});ISQ.Infra.Stack.prototype.ctor=function(){};ISQ.Infra.Stack.prototype.dtor=function(){this.clear()};ISQ.Infra.Stack.prototype.mArr=null;ISQ.Infra.Stack.prototype.mIndex=-1;ISQ.Infra.Stack.prototype.pop=function(){var a=this.mArr[this.mIndex];this.mArr[this.mIndex--]=null;return a};ISQ.Infra.Stack.prototype.peek=function(){if(this.mIndex===-1){return null}return this.mArr[this.mIndex]};ISQ.Infra.Stack.prototype.count=function(){return this.mIndex};ISQ.Infra.Stack.prototype.push=function(a){if(!this.mArr){this.mArr=new Array();this.mIndex=-1}this.mArr[++this.mIndex]=a};ISQ.Infra.Stack.prototype.clear=function(){this.mArr=null};</script>
    <script type="text/javascript">ISQ.Event=ISQ.Base.extend({name:"ISQ.Event"});ISQ.Event.prototype.ctor=function(){this.mCount=0};ISQ.Event.prototype.dtor=function(){if(this.handlers!==null){var b=this.handlers.length;for(var a=0;a<b;++a){if(this.handlers[a]!==null){this.handlers[a].dispose()}}delete this.handlers}this.handlers=null};ISQ.Event.prototype.handlers=null;ISQ.Event.prototype.mCount=0;ISQ.Event.prototype.mRemovedHandler=false;ISQ.Event.prototype.dispatch=function(){if(this.isDisposed()){return}if(this.handlers===null){return}var d=this.handlers.length;for(var c=0;c<d;++c){if(this.isDisposed()){return}var b=this.handlers[c];try{if(b!==null){b.handle.apply(b,arguments)}}catch(a){if(debugLevel&&typeof(ISQ.Debug)!=="undefined"){ISQ.Debug.insertText("Exception in event dispatch: "+a);ISQ.Debug.insertText("Handler:");ISQ.Debug.insertText("Func: "+b.func);ISQ.Debug.insertText("Context: "+b.context);ISQ.Debug.insertStackCallback();ISQ.Debug.insertText("Exception is rolled away");throw (a)}}}if(this.isDisposed()){return}if(this.mRemovedHandler){this.cleanDisposedHandlers()}};ISQ.Event.prototype.cleanDisposedHandlers=function(){if(!this.mRemovedHandler){return}var b=this.handlers.length;for(var a=0;a<b;++a){if(this.handlers[a]===null){this.handlers.splice(a,1);--a;--b}}this.mRemovedHandler=false};ISQ.Event.prototype.addHandlerObject=function(b){if(this.isDisposed()){return}if(this.handlers===null){this.handlers=new Array()}var c=this.handlers.length;for(i=0;i<c;++i){var a=this.handlers[i];if(a!==null&&a.func===b.func&&a.context===b.context){return}}this.handlers.push(b);++this.mCount;this.cleanDisposedHandlers();return b};ISQ.Event.prototype.addHandler=function(b,a){if(this.isDisposed()){return}if(this.handlers===null){this.handlers=new Array()}var e=this.handlers.length;for(i=0;i<e;++i){var c=this.handlers[i];if(c!==null&&c.func===b&&c.context===a){return}}var d=new ISQ.Handler(b,a);this.handlers.push(d);++this.mCount;b=null;a=null;this.cleanDisposedHandlers();return d};ISQ.Event.prototype.removeHandlerObject=function(b){if(this.handlers===null){return
}var d=this.handlers.length;var a=null;var c;for(c=0;c<d;++c){if(this.handlers[c]===b){--this.mCount;this.handlers[c]=null;break}}this.mRemovedHandler=true;b.dispose()};ISQ.Event.prototype.removeHandler=function(b,a){if(this.handlers===null){return}a=a||null;var e=this.handlers.length;var c=null;var d;for(d=0;(d<e&&c===null);++d){if(this.handlers[d]!==null&&this.handlers[d].func===b&&this.handlers[d].context===a){c=this.handlers[d];this.handlers[d]=null;--this.mCount;break}}this.mRemovedHandler=true;if(c!==null){c.dispose()}b=null;a=null};ISQ.Event.prototype.count=function(){return this.mCount};ISQ.Handler=ISQ.Base.extend({name:"ISQ.Handler"});ISQ.Handler.prototype.ctor=function(b,a){b=b||null;a=a||null;if(typeof(b)!=="function"){throw ("Error creating event handler: no function is passed")}this.func=b;this.context=a;return this};ISQ.Handler.prototype.dtor=function(){delete this.func;delete this.context;this.func=null;this.context=null};ISQ.Handler.prototype.handle=function(){return this.func.apply(this.context,arguments)};ISQ.Handler.prototype.handleArgumentArray=function(){if(arguments.length===0){throw ("invalid use of ISQ.Handler.handleArgumentArray")}if(typeof(arguments[0].length)!=="number"){throw ("invalid array in ISQ.Handler.handleArgumentArray")}return this.func.apply(this.context,ISQ.Tools.toArray(arguments[0]))};ISQ.Handler.prototype.func=null;ISQ.Handler.prototype.context=null;ISQ.Timer=ISQ.Base.extend({name:"ISQ.Timer"});ISQ.Timer.prototype.ctor=function(b,a){if(!ISQ.Base.isDerivedOf(b,ISQ.Handler)){throw ("ISQ.Timer.ctor: invalid handler")}this.mHandler=b;this.mDisposeAfterTimerElapsed=a!==false;this.mParams=new Array();if(arguments.length<=2){return}for(var c=2;c<arguments.length;++c){this.mParams.push(arguments[c])}};ISQ.Timer.prototype.dtor=function(){this.start=null;if(this.mTimer){clearTimeout(this.mTimer);this.mTimer=null}};ISQ.Timer.prototype.start=function(b){if(typeof(b)!=="number"){throw ("Timer interval illegal")}if(arguments.length>1){this.mParams=new Array();for(var a=1;a<arguments.length;
++a){this.mParams.push(arguments[a])}}var c=this;this.mTimer=setTimeout(function(){if(c.mTimer===null){return}c.timerElapsed.apply(c,new Array())},b)};ISQ.Timer.prototype.timerElapsed=function(){this.mHandler.handleArgumentArray(this.mParams);if(this.mDisposeAfterTimerElapsed){this.dispose()}};ISQ.Timer.prototype.cancel=function(){if(this.mTimer===null){return}clearTimeout(this.mTimer);this.mTimer=null};ISQ.Timer.prototype.isRunning=function(){return this.mTimer!==null};ISQ.Timer.prototype.mDisposeAfterTimerElapsed=true;ISQ.Timer.prototype.mTimer=null;ISQ.Timer.prototype.mHandler=null;ISQ.Timer.prototype.mParams=null;</script>
    <script type="text/javascript">ISQ.Html=initializeNS("ISQ.Html");ISQ.Html._=function(c,a){if(!c){return null}var b=null;if(typeof(c)==="string"){if(ISQ.Http.browser.app==="ie"){if(!ISQ.Html.IE_idMap){ISQ.Html.IE_idMap=new Array();if(typeof(ISQ.Console)!=="undefined"&&typeof(sessionGC)==="function"){sessionGC().add(ISQ.Html.IE_idMap);ISQ.Html.IE_idMap.dispose=function(){ISQ.Html.IE_idMap=new Array()}}}if(!a){b=ISQ.Html.IE_idMap[c]}if(!b||a===true){b=document.getElementById(c);if(b){ISQ.Html.IE_idMap[c]=b}}}else{b=document.getElementById(c)}}else{if(typeof(c)==="object"&&typeof(c.parentNode)!=="undefined"&&typeof(c.nodeName)!=="undefined"){b=c}}return b};if(typeof(window._)!=="function"){window._=ISQ.Html._}ISQ.Html.setMinHeight=function(a,b){a=_(a);if(a===null){return}if(a.offsetHeight<b){a.style.height=b+"px"}};ISQ.Html.actualHeight=function(d){var c=$(d);var e=c.height();var b=c.css("border-top");if(b){e+=parseInt(b)}var a=c.css("border-bottom");if(a){e+=parseInt(a)}var g=c.css("padding-top");if(g){e+=parseInt(g)}var f=c.css("padding-bottom");if(f){e+=parseInt(f)}return e};ISQ.Html.screenSize=function(){return ISQ.Html.pageSize(true)};ISQ.Html.scrollBarWidth=function(){return 17};ISQ.Html.scrollBarWidth_afterCheck=function(){var a=ISQ.Html.screenSize();if(document.body.scrollHeight===a.h){return 0}return ISQ.Html.scrollBarWidth()};ISQ.Html.pageSize=function(b,a){var c={w:0,h:0};var d={};if(self.innerHeight){d.w=self.innerWidth;d.h=self.innerHeight}else{if(document.documentElement&&document.documentElement.clientHeight){d.w=document.documentElement.clientWidth;d.h=document.documentElement.clientHeight}else{if(document.body){d.w=document.body.clientWidth;d.h=document.body.clientHeight}}}var f=ISQ.Html.getScroll("width");var e=ISQ.Html.getScroll("height");if(b||d.w>f){c.w=d.w}else{c.w=f}if(b||d.h>e){c.h=d.h}else{c.h=e}if(e>d.h){if(ISQ.CSS.getElementStyle(document.body,"overflow")==="hidden"){return c}if(ISQ.CSS.getElementStyle(document.body,"overflow-y")==="hidden"){return c}if(ISQ.Http.browser.app!=="ie"){if(!a){c.w-=ISQ.Html.scrollBarWidth()}}else{if(a){c.w+=ISQ.Html.scrollBarWidth()
}}}return c};ISQ.Html.getScroll=function(c){c=c||"top";var a=0;var b=0;if(c==="top"){if(ISQ.Http.browser.app!=="ie"||!ISQ.Http.browser.isIE9||ISQ.Http.browser.isIE10){b=window.pageYOffset}if(ISQ.Http.browser.app!=="ie"){b=ISQ.Html.returnMaxScroll(b,window.scrollY)}b=ISQ.Html.returnMaxScroll(b,document.body.scrollTop);b=ISQ.Html.returnMaxScroll(b,document.documentElement.scrollTop);b=ISQ.Html.returnMaxScroll(b,document.body.parentNode.scrollTop)}else{if(c==="left"){if(ISQ.Http.browser.app!=="ie"||!ISQ.Http.browser.isIE9||ISQ.Http.browser.isIE10){b=window.pageXOffset}if(ISQ.Http.browser.app!=="ie"){b=ISQ.Html.returnMaxScroll(b,window.scrollX)}b=ISQ.Html.returnMaxScroll(b,document.body.scrollLeft);b=ISQ.Html.returnMaxScroll(b,document.documentElement.scrollLeft);b=ISQ.Html.returnMaxScroll(b,document.body.parentNode.scrollLeft)}else{if(c==="height"){switch(ISQ.Http.browser.app){case"chrome":case"ff":case"opera":case"safari":if(window.top===window){b=document.documentElement.scrollHeight}else{b=document.body.scrollHeight}break;default:b=ISQ.Html.returnMaxScroll(b,document.body.scrollHeight);b=ISQ.Html.returnMaxScroll(b,document.documentElement.scrollHeight);b=ISQ.Html.returnMaxScroll(b,document.body.parentNode.scrollHeight);break}}else{if(c==="width"){b=ISQ.Html.returnMaxScroll(b,document.body.scrollWidth);b=ISQ.Html.returnMaxScroll(b,document.documentElement.scrollWidth);b=ISQ.Html.returnMaxScroll(b,document.body.parentNode.scrollWidth)}}}}return b};ISQ.Html.returnMaxScroll=function(a,b){if(a>b){return a}return b};ISQ.Html.pageDirection=function(){if(!ISQ.Html._pageDirection){ISQ.Html._pageDirection=document.body.getAttribute("dir");if(!ISQ.Html._pageDirection){ISQ.Html._pageDirection=ISQ.CSS.getValue(document.body,"direction")}if(!ISQ.Html._pageDirection){ISQ.Html._pageDirection="ltr"}}return ISQ.Html._pageDirection};ISQ.Html.position=function(b,e){var d={x:-1,y:-1};b=_(b);if(b===null){return d}var c=_(e)||document.body;d.x=0;d.y=0;var a=b;while(a!==null&&a!==c&&a!==document.body&&a.nodeName!=="HTML"){d.x+=a.offsetLeft;
d.x-=a.scrollLeft;d.y+=a.offsetTop;d.y-=a.scrollTop;a=a.offsetParent}if(c!==document.body&&(a===document.body||a===null)){d.x=-1;d.y=-1}b=null;e=null;return d};ISQ.Html.getEventTarget=function(a){return window.event?window.event.srcElement:a.target};ISQ.Html.getDomEvent=function(a){if(ISQ.Base.isDerivedOf(a,ISQ.Html.DomEvent)){return a}return new ISQ.Html.DomEvent(a)};ISQ.Html.DomEvent=ISQ.Base.extend({name:"ISQ.Html.DomEvent"});ISQ.Html.DomEvent.prototype.ctor=function(a){this.domEvent=window.event||a;this.target=ISQ.Html.getEventTarget(a)};ISQ.Html.DomEvent.prototype.dtor=function(){delete target;delete domEvent};ISQ.Html.DomEvent.prototype.cancel=function(){if(window.event){this.domEvent.cancelBubble=true}else{this.domEvent.stopPropagation()}};ISQ.Html.DomEvent.prototype.target=null;ISQ.Html.DomEvent.prototype.domEvent=null;ISQ.Html.Scroll=initializeNS("ISQ.Html.Scroll");ISQ.Html.Scroll.init=function(a){if(ISQ.Html.Scroll._wasInit){return}ISQ.Html.Scroll._wasInit=true;ISQ.Html.Scroll._running=true;if(typeof(ISQ.Console)!=="undefined"&&typeof(sessionGC)==="function"){sessionGC().add(ISQ.Html.Scroll)}ISQ.Html.Scroll.event=new ISQ.Event();if(window.addEventListener){window.addEventListener("scroll",ISQ.Html.Scroll.scrollHandler,true)}else{if(window.attachEvent){window.attachEvent("onscroll",ISQ.Html.Scroll.scrollHandler)}}};ISQ.Html.Scroll.scrollHandler=function(a){if(!ISQ.Html.Scroll._running){return}var c=ISQ.Html.getEventTarget(a);if(c!==null&&c!==document){return}var b={left:ISQ.Html.getScroll("left"),top:ISQ.Html.getScroll("top")};if(ISQ.Html.Scroll.mLastScroll&&ISQ.Html.Scroll.mLastScroll.left===b.left&&ISQ.Html.Scroll.mLastScroll.top===b.top){return}ISQ.Html.Scroll.mLastScroll=b;ISQ.Html.Scroll.timeStamp=new Date().getTime();if(ISQ.Html.Scroll.timer!==null){return}ISQ.Html.Scroll.timer=setInterval(function(){if(ISQ.Html.Scroll._running){var d=new Date().getTime();if(d-ISQ.Html.Scroll.timeStamp<ISQ.Html.Scroll.diff){return}ISQ.Html.Scroll.event.dispatch(ISQ.Html.Scroll.mLastScroll,ISQ.Html.pageSize(),ISQ.Html.screenSize())
}clearInterval(ISQ.Html.Scroll.timer);ISQ.Html.Scroll.timer=null},ISQ.Html.Scroll.interval)};ISQ.Html.Scroll.dispose=function(){ISQ.Html.Scroll._running=false;if(window.removeEventListener){window.removeEventListener("scroll",ISQ.Html.Scroll.scrollHandler,true)}else{if(window.detachEvent){window.detachEvent("onscroll",ISQ.Html.Scroll.scrollHandler)}}ISQ.Html.Scroll.event.dispose();ISQ.Html.Scroll.event=null};ISQ.Html.Scroll.interval=30;ISQ.Html.Scroll.diff=65;ISQ.Html.Scroll.timer=null;ISQ.Html.ReSize=initializeNS("ISQ.Html.ReSize");ISQ.Html.ReSize.enumListenTo={width:1,height:2,both:3};ISQ.Html.ReSize.init=function(a,b){if(!this.mListenTo){this.mListenTo=0}this.mListenTo|=a;ISQ.Html.ReSize.mSkipTimer|=b===true;if(ISQ.Html.ReSize.wasInit()){return}ISQ.Html.ReSize._wasInit=true;ISQ.Html.ReSize._running=true;if(typeof(ISQ.Console)!=="undefined"&&typeof(sessionGC)=="function"){sessionGC().add(ISQ.Html.ReSize)}ISQ.Html.ReSize.Event=new ISQ.Event();ISQ.Html.ReSize.mWindowSize_thisEvent=ISQ.Html.screenSize();ISQ.Html.ReSize.mWindowSize_browserEvent=ISQ.Html.screenSize();if(window.addEventListener){window.addEventListener("resize",ISQ.Html.ReSize.resizeHandler,true)}else{if(window.attachEvent){window.attachEvent("onresize",ISQ.Html.ReSize.resizeHandler)}}};ISQ.Html.ReSize.resizeHandler=function(){if(!ISQ.Html.ReSize._running){return}var a=ISQ.Html.screenSize();if(!ISQ.Html.ReSize.mWindowSize_thisEvent||!ISQ.Html.ReSize.mWindowSize_browserEvent){return}if((a.w===ISQ.Html.ReSize.mWindowSize_thisEvent.w||(ISQ.Html.ReSize.mListenTo&ISQ.Html.ReSize.enumListenTo.width)===0)&&(a.h===ISQ.Html.ReSize.mWindowSize_thisEvent.h||(ISQ.Html.ReSize.mListenTo&ISQ.Html.ReSize.enumListenTo.height)===0)){if(ISQ.Html.ReSize.timer){clearInterval(ISQ.Html.ReSize.timer);ISQ.Html.ReSize.timer=null}return}if((a.w===ISQ.Html.ReSize.mWindowSize_browserEvent.w||(ISQ.Html.ReSize.mListenTo&ISQ.Html.ReSize.enumListenTo.width)===0)&&(a.h===ISQ.Html.ReSize.mWindowSize_browserEvent.h||(ISQ.Html.ReSize.mListenTo&ISQ.Html.ReSize.enumListenTo.height)===0)){return
}ISQ.Html.ReSize.mWindowSize_browserEvent=a;ISQ.Html.ReSize.timeStamp=new Date().getTime();if(ISQ.Html.ReSize.timer!=null&&typeof(ISQ.Html.ReSize.timer)!=="undefined"){return}if(ISQ.Html.ReSize.mSkipTimer){ISQ.Html.ReSize.Event.dispatch();ISQ.Html.ReSize.mWindowSize_thisEvent=ISQ.Html.ReSize.mWindowSize_browserEvent;return}ISQ.Html.ReSize.timer=setInterval(function(){if(ISQ.Html.ReSize._running){var b=new Date().getTime();if(b-ISQ.Html.ReSize.timeStamp<ISQ.Html.ReSize.diff){return}ISQ.Html.ReSize.Event.dispatch();ISQ.Html.ReSize.mWindowSize_thisEvent=ISQ.Html.ReSize.mWindowSize_browserEvent}clearInterval(ISQ.Html.ReSize.timer);ISQ.Html.ReSize.timer=null},ISQ.Html.ReSize.interval)};ISQ.Html.ReSize.wasInit=function(){if(typeof(this._wasInit)==="undefined"){return false}return this._wasInit};ISQ.Html.ReSize.suspend=function(){if(!ISQ.Html.ReSize.wasInit()){return}ISQ.Html.ReSize._running=false};ISQ.Html.ReSize.resume=function(){if(!ISQ.Html.ReSize.wasInit()){return}ISQ.Html.ReSize._running=true};ISQ.Html.ReSize.dispose=function(){if(!ISQ.Html.ReSize.wasInit()){return}ISQ.Html.ReSize._running=false;if(window.removeEventListener){window.removeEventListener("resize",ISQ.Html.ReSize.resizeHandler,true)}else{if(window.detachEvent){window.detachEvent("onresize",ISQ.Html.ReSize.resizeHandler)}}ISQ.Html.ReSize.Event.dispose();ISQ.Html.ReSize.Event=null};ISQ.Html.ReSize.interval=100;ISQ.Html.ReSize.diff=199;ISQ.Html._doc=document;ISQ.Html.createElement=function(e,c,d){var b=ISQ.Html._doc.createElement(e);var a=_(c);if(a!==null){a.appendChild(b)}if(typeof(d)==="string"){ISQ.CSS.setStyle(b,d)}return b};var createElement=ISQ.Html.createElement;ISQ.Html.createDiv=function(c,d){var b=ISQ.Html._doc.createElement("div");var a=_(c);if(a!==null){a.appendChild(b)}if(typeof(d)==="string"){ISQ.CSS.setStyle(b,d)}return b};var createDiv=ISQ.Html.createDiv;ISQ.Html.createTable=function(c,f,b,d,a){var e=createElement("table",c);e.setAttribute("cellPadding",0);e.setAttribute("cellSpacing",0);e.setAttribute("border",0);if(typeof(a)==="string"){e.setAttribute("align",a)
}if(typeof(f)==="number"||typeof(f)==="string"){e.setAttribute("width",f)}if(typeof(b)==="string"){e.setAttribute("dir",b);e.style.direction=b}if(typeof(d)==="string"){ISQ.CSS.setStyle(e,d)}return createElement("tbody",e)};var createTable=ISQ.Html.createTable;ISQ.Html.createRow=function(b,a,d){var c=createElement("tr",b);if(typeof(a)==="string"){ISQ.CSS.setStyle(c,a)}if(typeof(d)==="string"){c.setAttribute("valign",d)}return c};var createRow=ISQ.Html.createRow;ISQ.Html.addSpaceRow=function(d,b,a,c){var f=createRow(d);var e=createElement("td",f);e.style.height=b;if(typeof(c)==="string"){ISQ.CSS.setStyle(f,c)}if(a){e.setAttribute("colSpan",a)}return f};var addSpaceRow=ISQ.Html.addSpaceRow;ISQ.Html.addSpaceTd=function(d,e,b){var c=createElement("td",d);c.style.width=e;if(typeof(b)==="number"){c.setAttribute("rowSpan",b)}var a=createDiv(c,"width:"+e);a.innerHTML="&nbsp;";return c};var addSpaceTd=ISQ.Html.addSpaceTd;ISQ.Html.createTd=function(e,a,f,c,b){var d=createElement("td",e);if(f){d.setAttribute("vAlign",f)}if(a){d.setAttribute("align",a)}if(typeof(c)==="string"){ISQ.CSS.setStyle(d,c)}if(b){d.setAttribute("colSpan",b)}return d};var createTd=ISQ.Html.createTd;ISQ.Html.clearNode=function(a,c){if(typeof(a)==="undefined"||a===null){return null}if(a.nodeType!==1){return a}c=c!==false;if(c){var b=a.nodeName;switch(b){case"TR":case"TBODY":case"TABLE":break;default:a.innerHTML="";return a}}while(a.firstChild!==null){if(c){ISQ.Html.clearNode(a.firstChild,true)}a.removeChild(a.firstChild)}return a};var clearNode=ISQ.Html.clearNode;ISQ.Html.createInput=function(j,f,h,k,b,g){var c;var d=false;if(ISQ.Http.browser.app==="ie"){try{var i=new Array();i.push("<input type='");i.push(j);i.push("' name='");i.push(f);i.push("' id='");i.push(f);i.push("' />");c=ISQ.Html._doc.createElement(i.join(""));if(h){h.appendChild(c)}d=true}catch(a){d=false}}if(!d){c=createElement("input",h);c.type=j;c.name=c.id=f}if(typeof(k)!=="undefined"&&k!==null){c.value=k}if(typeof(b)==="string"){c.errorStyle=b;c.error=function(){ISQ.CSS.setStyle(this,this.errorStyle);
c.hasError=true}}c.okStyle=typeof(g)==="string"?g:"";ISQ.CSS.setStyle(c,c.okStyle);c.ok=function(){ISQ.CSS.setStyle(this,this.okStyle);c.hasError=false};return c};var createInput=ISQ.Html.createInput;ISQ.Html.createInput_new=function(a){return ISQ.Html.createInput(a.type,a.name,a.parent,a.value||null,a.errorStyle||null,a.style||null)};var createInput_new=ISQ.Html.createInput_new;ISQ.Html.createCheckbox=function(f,d,g,j,a,c){var h=createTable(g);var d=d||f||"cb_"+Math.floor(Math.random()*1000000);if(a){ISQ.CSS.setStyle(h.parentNode,a)}var k=createRow(h);var i=createTd(k);var b=createInput("checkbox",d,i);b.style.margin="0 3px 0";b.id=d;b.checked=b.defaultChecked=c===true;i=createTd(k);var e=createElement("label",i);e.setAttribute("for",b.id);e.innerHTML=j;b.label=e;return b};var createCheckbox=ISQ.Html.createCheckbox;ISQ.Html.createCheckbox_new=function(a){return createCheckbox(a.name,a.id,a.parent,a.text,a.style,a.checked)};var createCheckbox_new=ISQ.Html.createCheckbox_new;ISQ.Html.createRadio=function(g,e,h,l,n,b,c,a){var j=createTable(h);if(a){j.parentNode.setAttribute("align",a);var d=(a.toLowerCase()==="left"?"right":"left");ISQ.CSS.setStyle(j.parentNode,"margin-"+d+": 5px")}var m=createRow(j);var k=createTd(m);var i=createInput("radio",g,k,n,b,b);i.style.margin="0 3px 0";i.id=e||"radio_"+Math.floor(Math.random()*1000000);if(typeof("checked")!="undefined"){i.checked=c}k=createTd(m);var f=createElement("label",k);f.setAttribute("for",i.id);f.innerHTML=l;return i};var createRadio=ISQ.Html.createRadio;ISQ.Html.createForm=function(d){var a=createElement("form",d.parent);if(typeof(d.action)==="string"){a.action=d.action}if(typeof(d.method)==="string"){a.method=d.method}if(typeof(d.id)==="string"){a.id=from.name=d.id}if(typeof(d.name)==="string"){from.name=d.name;if(typeof(d.id)!=="string"){a.id=from.name}}var b=typeof(d.onsubmit)!=="undefined"&&d.onsubmit!==null?d.onsubmit:null;if(b!==null){b.executed=false}a.onsubmit=function(e){if(b!==null){if(!b.executed){b.handle(ISQ.Html.getDomEvent(e));b.executed=true}else{b.executed=false
}}return false};function c(f){var e=ISQ.Html.getDomEvent(f);if(e.domEvent.keyCode!==13){return false}if(b!==null){if(!b.executed){b.handle(e);b.executed=true}else{b.executed=false}}e.cancel();return false}if(ISQ.Html._doc.addEventListener){if(ISQ.Http.browser.app!=="chrome"&&ISQ.Http.browser.app!=="opera"){a.addEventListener("keypress",c,true)}else{a.addEventListener("keyup",c,true)}}else{if(ISQ.Html._doc.attachEvent){a.attachEvent("onkeyup",c)}}return a};var createForm=ISQ.Html.createForm;ISQ.Html.createIframe=function(b,d,a,e){var c;e=e||"about:blank";if(ISQ.Http.browser.app==="ie"){c=document.createElement('<iframe id="'+b+'" name="'+d+'" src="'+e+'"></iframe>')}else{c=createElement("iframe");c.setAttribute("name",d);c.setAttribute("id",b);c.setAttribute("src",e)}if(a){ISQ.CSS.setStyle(c,a)}return c};var createIframe=ISQ.Html.createIframe;ISQ.Html.createImage=function(b){if(!b.src){throw ("createImage: invalid src")}var a=new Image();a.src=b.src;if(b.id){a.id=id}if(b.align){a.setAttribute("align",b.align)}if(b.style){ISQ.CSS.setStyle(a,b.style)}if(b.parent){b.parent.appendChild(a)}if(b.altText){a.setAttribute("title",b.altText)}if(b.overSrc){ISQ.Html.setImageMouseOverAndOut(a,b.overSrc)}return a};var createImage=ISQ.Html.createImage;ISQ.Html.createLink=function(c){var b=createElement("a",c.parent,c.style);if(c.text){b.innerHTML=c.text}if(typeof(c.href)==="string"){b.href=c.href}else{b.href="javascript:void(0)"}if(typeof(c.title)==="string"){b.title=c.title}if(typeof(c.target)==="string"){b.target=c.target}if(typeof(c.id)==="string"){b.id=c.id}ISQ.Html.setOnclick(b,c.onclick);return b};var createLink=ISQ.Html.createLink;window.setOnclick=ISQ.Html.setOnclick=function(a,b){if(a.nodeName!=="A"){if(b){a.onclick=b}return}a.onclick=function(c){if(typeof(ISQ.Console)!=="undefined"&&typeof(ISQ.Console.SessionManager)!=="undefined"){ISQ.Console.SessionManager.lastClickedLinkHref=this.href?this.href:null;if(!ISQ.Http.browser.isIE){setTimeout(function(){delete ISQ.Console.SessionManager.lastClickedLinkHref},10)}}if(typeof(b)!=="undefined"){b.apply(this,new Array(c))
}}};ISQ.Html.createHR=function(d,c,a,b){var f=createRow(d);var e=createElement("td",f);e.style.height=c;e.style.background=a;if(typeof(b)==="number"){e.setAttribute("colSpan",b)}return f};var createHR=ISQ.Html.createHR;ISQ.Html.createTextNode=function(d,c){var b=ISQ.Html._doc.createTextNode(d);var a=_(c);if(a!==null){a.appendChild(b)}return b};var createTextNode=ISQ.Html.createTextNode;ISQ.Html.moveChildNodesToElement=function(c,b){clearNode(b);var a=c.childNodes;while(a.length>0){b.appendChild(a[0])}};var moveChildNodesToElement=ISQ.Html.moveChildNodesToElement;ISQ.Html.setImageMouseOverAndOut=function(a,c){var b=a.src;a.onmouseover=function(){this.src=c};a.onmouseout=function(){this.src=b}};var setImageMouseOverAndOut=ISQ.Html.setImageMouseOverAndOut;ISQ.Html.elementToString=function(b,d){var f=new Array();f.push("<");f.push(b.nodeName);f.push(" ");for(var c=0;c<b.attributes.length;++c){var a=b.attributes[c];if(!a.nodeValue){continue}var e=a.nodeValue.indexOf("'")>-1?'"':"'";f.push(a.nodeName);f.push("=");f.push(e);f.push(a.nodeValue);f.push(e);f.push(" ")}f.push(">");if(d){f.push(d)}else{f.push(b.innerHTML)}f.push("</");f.push(b.nodeName);f.push(">");return f.join("")};var elementToString=ISQ.Html.elementToString;ISQ.Html.createInvisibleIframe=function(a){var b=createElement("iframe",document.body,"visible:hidden;position:absolute;top:0px;left:-500px;width:1px;height:1px");setTimeout(function(){ISQ.Html.waitUntilAvailable(b,a)},0);return b};createInvisibleIframe=ISQ.Html.createInvisibleIframe;ISQ.Html.waitUntilAvailable=function(d,b){var c=null;var e=null;try{c=d.contentDocument||d.contentWindow.document||null;e=d.contentWindow||d.contentDocument.defaultView||null}catch(a){}if(!c||!e||(!c.body&&!e.document.body)){setTimeout(function(){ISQ.Html.waitUntilAvailable(d,b)},10);return}if(c.body){ISQ.Html.iframeReady(c,b)}else{ISQ.Html.iframeReady(e.document,b)}};ISQ.Html.iframeReady=function(b,a){b.open();b.writeln("<html><body></body></html>");b.close();a.handle(b);a.dispose()};</script>
    <script type="text/javascript">ISQ.Http=initializeNS("ISQ.Http");ISQ.Http.MAX_URL_SIZE=2047;ISQ.Http.getNoHashUrl=function(){var b=window.location.hash;var a=window.location.href;if(b!==""){var c;do{c=a.indexOf(b);if(c!==-1){a=a.substring(0,c)}}while(c!==-1)}return a};ISQ.Http.detectBroswer=function(){var b=navigator.appVersion;var f=navigator.userAgent;var a=0;ISQ.Http.browser={};if(navigator.appVersion.indexOf("Android")!==-1){ISQ.Http.browser.app="android";var c=navigator.appVersion.indexOf("Android ")+8;var g=navigator.appVersion.substring(c,navigator.appVersion.indexOf(";",c));ISQ.Http.browser.version=g;ISQ.Http.browser.isMobile=true;ISQ.Http.browser.usesViewport=true;ISQ.Http.browser.isAndroid=true;if(parseInt(ISQ.Http.browser.version)<4){ISQ.Http.browser.oldAndroid=true}}else{if(navigator.appVersion.indexOf("iPhone")!==-1){var g=navigator.appVersion.substring(0,navigator.appVersion.indexOf(" "));ISQ.Http.browser.app="safari";ISQ.Http.browser.version="iphone "+parseInt(g);ISQ.Http.browser.isMobile=true;ISQ.Http.browser.usesViewport=true;ISQ.Http.browser.isIPhone=true;if(b.indexOf("OS 6_")!==-1){ISQ.Http.browser.isIOS6=true}}else{if(navigator.appVersion.indexOf("iPad")!==-1){var g=navigator.appVersion.substring(0,navigator.appVersion.indexOf(" "));ISQ.Http.browser.app="safari";ISQ.Http.browser.version="ipad "+parseInt(g);ISQ.Http.browser.isTablet=true;ISQ.Http.browser.usesViewport=true;ISQ.Http.browser.isIPad=true}else{if((a=b.indexOf("MSIE "))!==-1){ISQ.Http.browser.app="ie";a+=5;var e=b.indexOf(" ",a);if(e===-1){ISQ.Http.browser.version=b.substring(a)}else{ISQ.Http.browser.version=b.substring(a,e)}if(ISQ.Http.browser.version.startsWith("10")){ISQ.Http.browser.isIE10=true}if(ISQ.Http.browser.version.startsWith("9")){ISQ.Http.browser.isIE9=true}if(ISQ.Http.browser.version.startsWith("8")){ISQ.Http.browser.isIE8=true}if(ISQ.Http.browser.version.startsWith("7")){ISQ.Http.browser.isIE7=true}if(ISQ.Http.browser.version.startsWith("6")){ISQ.Http.browser.isIE6=true}ISQ.Http.browser.isIE=true}else{if(b.indexOf("Chrome")!==-1){ISQ.Http.browser.app="chrome";
ISQ.Http.browser.version="0"}else{if((a=b.indexOf("Safari"))!==-1){var g=b.substring(a+7);ISQ.Http.browser.app="safari";if(g<="530.17"){ISQ.Http.browser.version="3"}else{ISQ.Http.browser.version="4"}}else{if((a=f.indexOf("Firefox/"))!==-1){ISQ.Http.browser.app="ff";var e=f.indexOf(" ",a);if(e===-1){ISQ.Http.browser.version=f.substring(a+8)}else{ISQ.Http.browser.version=f.substring(a+8,e)}if(ISQ.Http.browser.version.startsWith("3")){ISQ.Http.browser.isFF3=true}if(ISQ.Http.browser.version.startsWith("3.0")){ISQ.Http.browser.isFF3_0=true}}else{if(f.indexOf("Opera/")!==-1){ISQ.Http.browser.app="opera";var c=f.indexOf("Version/");if(c===-1){var d=f.indexOf(" ",6);ISQ.Http.browser.version=f.substring(6,d)}else{var d=f.indexOf(" ",c);if(d===-1){ISQ.Http.browser.version=f.substring(c+8)}else{ISQ.Http.browser.version=f.substring(c+8,d)}}ISQ.Http.browser.isOpera=true}else{if(f.contains("Symbian")){ISQ.Http.browser.app="symbian";ISQ.Http.browser.version=1;ISQ.Http.browser.full=ISQ.Http.browser.app+ISQ.Http.browser.version}else{ISQ.Http.browser.app="ie";ISQ.Http.browser.version="7.0;";ISQ.Http.browser.isIE7=true}}}}}}}}}ISQ.Http.browser.full=ISQ.Http.browser.app+ISQ.Http.browser.version;f=null;b=null};if(typeof(ISQ.Http.browser)==="undefined"||!ISQ.Http.browser){ISQ.Http.detectBroswer()}ISQ.Http.Cookies=initializeNS("ISQ.Http.Cookies");ISQ.Http.Cookies._read=function(d){if(!d){return null}var i=document.cookie;var f=0;var a;var e;var g=0;var c={KEY:1,VALUE:2};var h=c.KEY;while(g<i.length){a=i.charAt(g++);if(a===" "){continue}if(h===c.KEY){if(a==="="){h=c.VALUE;f=0;continue}e=d.charAt(f);if(a===e||a.toLowerCase()===e.toLowerCase()){if(++f===d.length){if(i.charAt(g)==="="){var b=i.indexOf(";",++g);if(b===-1){b=i.length}return i.substring(g,b)}else{f=0}}}else{f=0}}else{if(a===";"){h=c.KEY}}}return null};ISQ.Http.Cookies._readCaseSensitive=function(b){if(!b){return null}var d=document.cookie;var c=d.indexOf(b);while(c!==-1){c+=b.length;if(d.charAt(c)==="="){var a=d.indexOf(";",++c);if(a===-1){a=d.length}return d.substring(c,a)}else{c=d.indexOf(b)
}}return null};ISQ.Http.Cookies._write=function(e,h,f,b,g,d){e=e||null;h=!isNaN(h)?h:h||null;f=f||"/";b=b||null;g=g===true;d=d||null;if(e===null||h===null){return}var c=new Date();if(d!==null){c.setSeconds(c.getSeconds()+d);c=c.toGMTString()}var a=[];if(e.indexOf("%20")!==-1||e.toLowerCase().indexOf("%3a")!==-1){a.push(e)}else{a.push(escape(e))}a.push("=");if(h.toString().indexOf("%20")!==-1||h.toString().toLowerCase().indexOf("%3a")!==-1){a.push(h)}else{a.push(escape(h))}a.push("; path=");a.push(f);if(b!==null){a.push("; domain=");a.push(b)}if(g){a.push("; secure=");a.push(g)}if(d!==null){a.push("; expires=");a.push(c)}document.cookie=a.join("")};ISQ.Http.Cookies._delete=function(d,e,b,f){d=d||null;e=e||null;b=b||null;f=f||null;if(d===null){return}var g=ISQ.Http.Cookies._read(d);if(g===null){return}var c=new Date();c.setMonth(c.getMonth()-1);c=c.toGMTString();var a=[];a.push(escape(d));a.push("=1");a.push("; expires=");a.push(c);e=e||"/";a.push("; path=");a.push(e);b=b||ISQ.Http.domain(false);a.push("; domain=");a.push(b);if(f!==null){a.push("; secure=");a.push(f)}document.cookie=a.join("")};ISQ.Http.Cookies.encode64=function(b){b+="";if(b.length===0){return b}var a=ISQ.Tools.Base64.encodeString(b);return a.replace(/\=/g,"_").replace(/\+/g,"|")};ISQ.Http.Cookies.decode64=function(b){b+="";if(b.length===0){return b}var a=b.replace(/\_/g,"=").replace(/\|/g,"+");return ISQ.Tools.Base64.decodeString(a)};ISQ.Http.domain=function(c,e){e=e||window.location.href;c=c===true;if(typeof(ISQ.Http.mDomain)==="undefined"||!ISQ.Http.mDomain){var d=e.indexOf("//")+2;var b=e.substring(d);ISQ.Http.mIncludePort=b.substring(0,b.indexOf("/"));var a=b.indexOf(":");if(a>-1){ISQ.Http.mDomain=ISQ.Http.mIncludePort.substring(0,a)}else{ISQ.Http.mDomain=ISQ.Http.mIncludePort}}if(c){return ISQ.Http.mIncludePort}else{return ISQ.Http.mDomain}};ISQ.Http.relativePath=function(e){e=e||window.location.href;var d={path:"",filename:""};var a=e.indexOf("//")+2;a=e.indexOf("/",a);if(a==e.length-1){return d}var c=e.indexOf("?");var b=e.LastIndexOf_char("/",c===-1?0:c);
d.path=e.substring(a,b++);d.filename=e.substring(b);a=d.filename.indexOf("#");if(a!==-1){d.filename=d.filename.substring(0,a)}return d};if(typeof(ISQ.Http.urlArguments)==="undefined"||!ISQ.Http.urlArguments){if(window.location.search.length!==0){ISQ.Http.urlArguments=ISQ.Tools.stringToPairArray(window.location.search.substring(1),"=","&",true,false)}else{ISQ.Http.urlArguments=[]}}if(typeof(ISQ.Http.hashArguments)==="undefined"||!ISQ.Http.hashArguments){if(window.location.hash.length!==0){ISQ.Http.hashArguments=ISQ.Tools.stringToPairArray(window.location.hash.substring(1),"=","&",true,false)}else{ISQ.Http.hashArguments=[]}}ISQ.Http.getUrlParam=function(a,e){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var c="[\\?&]"+a+"=([^&#]*)";var b=new RegExp(c);e=e||window;var d=b.exec(e.location.href);if(d==null){return""}else{return d[1]}};</script>
    <script type="text/javascript">ISQ.CSS=initializeNS("ISQ.CSS");ISQ.CSS.getVerticalMargin=function(a){var b=0;tp=ISQ.CSS.getElementStyle(a,"margin-top");tp=parseInt(tp);if(!isNaN(tp)){b+=tp}bt=ISQ.CSS.getElementStyle(a,"margin-bottom");bt=parseInt(bt);if(!isNaN(bt)){b+=bt}return b};ISQ.CSS.getHorizonalMargin=function(a){var b=0;left=ISQ.CSS.getElementStyle(a,"margin-left");left=parseInt(left);if(!isNaN(left)){b+=left}right=ISQ.CSS.getElementStyle(a,"margin-right");right=parseInt(right);if(!isNaN(right)){b+=right}return b};ISQ.CSS.setStyle=function(c,e,a){c=ISQ.Html._(c);if(c===null){return}if(typeof(e)!=="string"){return}if(typeof(a)==="undefined"){a=true}if(a){c.className="";c.style.cssText=""}var d=e.split("&");for(var b=0;b<d.length;++b){if(d[b].charAt(0)==="."){c.className+=" "+d[b].substring(1)}else{c.style.cssText+=";"+d[b]}}};ISQ.CSS.setOpacity=function(b,c){b=ISQ.Html._(b);if(b===null){return}if(typeof(c)!=="number"||(c<0||c>100)){return}if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){if(c===100){b.style.removeAttribute("filter");if(b.nodeName==="TR"){for(var a=0;a<b.childNodes.length;++a){ISQ.CSS.setOpacity(b.childNodes[a],c)}}}else{b.style.filter="alpha(opacity="+c+")";if(b.nodeName==="TR"){for(var a=0;a<b.childNodes.length;++a){ISQ.CSS.setOpacity(b.childNodes[a],c)}}}}else{if(ISQ.Http.browser.isIE8||ISQ.Http.browser.isIE9||ISQ.Http.browser.isIE10){if(c===100){b.style.removeAttribute("filter");if(b.nodeName==="TR"){for(var a=0;a<b.childNodes.length;++a){b.childNodes[a].style.removeAttribute("filter")}}}else{b.style.filter="progid:DXImageTransform.Microsoft.Alpha(Opacity="+c+")";if(b.nodeName==="TR"){for(var a=0;a<b.childNodes.length;++a){b.childNodes[a].style.filter="inherit"}}}}else{if(c===100){b.style.removeProperty("opacity");if(ISQ.Http.browser.app==="opera"&&b.nodeName==="TR"){for(var a=0;a<b.childNodes.length;++a){b.childNodes[a].style.removeProperty("opacity")}}}else{b.style.opacity=(c/100);if(ISQ.Http.browser.app==="opera"&&b.nodeName==="TR"){for(var a=0;a<b.childNodes.length;++a){b.childNodes[a].style.opacity="inherit"}}}}}};
ISQ.CSS.toggleCss=function(a,c){var g="cssRules";if(ISQ.Http.browser.app==="ie"){g="rules"}var f=document.styleSheets.length;for(var d=f-1;d>=0;--d){var j=document.styleSheets[d];try{if(j.href||j[g].length==0){continue}var h=j[g][0].selectorText;if(!h){continue}if(h.toLowerCase()!==a){continue}j.disabled=!c}catch(b){}}};ISQ.CSS.getElementStyle=function(b,e){b=ISQ.Html._(b);var f;if(b.currentStyle){var a=new Array();var d=-1,c=0;while((hyphen=e.indexOf("-",d+1))>-1){if(hyphen<e.length){c=e.indexOf("-",hyphen+1);if(c==-1){c=e.length}}a.push(e.substring(d,hyphen));a.push(e.substring(hyphen+1,hyphen+2).toUpperCase());a.push(e.substring(hyphen+2,c));d=hyphen}e=a.join("");f=b.currentStyle[e]}else{if(window.getComputedStyle){f=document.defaultView.getComputedStyle(b,null).getPropertyValue(e)}}return f};ISQ.CSS.getElementWidth=function(a,b){var c=a.offsetWidth;c-=ISQ.Tools.getNumber(ISQ.CSS.getElementStyle(a,"padding-left"),0);c-=ISQ.Tools.getNumber(ISQ.CSS.getElementStyle(a,"padding-right"),0);if(b){c-=ISQ.CSS.getHorizonalMargin(a)}return c};ISQ.CSS.getElementHeight=function(a,c,b){var d=a.offsetHeight;if(d===0){if(b){return 0}d=ISQ.Tools.getNumber(ISQ.CSS.getElementStyle(a,"height"),0)}d-=ISQ.Tools.getNumber(ISQ.CSS.getElementStyle(a,"padding-top"),0);d-=ISQ.Tools.getNumber(ISQ.CSS.getElementStyle(a,"padding-bottom"),0);if(c){d-=ISQ.CSS.getVerticalMargin(a)}return d};ISQ.CSS.setWidthIncludingPadding=function(a,b){b-=ISQ.Tools.getNumber(ISQ.CSS.getElementStyle(a,"padding-left"),0);b-=ISQ.Tools.getNumber(ISQ.CSS.getElementStyle(a,"padding-right"),0);a.style.width=b+"px"};</script>
    <script type="text/javascript">ISQ.CSS.setNodeStyleText=function(a,b){a.setAttribute("style",b);a.style.cssText=b};ISQ.CSS.addNewStyle=function(a){var b=document.createElement("style");b.type="text/css";if(ISQ.Http.browser.app==="ie"){b.styleSheet.cssText=a}else{var c=document.createTextNode(a);b.appendChild(c)}document.getElementsByTagName("head")[0].appendChild(b)};ISQ.CSS.generateCSSstring=function(d,c){if(d===null||c===null){return""}var a=[];a.push(c);a.push("{"+d+"}");var b=a.join("");return b};ISQ.CSS.getAttributeValueFromStyleString=function(d,a){var e=0;var c=d.indexOf(a);if(c>-1){c=d.indexOf(":",c);var b=d.indexOf(";",c);if(b>-1){e=d.substring(c+1,b)}else{e=d.substring(c+1)}}return e};ISQ.CSS.getBackgroundImage=function(d){var e="";var a=ISQ.CSS.getAttributeValueFromStyleString(d,"background-image");if(a===0){a=ISQ.CSS.getAttributeValueFromStyleString(d,"background")}var c=a.indexOf("url(");if(c>-1){c+=4;var b=a.indexOf(")",c);b-=1;e=a.substring(c,b);e=e.replace('"',"")}return e};ISQ.CSS.getSelectorStyle=function(p,q){if(typeof(p)!=="string"){return}p=p.toLowerCase();if(typeof(q)!=="string"){q=null}else{q=q.toLowerCase()}var o="cssRules";if(ISQ.Http.browser.app==="ie"){o="rules"}try{var f=document.styleSheets.length;var t=new Array();for(var d=f-1;d>=0;--d){var u=document.styleSheets[d];try{if(u.disabled){continue}var k=u[o].length;for(var e=k-1;e>=0;--e){var s=u[o][e].selectorText;if(!s){continue}var r=s.toLowerCase().split(",");var g=r.length;for(h=g-1;h>=0;--h){var b=r[h].Trim();if(p===b||(q!==null&&q===b)){var v;for(var a in u[o][e].style){if(t[a]){continue}v=u[o][e].style[a];if(!v){continue}t[a]=v}}}}}catch(c){}}return t}catch(c){}return null};ISQ.CSS.getValueBySelectors=function(a,c,d){if(typeof(a)!=="string"){return}if(typeof(c)!=="string"){return}if(typeof(d)!=="string"){d=null}var b=ISQ.CSS.getSelectorStyle(c,d);if(b===null){return null}value=b[a];if(typeof(value)!=="string"){return null}var e=value.Trim();if(e===""){return null}return e};ISQ.CSS.changeValueBySelector=function(d,a,c){if(typeof(a)!=="string"){return}if(typeof(d)!=="string"){return
}if(typeof(c)!=="string"){return}var b=ISQ.CSS.getSelectorStyle(d);if(!b){return null}b[a]=c};ISQ.CSS.getValue=function(e,d){var b=ISQ.Html._(e);if(b===null){return null}var c="#"+b.id;var a="."+b.className;var f=b.nodeName.toLowerCase();d=d.toLowerCase();var i=null;i=b.style[d];if(i!==null&&i!==""){return i.Trim()}var g=ISQ.CSS.getValueBySelectors(d,a,c);if(g===null){return ISQ.CSS.getValueBySelectors(d,f+a,f+c)}};</script>
    <script type="text/javascript">ISQ.Forms={};ISQ.Forms.styleArray=null;ISQ.Forms.buttons=0;ISQ.Forms.fieldMaxLength=250;ISQ.Forms.detailsMaxLength=2000;ISQ.Forms.clickEvent=new ISQ.Event();ISQ.Forms.loadEvent=new ISQ.Event();ISQ.Forms.tabEvent=new ISQ.Event();ISQ.Forms.currentShownTab=0;ISQ.Forms.question="";ISQ.Forms.isShown=false;ISQ.Forms.showTab=function(a){a=parseInt(a)||0;if(ISQ.Forms.currentShownTab===a){return}ISQ.Forms.tabArray[a].divPointer.style.display="block";ISQ.Forms.tabArray[ISQ.Forms.currentShownTab].divPointer.style.display="none";ISQ.Forms.tabArray[a].tdPointer.className="selectedTab"+ISQ.Forms.tabArray[a].tabIndex;ISQ.Forms.tabArray[ISQ.Forms.currentShownTab].tdPointer.className="unselectedTab"+ISQ.Forms.tabArray[ISQ.Forms.currentShownTab].tabIndex;var b=ISQ.Forms.copyDataBetweenTabs(ISQ.Forms.currentShownTab,a);if(b!==null){ISQ.Forms.tabEvent.dispatch({isSubjectFieldInTab:true,subject:b})}else{ISQ.Forms.tabEvent.dispatch({isSubjectFieldInTab:false,subject:ISQ.Forms.question})}ISQ.Forms.currentShownTab=a};ISQ.Forms.copyDataBetweenTabs=function(b,g){fromInputs=ISQ.Forms.tabArray[b].inputs;toInputs=ISQ.Forms.tabArray[g].inputs;var c=fromInputs.length;var h=toInputs.length;var d=null;var k=null;if(c>0){for(var e=0;e<c;++e){if(fromInputs[e].valueType==="subject"){d=fromInputs[e];continue}for(var f=0;f<h;++f){if(toInputs[f].valueType==="subject"){k=toInputs[f];continue}if(fromInputs[e].name===toInputs[f].name){toInputs[f].pointer.value=fromInputs[e].pointer.value}}}}else{for(var f=0;f<h;++f){if(toInputs[f].valueType==="subject"){k=toInputs[f];break}}}var a=ISQ.Forms.question;if(d!==null){a=d.pointer.value;ISQ.Forms.question=a}if(k!==null){k.pointer.value=a;return a}return null};ISQ.Forms.imagesReadyHandler=function(){ISQ.ImagesList.readyEvent.removeHandler(ISQ.Forms.imagesReadyHandler);ISQ.Forms.loadEvent.dispatch();var b=ISQ.Forms.getValueFromField(ISQ.Forms.currentShownTab,"subject");var a=(b!==null)?b:ISQ.Forms.question;ISQ.Forms.tabEvent.dispatch({isSubjectFieldInTab:(b!==null),subject:a})};ISQ.Forms.getField=function(f,b){var a=null;
var e=ISQ.Forms.tabArray[f];if(e===null||typeof(e)==="undefined"){return a}var d=e.inputs.length;for(var c=0;c<d&&a===null;++c){if(e.inputs[c].valueType===b){a=e.inputs[c].pointer}}return a};ISQ.Forms.getValueFromField=function(c,b){var a=ISQ.Forms.getField(c,b);if(a===null||typeof(a)==="undefined"){return null}return a.value};ISQ.Forms.isSubjectFieldInTab=function(a){a=a||0;return(ISQ.Forms.getValueFromField(a,"subject")!==null)};ISQ.Forms.isEventRegistered=false;ISQ.Forms.listenToQueryChangeEvent=function(a){if(!ISQ.Forms.isEventRegistered){ISQ.Forms.isEventRegistered=true;a.addHandler(ISQ.Forms.queryValueChangeHandler)}};ISQ.Forms.unlistenToQueryChangeEvent=function(a){if(ISQ.Forms.isEventRegistered){a.removeHandler(ISQ.Forms.queryValueChangeHandler);ISQ.Forms.isEventRegistered=false}};ISQ.Forms.queryValueChangeHandler=function(a){ISQ.Forms.question=a};ISQ.Forms.outputContainer=null;ISQ.Forms.minimalLength=0;ISQ.Forms.minimalLengthErrorMessage=0;ISQ.Forms.noCancelButton=false;ISQ.Forms.getHTML=function(n){try{ISQ.Forms.currentShownTab=0;ISQ.Forms.outputContainer=_(n.outputContainer)||null;if(ISQ.Forms.outputContainer===null){return}ISQ.Forms.noCancelButton=n.noCancelButton===true;var o=n.question.Trim();ISQ.Forms.question=o;ISQ.Forms.preDefinedValues_copy=new Array();for(var k in ISQ.Forms.preDefinedValues){ISQ.Forms.preDefinedValues_copy[k]=ISQ.Forms.preDefinedValues[k]}ISQ.ImagesList.init();ISQ.ImagesList.readyEvent.addHandler(ISQ.Forms.imagesReadyHandler);ISQ.Forms.buttons=0;delete ISQ.Forms.inputs;ISQ.Forms.inputs=new Array();var j=new Array();delete ISQ.Forms.styleArray;ISQ.Forms.styleArray=new Array();ISQ.Forms.styleArray.push(ISQ.CSS.generateCSSstring("border:1px solid red","INPUT.inputError"));var h=n.formNode;var a=h.getAttribute("dir")||n.direction;var d=h.getAttribute("style");var g=h.getAttribute("align");var c=ISQ.CSS.getAttributeValueFromStyleString(d,"width");c=c.toString().substring(0,c.length-2);var m=h.getElementsByTagName("minimalLength")[0];ISQ.Forms.minimalLength=parseInt(m.getAttribute("length"));
ISQ.Forms.minimalLengthErrorMessage=m.firstChild.nodeValue;ISQ.Forms.styleArray.push(ISQ.CSS.generateCSSstring(d,"#clientFormDiv"));ISQ.Forms.addImageToQueue(d);ISQ.Forms.outputContainer.innerHTML="";var l=createTable(ISQ.Forms.outputContainer,"100%",a);var s=createRow(l);var r=createTd(s,g,"top");var i=createElement("form",r);i.setAttribute("name","clientForm");i.setAttribute("id","clientForm");i.setAttribute("action","");i.setAttribute("method","post");i.onkeyup=function(e){ISQ.Forms._onKeyup(e)};i.onsubmit=function(e){return false};if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){ISQ.CSS.setStyle(i,"margin:0; padding:0")}var b=createElement("div",i);b.setAttribute("id","clientFormDiv");var q=createTable(b,"100%",a);s=createRow(q);r=createTd(s,"left","top");var p=h.getElementsByTagName("tab");ISQ.Forms.getTabHTML(r,p,a,c,o);ISQ.CSS.addNewStyle(ISQ.Forms.styleArray.join(""));delete ISQ.Forms.styleArray;ISQ.ImagesList.process();ISQ.Forms.isShown=true}catch(f){if(debugLevel){alert("Form.getHTML exp:"+f)}return f.message}};ISQ.Forms.getTabHTML=function(n,s,b,f,o){try{var w=null;var x=null;var h=null;var m=s.length;var v=null;var t=0;delete ISQ.Forms.tabArray;ISQ.Forms.tabArray=new Array();if(m>1){w=document.createElement("div");n.appendChild(w);w.style.position="relative";w.style.top="0px";if(b==="ltr"){w.style.left="0px"}else{w.style.right="0px"}w.style.zIndex="1";w.setAttribute("id","clientFormTabTableDiv");var q=document.createElement("table");q.setAttribute("cellPadding","0");q.setAttribute("cellSpacing","0");q.setAttribute("border","0");q.setAttribute("dir",b);w.appendChild(q);var D=document.createElement("tbody");q.appendChild(D);var F=document.createElement("tr");D.appendChild(F);x=F;t=-1}h=document.createElement("div");h.style.position="relative";h.setAttribute("id","clientFormTabDivs");h.style.width="100%";h.style.top=t+"px";if(b==="ltr"){h.style.left="0px"}else{h.style.right="0px"}if((ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6)&&b==="rtl"){setTimeout(function(){h.style.display="block"},0)}var c,p,a,g,u,C,y,A,r,z;
for(var k=0;k<m;++k){y="tabTdName_"+k;z=null;a=s[k].getAttribute("contentStyle");g="formTabDiv_"+k;if(m>1){A=s[k].getAttribute("title");r=s[k].getAttribute("name");u=s[k].getAttribute("selectedStyle");C=s[k].getAttribute("unselectedStyle");ISQ.Forms.styleArray.push(ISQ.CSS.generateCSSstring(u,".selectedTab"+k));ISQ.Forms.styleArray.push(ISQ.CSS.generateCSSstring(C,".unselectedTab"+k));ISQ.Forms.addImageToQueue(u);ISQ.Forms.addImageToQueue(C);p="unselectedTab"+k;if(k===0){p="selectedTab"+k}var E=document.createElement("td");x.appendChild(E);var B=document.createElement("div");E.appendChild(B);B.className=p;B.style.cursor="pointer";B.style.position="static";B.style.outlineStyle="none";B.onclick=function(){ISQ.Forms.showTab(this.getAttribute("tabIndex"))};B.setAttribute("id",y);B.setAttribute("tabIndex",k);B.innerHTML=A;z=B}c="none";if(k===0){c="block"}a+=";width:"+f+"px";var d=document.createElement("div");h.appendChild(d);d.setAttribute("id",g);ISQ.CSS.setNodeStyleText(d,a);d.style.position="absolute";d.style.top="0px";d.style.left="0px";d.style.display=c;ISQ.Forms.tabArray[k]=new ISQ.Forms.Tab(g,y,k,d,z);ISQ.Forms.getTabContent(d,s[k],k,b,o)}n.appendChild(h)}catch(j){if(debugLevel){alert("getTabHTML exception: "+j.message)}return""}};ISQ.Forms.getTabContent=function(h,n,o,c,j){try{var m=document.createElement("table");h.appendChild(m);m.setAttribute("cellPadding","0");m.setAttribute("cellSpacing","0");m.setAttribute("border","0");m.setAttribute("dir",c);m.setAttribute("width","100%");var p=document.createElement("tbody");m.appendChild(p);var k=n.getElementsByTagName("row");var g=k.length;var s,b,a;var r,q;for(var f=0;f<g;++f){a=k[f].getAttribute("align")||"left";s=k[f].getAttribute("type")||"text";b=k[f].getAttribute("bgStyle")||"";switch(s){case"text":r=document.createElement("tr");r.setAttribute("rowType","text");p.appendChild(r);ISQ.CSS.setNodeStyleText(r,b);q=document.createElement("td");r.appendChild(q);q.setAttribute("align",a);q.setAttribute("valign","middle");ISQ.Forms.getTextRowContent(q,k[f],o,j,c);break;
case"space":r=document.createElement("tr");r.setAttribute("rowType","space");p.appendChild(r);q=document.createElement("td");r.appendChild(q);q.setAttribute("height",k[f].getAttribute("space")+"px");break;case"separator":r=document.createElement("tr");p.appendChild(r);r.setAttribute("rowType","sep");q=document.createElement("td");r.appendChild(q);ISQ.CSS.setNodeStyleText(q,b);break}}}catch(d){if(debugLevel){alert("getTabContent exception: "+d.message)}return""}};ISQ.Forms.getTextRowContent=function(I,K,O,J,o){var S,d,u,h,C,M,B,U,v;var y=null;try{var P=createTable(I,null,o);tr=createRow(P);var z=K.getElementsByTagName("item");var A=z.length;var Q,n;for(v=0;v<A;++v){y=z[v];S=y.getAttribute("type");d=y.getAttribute("align")||"center";u=y.getAttribute("fontStyle")||"";h=y.getAttribute("bgStyle")||"";C=y.getAttribute("name")||"textNode";M=y.getAttribute("space")||"0";U=y.getAttribute("valueType")||"text";B=y.getAttribute("mandatory")||"false";switch(S){case"text":Q=createTd(tr,d,"middle",h);n=document.createElement("h2");Q.appendChild(n);ISQ.CSS.setNodeStyleText(n,u);var L=y.getAttribute("showOnError")||"False";if(L==="True"){var c=parseInt(ISQ.CSS.getAttributeValueFromStyleString(h,"width"))||0;var a=parseInt(ISQ.CSS.getAttributeValueFromStyleString(h,"height"))||0;var f=c>0&&a>0;var p=f?"block":"none";n.style.display=p;n.setAttribute("id","clientFormErrorNotification_"+O);n.className="errorAlwaysShow_"+f;n.innerHTML="&nbsp;&nbsp;&nbsp;"}else{var E="";if(y.childNodes.length>0){E=y.firstChild.nodeValue}n.innerHTML=E}break;case"space":Q=document.createElement("td");tr.appendChild(Q);Q.setAttribute("width",M+"px");break;case"field":C=y.firstChild.nodeValue;var T="middle";if(ISQ.Http.browser.app==="ie"){T="top"}var c=parseInt(ISQ.CSS.getAttributeValueFromStyleString(u,"width"))||0;if(c===0){u+=";width:auto"}var a=parseInt(ISQ.CSS.getAttributeValueFromStyleString(u,"height"))||0;if(a===0){u+=";height:auto"}var x=y.getAttribute("inputBgStyle")||"";var j=ISQ.CSS.getAttributeValueFromStyleString(x,"border");j=j==0?"border:0px;":j;
var s="";var t=y.getElementsByTagName("errorText");if(t.length>0&&y.getElementsByTagName("errorText")[0].childNodes.length>0){s=y.getElementsByTagName("errorText")[0].firstChild.nodeValue}else{s="Please enter a valid value"}var w="clientForm_"+O+"_"+C.replace(/ /g,"_");ISQ.Forms.styleArray.push(ISQ.CSS.generateCSSstring("position:absolute;"+u+";"+x+";"+j,"#"+w));ISQ.Forms.addImageToQueue(x);ISQ.Forms.addImageToQueue(h);var D=null;var b="";if(U==="textArea"){D=document.createElement("textarea");D.setAttribute("name",C);D.setAttribute("id",w);D.onkeyup=function(){if(this.value.length>ISQ.Forms.detailsMaxLength){this.value=this.value.substring(0,ISQ.Forms.detailsMaxLength);return false}return true}}else{if(U==="ddl"){D=createElement("select");var N=C.split("|");D.name=C=N[0];for(var v=1;v<N.length;++v){var H=createElement("option",D);H.value=N[v];H.innerHTML=N[++v]}}else{if(U==="subject"){b=J}var S="text";if(ISQ.Http.browser.usesViewport&&C.toLowerCase().contains("email")){S="email"}D=createInput(S,C,null,b);D.setAttribute("id",w);D.setAttribute("maxLength",ISQ.Forms.fieldMaxLength)}}ISQ.Forms.insertPreDefinedValueIntoField(D,C);Q=createTd(tr,d,T);var q=createDiv(Q,h+";position:relative;top:0;left:0;");q.appendChild(D);new ISQ.Forms.Input(C,B,U,O,s,D);break;case"button":Q=document.createElement("td");tr.appendChild(Q);Q.setAttribute("align",d);Q.setAttribute("valign","middle");ISQ.CSS.setNodeStyleText(Q,h);var m="";var R=y.getElementsByTagName("text");if(R.length>0&&R[0].childNodes.length>0){m=R[0].firstChild.nodeValue}var k="formButton"+ISQ.Forms.buttons++;var g=";cursor:pointer;text-direction:center;";var G=y.getAttribute("onover");var F=y.getAttribute("onout");G+=g;F+=g;ISQ.Forms.addImageToQueue(G);ISQ.Forms.addImageToQueue(F);ISQ.Forms.styleArray.push(ISQ.CSS.generateCSSstring(F,".out"+v));ISQ.Forms.styleArray.push(ISQ.CSS.generateCSSstring(G,".over"+v));var n=document.createElement("div");Q.appendChild(n);n.setAttribute("id",k);n.onclick=ISQ.Forms.onButtonClickHandler;ISQ.CSS.setNodeStyleText(n,g);n.setAttribute("tabNum",O);
n.setAttribute("interfaceId",y.getElementsByTagName("ticketingInterface")[0].getAttribute("interfaceId")||"");n.setAttribute("classId",v);n.setAttribute("valueType",U);n.className="out"+v;n.onmouseover=ISQ.Forms.onButtonMouseOverHandler;n.onmouseout=ISQ.Forms.onButtonMouseOutHandler;n.innerHTML=m;if(ISQ.Forms.noCancelButton&&U==="cancel"){n.style.visibility="hidden"}break}}}catch(r){if(debugLevel){alert("getTextRowContent exception: "+r.message)}}};ISQ.Forms.onButtonClickHandler=function(a){var b=this.getAttribute("classId");this.className="out"+b;var d=parseInt(this.getAttribute("tabNum"));if(this.getAttribute("valueType")==="submit"){var c=this.getAttribute("interfaceId");ISQ.Forms.checkFormValues(d,c)}else{if(this.getAttribute("valueType")==="cancel"){ISQ.Forms._cancel(ISQ.Forms.clickEventEnum.CANCEL);ISQ.Forms.isShown=false}}};ISQ.Forms.onButtonMouseOutHandler=function(a){var b=this.getAttribute("classId");this.className="out"+b};ISQ.Forms.onButtonMouseOverHandler=function(a){var b=this.getAttribute("classId");this.className="over"+b};ISQ.Forms.addImageToQueue=function(b){var a=ISQ.CSS.getBackgroundImage(b);if(a!==""){ISQ.ImagesList.add(a)}};ISQ.Forms._submit=function(b){var a=new ISQ.Forms.clickEventObject(ISQ.Forms.clickEventEnum.SUBMIT);a.formElements=b;ISQ.Forms.clickEvent.dispatch(a)};ISQ.Forms._cancel=function(a){a=a||ISQ.Forms.clickEventEnum.CANCEL;var b=new ISQ.Forms.clickEventObject(a);ISQ.Forms.clickEvent.dispatch(b)};ISQ.Forms.updateFormHeight=function(){var d=_("clientFormDiv");var e=0;var k=_("clientFormTabTableDiv")||null;if(k!=null){e+=k.offsetHeight}var g=ISQ.Forms.tabArray.length;var h=0;for(var f=0;f<g;f++){var j=ISQ.Forms.tabArray[f];j.divPointer.style.height="auto";var b=j.divPointer.offsetHeight;if(b>h){h=b}}e+=h;d.style.height=e+"px";if(ISQ.Http.browser.isIE6){var c=_("clientFormTabTableDiv");var a=_("clientFormTabDivs");if(c===null&&a!==null){a.style.height=e+"px"}}};ISQ.Forms.checkFormValues=function(o,h){var n=ISQ.Forms.tabArray[o];if(n===null||typeof(n)==="undefined"){return}var d=_("clientFormErrorNotification_"+o,true)||null;
var c=false;if(d!==null){c=d.className.indexOf("true")>-1}var e={};e.interfaceId=h;e.values=new Array();var b=n.inputs.length;var p,r,o,q,a;var k=true;var f=true;var j=false;for(var g=0;g<b&&k;++g){a=n.inputs[g];q=(a.valueType==="replyEmailInput")?"email":a.valueType;if(a.valueType==="email"){f=true}p=a.pointer.value.Trim();if(a.valueType=="ddl"){p=a.pointer[a.pointer.selectedIndex].value}r=ISQ.Data.checkString(p,q);if(a.valueType==="subject"){j=true;var m=0;if(p!=""){m=p.split(" ").length}if(m<ISQ.Forms.minimalLength){k=false;a.pointer.className="inputError";if(d!==null){d.innerHTML=ISQ.Forms.minimalLengthErrorMessage;if(!c){d.style.display="block"}}}}else{if(a.mandatory&&(!r||p==="")){k=false;a.pointer.className="inputError";if(d!==null){d.innerHTML=a.errorText;if(!c){d.style.display="block"}}}}if(k){e.values.push({name:a.pointer.name,value:p,type:a.valueType});a.pointer.className="";if(d!==null){d.innerHTML="";if(!c){d.style.display="none"}}}}if(!j&&k){var m=0;if(ISQ.Forms.question!=""){m=ISQ.Forms.question.split(" ").length}if(m<ISQ.Forms.minimalLength){k=false;if(d!==null){d.innerHTML=ISQ.Forms.minimalLengthErrorMessage;if(!c){d.style.display="block"}}}}if(k){for(var l in ISQ.Forms.preDefinedValues_copy){e.values.push({name:ISQ.Forms.preDefinedValues_copy[l].name,value:ISQ.Forms.preDefinedValues_copy[l].value,type:ISQ.Forms.preDefinedValues_copy[l].type})}ISQ.Forms._submit(e)}else{ISQ.Forms._cancel(ISQ.Forms.clickEventEnum.ERROR)}};ISQ.Forms._onKeyup=function(b){var a=b||event;return false};ISQ.Forms.clickEventEnum={SUBMIT:1,CANCEL:2,ERROR:3};ISQ.Forms.clickEventObject=function(a){this.result=a;this.query=ISQ.Forms.getValueFromField(ISQ.Forms.currentShownTab,"subject");if(typeof(this.query)==="undefined"||this.query===null){this.query=ISQ.Forms.question}};ISQ.Forms.clickEventObject.prototype.result=ISQ.Forms.clickEventEnum.ERROR;ISQ.Forms.clickEventObject.prototype.query="";ISQ.Forms.clickEventObject.prototype.formElements=null;ISQ.Forms.inputs=null;ISQ.Forms.Input=function(c,b,f,e,a,d){this.name=c;this.mandatory=(b==="True");
this.valueType=f;this.tabNum=e;this.errorText=a;this.pointer=d;ISQ.Forms.inputs.push(this);ISQ.Forms.tabArray[e].inputs.push(this)};ISQ.Forms.Input.prototype.name="";ISQ.Forms.Input.prototype.mandatory=false;ISQ.Forms.Input.prototype.valueType="";ISQ.Forms.Input.prototype.tabNum=-1;ISQ.Forms.Input.prototype.errorText="";ISQ.Forms.Input.prototype.pointer=null;ISQ.Forms.tabArray=null;ISQ.Forms.Tab=function(a,e,c,b,d){this.divName=a;this.tdName=e;this.tabIndex=c;this.inputs=new Array();this.divPointer=b;this.tdPointer=d};ISQ.Forms.Tab.prototype.divName="";ISQ.Forms.Tab.prototype.tdName="";ISQ.Forms.Tab.prototype.tabIndex=-1;ISQ.Forms.Tab.prototype.inputs=null;ISQ.Forms.Tab.prototype.divPointer=null;ISQ.Forms.Tab.prototype.tdPointer=null;ISQ.Forms.preDefinedValues=[];ISQ.Forms.preDefinedValues_copy=null;ISQ.Forms.incomingPreDefinedValuesFromMessage=function(c){var f=c.split(ISQ.Widget.APIKeyEndDelimiter);var e;for(var d=0;d<f.length;++d){e=f[d].split("(");if(e.length===3){ISQ.Forms.reportPreDefinedValue(ISQ.Http.Cookies.decode64(e[0]),ISQ.Http.Cookies.decode64(e[1]),ISQ.Http.Cookies.decode64(e[2]))}else{ISQ.Forms.reportPreDefinedValue(ISQ.Http.Cookies.decode64(e[0]),ISQ.Http.Cookies.decode64(e[1]))}}if(ISQ.Forms.isShown){ISQ.Forms.preDefinedValues_copy=[];for(var b in ISQ.Forms.preDefinedValues){ISQ.Forms.preDefinedValues_copy[b]=ISQ.Forms.preDefinedValues[b]}for(var a=0;a<ISQ.Forms.inputs.length;++a){ISQ.Forms.insertPreDefinedValueIntoField(ISQ.Forms.inputs[a].pointer,ISQ.Forms.inputs[a].name)}}};ISQ.Forms.reportPreDefinedValue=function(a,c,b){b=b||"text";ISQ.Forms.preDefinedValues[a]=new ISQ.Forms.preDefinedValue(a,c,b)};ISQ.Forms.preDefinedValue=function(a,c,b){this.name=a;this.value=c;this.type=b};ISQ.Forms.preDefinedValue.prototype.name="";ISQ.Forms.preDefinedValue.prototype.value="";ISQ.Forms.preDefinedValue.prototype.type="";ISQ.Forms.insertPreDefinedValueIntoField=function(c,b){var d=ISQ.Forms.preDefinedValues_copy[b];if(typeof(d)==="undefined"){return}var a=d.value;var e=a.length;if(c.nodeName==="INPUT"&&e>ISQ.Forms.fieldMaxLength){a=a.substring(0,ISQ.Forms.fieldMaxLength)
}else{if(c.nodeName==="TEXTAREA"&&e>ISQ.Forms.detailsMaxLength){a=a.substring(0,ISQ.Forms.detailsMaxLength)}}c.value=a;delete ISQ.Forms.preDefinedValues_copy[b]};</script>
    <script type="text/javascript">ISQ.ImagesList={};ISQ.ImagesList.array=null;ISQ.ImagesList.imgArray=null;ISQ.ImagesList.currentlyDownloaded=0;ISQ.ImagesList.toDownload=0;ISQ.ImagesList.readyEvent=new ISQ.Event();ISQ.ImagesList.init=function(){delete ISQ.ImagesList.array;ISQ.ImagesList.array=new Array();delete ISQ.ImagesList.imgArray;ISQ.ImagesList.imgArray=new Array();ISQ.ImagesList.currentlyDownloaded=0};ISQ.ImagesList.add=function(a){ISQ.ImagesList.array.push(a)};ISQ.ImagesList.isInProcess=false;ISQ.ImagesList.process=function(){if(ISQ.ImagesList.isInProcess){return}ISQ.ImagesList.isInProcess=true;ISQ.ImagesList.toDownload=ISQ.ImagesList.array.length-1;ISQ.ImagesList.downloadFinish()};ISQ.ImagesList.downloadHandler=function(){if(ISQ.ImagesList.currentlyDownloaded++===ISQ.ImagesList.toDownload){ISQ.ImagesList.downloadFinish()}};ISQ.ImagesList.downloadFinish=function(){ISQ.ImagesList.isInProcess=false;ISQ.ImagesList.readyEvent.dispatch()};</script>
    <script type="text/javascript">var Ajax={};Ajax.objectCounter=0;Ajax.methodEnum={GET:"GET",POST:"POST"};Ajax.typeEnum={ASYNC:true,SYNC:false};Ajax.responseTypeEnum={OK:200,FAIL:400,TIMEOUT:-15000,UNAVAILABLE:503};Ajax.objectTypeEnum={ACTIVEX:4,XHR:5};Ajax.Headers=ISQ.Base.extend({name:"Ajax.Headers"});Ajax.Headers.prototype.ctor=function(){};Ajax.Headers.prototype.dtor=function(){if(this.mArray!==null){delete this.mArray}};Ajax.Headers.prototype.mArray=null;Ajax.Headers.prototype.arraySize=0;Ajax.Headers.prototype.add=function(a,b){if(this.mArray===null){this.mArray=[]}if(typeof(a)!=="string"||typeof(b)!=="string"){throw ("headers add: name, value type are wrong")}this.mArray[a]=b;++this.arraySize};Ajax.Headers.prototype.remove=function(a){if(this.mArray===null){return}if(typeof(a)!=="string"){throw ("headers remove: name type is wrong")}if(typeof(this.mArray[a])!=="undefined"){delete this.mArray[a]}};Ajax.Headers.prototype.update=function(a,b){if(this.mArray===null){return}if(typeof(a)!=="string"||typeof(b)!=="string"){throw ("headers update: name, value type are wrong")}this.mArray[a]=b};Ajax.Headers.prototype.getValue=function(a){if(this.mArray===null){return null}if(typeof(this.mArray[a])!=="undefined"){return this.mArray[a]}else{return null}};Ajax.Token=ISQ.Base.extend({name:"Ajax.Token"});Ajax.Token.prototype.ctor=function(b,d,a,e,c){if(typeof(b)!=="object"){return}if(typeof(b.id)!=="undefined"){this.id=b.id}if(typeof(b.tag)!=="undefined"){this.tag=b.tag}if(typeof(b.disposable)==="boolean"){this.disposable=b.disposable}this.handleOnlyByThisToken=b.handleOnlyByThisToken===true;if(ISQ.Base.isDerivedOf(b.callback,ISQ.Handler)){this.callback=b.callback}else{if(typeof(b.callback)==="function"){this.callback=new ISQ.Handler(b.callback,null)}}};Ajax.Token.prototype.dtor=function(){delete this.tag};Ajax.Token.prototype.id=null;Ajax.Token.prototype.handleOnlyByThisToken=false;Ajax.Token.prototype.callback=null;Ajax.Token.prototype.tag=null;Ajax.Token.prototype.disposable=true;Ajax.Request=ISQ.Base.extend({name:"Ajax.Request"});Ajax.Request.prototype.ctor=function(d,b,c,a){this.mUrl=d||null;
this.mRequestMethod=(b.toUpperCase()===Ajax.methodEnum.POST)?Ajax.methodEnum.POST:Ajax.methodEnum.GET;this.mRequestType=c===Ajax.typeEnum.SYNC?Ajax.typeEnum.SYNC:Ajax.typeEnum.ASYNC;if(this.mUrl===null){throw ("Ajax.Request c'tor: No url provided")}this.mEnableStatisticsAndLog=debugLevel;if(a instanceof Ajax.Headers){this.Headers=a}else{this.Headers=new Ajax.Headers()}this.mNum=Ajax.objectCounter++;this.initRequest();this.incomingResponseEvent=new ISQ.Event();this.response=new Ajax.Response()};Ajax.Request.prototype.dtor=function(){this.incomingResponseEvent.dispose();this.mIsRunning=false;delete this.mXmlhttp;delete this.incomingResponseEvent};Ajax.Request.prototype.mNum=0;Ajax.Request.prototype.mUrl="";Ajax.Request.prototype.data="";Ajax.Request.prototype.mRequestMethod=Ajax.methodEnum.GET;Ajax.Request.prototype.mXmlhttp=null;Ajax.Request.prototype.mRequestType=Ajax.typeEnum.ASYNC;Ajax.Request.prototype.mIsRunning=false;Ajax.Request.prototype.incomingResponseEvent=null;Ajax.Request.prototype.timeout=10000;Ajax.Request.prototype.mTimeoutObject=null;Ajax.Request.prototype.mTimeoutHandled=false;Ajax.Request.prototype.mTimedOut=false;Ajax.Request.prototype.mLastSendDate=null;Ajax.Request.prototype.mNumberOfRequests=0;Ajax.Request.prototype.mAverageResponseTime=0;Ajax.Request.prototype.mLastResponseTime=0;Ajax.Request.prototype.mEnableStatisticsAndLog=false;Ajax.Request.prototype.Headers=null;Ajax.Request.prototype.Log=null;Ajax.Request.prototype.token=null;Ajax.Request.prototype.objectType=-1;Ajax.Request.prototype.response=null;Ajax.Request.prototype.initRequest=function(){var d=null;try{try{if(typeof(XMLHttpRequest)==="function"||typeof(XMLHttpRequest)==="object"){d=new XMLHttpRequest();this.objectType=Ajax.objectTypeEnum.XHR}}catch(a){d=null}if(d===null&&(typeof(ActiveXObject)==="function"||typeof(ActiveXObject)==="object")){for(var c=6;c>=-1;--c){try{if(c===-1){d=new Ajax.ActiveX("Microsoft.XMLHTTP")}else{if(c===0){d=new Ajax.ActiveX("MSXML2.XMLHTTP")}else{d=new Ajax.ActiveX("MSXML2.XMLHTTP."+c+".0")}}break}catch(a){d=null
}}if(d===null){throw ("No Ajax object supported")}this.objectType=Ajax.objectTypeEnum.ACTIVEX}else{if(d===null){throw ("No Ajax object supported")}}}catch(b){if(debugLevel){alert("Ajax request: create ajax object exp: "+b)}this.mXmlhttp=null;this.addToLog("Exception. Couldnt create xmlhttp object.");throw (b)}this.mXmlhttp=d;this.mXmlhttp.referrence=this};Ajax.Request.prototype.send=function(a,d){if(this.mXmlhttp===null){throw ("no xml object created")}else{if(!(this.Headers instanceof Ajax.Headers)){throw ("Ajax Headers is not instanceof Ajax.Headers")}else{if(this.mIsRunning){throw ("Ajax is already running!")}}}this.mIsRunning=true;a=a||"";this.data=a;if(typeof(d)!=="undefined"){this.token=d}if(this.token!==null&&!this.token instanceof Ajax.Token){throw ("Ajax.Request.prototype.send: token is not of type Ajax.Token")}if(this.mRequestMethod===Ajax.methodEnum.GET){if(a){this.mUrl+="?"+a}}else{if(this.Headers.getValue("Content-Type")===null){this.Headers.add("Content-Type","application/x-www-form-urlencoded")}}var e=this.mUrl;if(ISQ.Http.browser.isIOS6){e+="?"+new Date().getTime()}this.mXmlhttp.open(this.mRequestMethod,e,this.mRequestType);for(var b in this.Headers.mArray){this.mXmlhttp.setRequestHeader(b,this.Headers.mArray[b])}if(ISQ.Http.browser.app==="ie"||ISQ.Http.browser.app==="opera"){this.mXmlhttp.onreadystatechange=function(){switch(this.readyState){case 1:break;case 2:break;case 3:break;case 4:this.referrence.handleResponse();break}};if(!ISQ.Http.browser.isIE6){this.mXmlhttp.onerror=function(){this.referrence.handleResponse()}}}else{this.mXmlhttp.onload=function(){this.referrence.handleResponse()};this.mXmlhttp.onerror=function(){this.referrence.handleResponse()};if(ISQ.Http.browser.app=="symbian"){var c=this.mXmlhttp;this.mXmlhttp.onreadystatechange=function(){if(c.readyState!==4){return}c.referrence.handleResponse()}}}var f=this.mXmlhttp;this.mTimeoutObject=setTimeout(function(){f.referrence.mTimeoutHandled=false;f.referrence.mTimedOut=true;f.abort();if(!f.referrence.mTimeoutHandled){f.referrence.handleResponse()
}f.referrence.mTimedOut=false},this.timeout);if(this.mEnableStatisticsAndLog){this.mLastSendDate=new Date()}f.referrence.mTimedOut=false;if(this.mRequestMethod===Ajax.methodEnum.POST){this.mXmlhttp.send(this.data)}else{this.mXmlhttp.send(null)}};Ajax.Request.prototype.handleError=function(a){a.type=Ajax.responseTypeEnum.FAIL;this.mIsRunning=false;this.incomingResponseEvent.dispatch(a)};Ajax.Request.prototype.handleTimeout=function(a){a.type=Ajax.responseTypeEnum.TIMEOUT;this.mIsRunning=false;this.mTimeoutHandled=true;this.incomingResponseEvent.dispatch(a)};Ajax.Request.prototype.handleResponse=function(){if(this.mEnableStatisticsAndLog){var now=new Date();this.mLastResponseTime=now-this.mLastSendDate;var totalTime=(this.mAverageResponseTime*this.mNumberOfRequests++);this.mAverageResponseTime=(totalTime+this.mLastResponseTime)/this.mNumberOfRequests}clearTimeout(this.mTimeoutObject);this.mTimeoutObject=null;var response=this.response;response.request=this;response.token=this.token;this.token=null;try{response.status=this.mXmlhttp.status;if(!response.status){response.status=400}response.statusText=this.mXmlhttp.statusText||""}catch(e){if(this.mTimedOut){response.status=-1;response.statusText="Timed Out"}else{response.corrupted=true;response.status=400;response.statusText="Fail"}}if(this.objectType===Ajax.objectTypeEnum.XHR){try{if(!this.mXmlhttp.getAllResponseHeaders()){this.mTimedOut=true;response.corrupted=true}}catch(e){this.mTimedOut=true}}try{response.text="";response.xml=null;response.json=null;try{response.text=this.mXmlhttp.responseText||""}catch(e){response.text=""}if(response.text!==""){try{var fixedText=null;var l=response.text.length;for(var i=0;i<l;++i){var _code=response.text.charCodeAt(i);if(fixedText){if(_code<8){continue}fixedText.push(response.text.charAt(i))}if(_code>=8){continue}fixedText=new Array(l);fixedText.push(response.text.substring(0,i));continue}if(fixedText){response.text=fixedText.join("");fixedText=null}var contentType="text/html";if(this.objectType===Ajax.objectTypeEnum.ACTIVEX){contentType=this.mXmlhttp.responseHeaders.getValue("content-type")
}else{contentType=this.mXmlhttp.getResponseHeader("content-type");if(contentType===null){contentType=this.mXmlhttp.getResponseHeader("Content-Type")}if(contentType===null){contentType=this.mXmlhttp.getResponseHeader("CONTENT-TYPE")}}if(contentType!==null&&contentType.indexOf("text/xml")!==-1&&typeof(ISQ.Data.Xml.toXML)==="function"){if(ISQ.Http.browser.full.startsWith("safari3")){response.text=response.text.replace(/\[CDATA\[\]\]/gi,"[CDATA[safari3_emptyCDataFix]]")}response.xml=ISQ.Data.Xml.toXML(response.text);if(ISQ.Http.browser.full.startsWith("safari3")){this.removeSafari3Fix(response.xml)}}else{if(contentType!==null&&contentType.indexOf("text/javascript")!==-1){try{response.json=eval("("+response.text+")")}catch(ex){}}}}catch(ex){if(debugLevel&&typeof(ISQ.Debug)!=="undefined"){_debug().insertText("Ajax.handleResponse exp(1):"+ex)}response.text="";response.xml=null;response.json=null}}if(this.mTimedOut){this.handleTimeout(response)}else{if(response.status===200){response.type=Ajax.responseTypeEnum.OK;this.mIsRunning=false;this.incomingResponseEvent.dispatch(response)}else{if(response.status===503){response.type=Ajax.responseTypeEnum.UNAVAILABLE;this.mIsRunning=false;this.incomingResponseEvent.dispatch(response)}else{if(response.status===12029||response.status===12152){this.handleTimeout(response)}else{this.handleError(response)}}}}}catch(ex){if(debugLevel>1&&typeof(ISQ.Debug)!=="undefined"){_debug().insertText("Ajax.handleResponse exp(2):"+ex)}this.handleError(response)}if(this.response){this.response.clear()}};Ajax.Request.prototype.removeSafari3Fix=function(c){var a=c.childNodes;for(var b=0;b<a.length;++b){if(a[b].nodeType===1){this.removeSafari3Fix(a[b])}else{if(a[b].nodeType===4){var d=a[b].nodeValue;if(d==="safari3_emptyCDataFix"){a[b].nodeValue=""}}}}};Ajax.Request.prototype.addToLog=function(b){if(!b||!this.mEnableStatisticsAndLog){return}var a=new Date();var c=a.ToString("%d/%m/%y   %H:%M:%S");if(this.Log===null){this.Log=new Array()}this.Log.push(c+"  -  "+b)};Ajax.Request.prototype.logToHTML=function(){var a=new Array();
var c=this.Log.length;for(var b=0;b<c;++b){a.push(this.Log[b]+"<br/>")}return a.join("")};Ajax.Request.prototype.logToString=function(){var a=new Array();var c=this.Log.length;for(var b=0;b<c;++b){a.push(this.Log[b]+"\n")}return a.join("")};Ajax.ActiveX=function(c){var a=new ActiveXObject(c);var b=null;b={_ax:a,responseText:"",responseXml:null,readyState:0,status:0,statusText:0,onreadystatechange:null,referrence:null,responseHeaders:null};b._onreadystatechange=function(){var n=b;n.readyState=n._ax.readyState;if(n.readyState===4){try{n.responseXml=n._ax.responseXml;n.responseText=n._ax.responseText;n.status=n._ax.status;n.statusText=n._ax.statusText}catch(j){n.responseText="";n.responseXml=null;n.status=400;n.statusText="";if(debugLevel){alert(j.message)}}var h=n._ax.getAllResponseHeaders();n.responseHeaders=new Ajax.Headers();var g=h.split("\n");for(var k=0;k<g.length;++k){var d=g[k];if(d.Trim()===""){continue}var f=d.length;var l=new Array();var m=0;while(m<f&&d.charAt(m)!==":"){l.push(d.charAt(m++))}++m;var o=new Array();while(m<f){o.push(d.charAt(m++))}n.responseHeaders.add(l.join("").toLowerCase(),o.join("").toLowerCase())}n.abort()}if(typeof(n.onreadystatechange)==="function"){n.onreadystatechange()}};b.open=function(d,f,h,g,e){h=(h!==false);this._ax.onreadystatechange=this._onreadystatechange;this._ax.open(d,f,h,g,e)};b.send=function(d){d=d||null;this._ax.send(d)};b.setRequestHeader=function(d,e){if(!d||!e){return}this._ax.setRequestHeader(d,e)};b.abort=function(){this._ax.abort()};return b};Ajax.Response=ISQ.Base.extend({name:"Ajax.Pool.Response"});Ajax.Response.prototype.ctor=function(){};Ajax.Response.prototype.dtor=function(){delete this.data;delete this.text;delete this.xml;delete this.json;delete this.request;delete this.type;delete this.status;delete this.statusText;delete this.corrupted;if(this.token!==null&&this.token.disposable){this.token.dispose()}this.token=null;delete this.token};Ajax.Response.prototype.clear=function(){this.data=null;this.text=null;this.xml=null;this.json=null;if(this.token!==null&&this.token.disposable){this.token.dispose()
}this.token=null;this.request=null;this.type=Ajax.responseTypeEnum.FAIL;this.status=400;this.statusText="Bad Request";this.corrupted=false};Ajax.Response.prototype.data=null;Ajax.Response.prototype.text=null;Ajax.Response.prototype.xml=null;Ajax.Response.prototype.json=null;Ajax.Response.prototype.token=null;Ajax.Response.prototype.request=null;Ajax.Response.prototype.type=Ajax.responseTypeEnum.FAIL;Ajax.Response.prototype.status=400;Ajax.Response.prototype.statusText="Bad Request";Ajax.Response.prototype.corrupted=false;</script>
    <script type="text/javascript">if(typeof(Ajax)==="undefined"){throw ("Ajax Pool: missing Ajax namespace")}Ajax.Pool=ISQ.Base.extend({name:"Ajax.Pool"});Ajax.Pool.prototype.ctor=function(f,j,b,c,d,a){try{j=j||0;f=f||null;if(f===null){throw ("ajax pool init - no default url");return null}if(j===0){return null}this.mDebug={};this.mDebug.mSentRequests=0;this.mDebug.mCanceledRequests=0;this.mDebug.mReceivedResponses=0;this.queue=new ISQ.Infra.Queue();this.size=this.freeAjax=j;this.Defaults={};this.Defaults.method=b||Ajax.methodEnum.POST;this.Defaults.requestType=c||Ajax.typeEnum.ASYNC;this.Defaults.url=f;this.Defaults.timeout=d||10000;this.Defaults.Headers=a||new Ajax.Headers();this.state=Ajax.Pool.stateEnum.GO;this.ajaxPool=new Array();for(var h=0;h<this.size;++h){this.ajaxPool[h]=new Ajax.Request(this.Defaults.url,this.Defaults.method,this.Defaults.requestType,this.Defaults.Headers);this.ajaxPool[h].incomingResponseEvent.addHandler(this.responseHandler,this);this.ajaxPool[h].timeout=d}this.incomingResponseEvent=new ISQ.Event();Ajax.Pool.RequestInfo.Pool.init(5)}catch(g){throw (g.message)}};Ajax.Pool.prototype.dtor=function(){if(this.isDisposed){return}this.isDisposed=true;this.stop();this.incomingResponseEvent.dispose();this.queue.dispose();this.abortAll();delete this.Defaults;delete this.mDebug};Ajax.Pool.prototype.incomingResponseEvent=null;Ajax.Pool.prototype.queue=null;Ajax.Pool.prototype.size=0;Ajax.Pool.prototype.freeAjax=0;Ajax.Pool.prototype.ajaxPool=null;Ajax.Pool.prototype.hasInitiated=false;Ajax.Pool.prototype.mDebug=null;Ajax.Pool.prototype.isPrepareToDie=false;Ajax.Pool.prototype.Defaults=null;Ajax.Pool.prototype.state=null;Ajax.Pool.prototype.stop=function(){this.state=Ajax.Pool.stateEnum.STOP};Ajax.Pool.prototype.go=function(){if(this.state===Ajax.Pool.stateEnum.STOP){this.state=Ajax.Pool.stateEnum.GO;this.processQ()}};Ajax.Pool.prototype.restart=function(){this.clear();this.go()};Ajax.Pool.prototype.clear=function(){this.queue.reset()};Ajax.Pool.prototype.abortAll=function(){for(var b=0;b<this.size;++b){var a=this.ajaxPool[b];a.incomingResponseEvent.removeHandler(this.responseHandler,this);
if(a.mIsRunning){a.incomingResponseEvent.addHandler(this.responseHandler,this)}else{a.dispose()}}};Ajax.Pool.prototype.setDefaultHeaders=function(a){if(a instanceof Ajax.Headers){if(this.Defaults.Headers!==null){this.Defaults.Headers.dispose()}this.Defaults.Headers=a}};Ajax.Pool.prototype.processQ=function(){if(this.isDisposed()){return}if(this.state===Ajax.Pool.stateEnum.STOP){return}if(this.queue.count()===0){return}try{var a=null;for(var d=0;d<this.size&&a===null;++d){if(!this.ajaxPool[d].mIsRunning){a=this.ajaxPool[d]}}if(a!==null){a.Headers=null;var f=null;do{if(f){Ajax.Pool.RequestInfo.Pool.returnObject(f);++this.mDebug.mCanceledRequests}f=this.queue.dequeue()}while(f&&f.mCanceled);if(f){if(f.mUrl!==null){a.mUrl=f.mUrl}else{a.mUrl=this.Defaults.url}if(f.mHeaders!==null){a.Headers=f.mHeaders}else{a.Headers=this.Defaults.Headers}if(f.mTimeout!==null){a.timeout=f.mTimeout}else{a.timeout=this.Defaults.timeout}if(f.mToken!==null){a.token=f.mToken}else{a.token=null}if(f.mMethod!==null){a.mRequestMethod=f.mMethod}else{a.mRequestMethod=this.Defaults.method}var b=f.mData;Ajax.Pool.RequestInfo.Pool.returnObject(f);try{--this.freeAjax;++this.mDebug.mSentRequests;if(this.isPrepareToDie){a.mRequestType=Ajax.typeEnum.SYNC}a.send(b)}catch(c){++this.freeAjax;--this.mDebug.mSentRequests;if(debugLevel){if(typeof(_debug)==="function"){_debug().insertText("Ajax pool processQ: send data exception: "+c)}else{alert("Ajax pool processQ: send data exception: "+c)}}}}}else{}}catch(c){if(debugLevel){alert("Ajax pool process Q exception: "+c)}}};Ajax.Pool.prototype.add=function(){if(this.isDisposed()){return}var a;if(arguments.length===1&&typeof(arguments[0])==="object"){a=arguments[0]}else{a={data:arguments[0],url:arguments[1],token:arguments[2],headers:arguments[3],timeout:arguments[4],priority:arguments[5],method:arguments[6]}}a.priority=a.priority===true;if(a.token!==null&&!a.token instanceof Ajax.Token){throw ("Ajax.Pool.prototype.add: token is not of type Ajax.Token")}var b=Ajax.Pool.RequestInfo.Pool.getObject();b.mData=a.data||"";
b.mUrl=a.url||null;b.mToken=a.token||null;b.mHeaders=a.headers||null;b.mTimeout=a.timeout||null;b.mMethod=a.method||null;if(a.priority){this.queue.priorityEnqueue(b)}else{this.queue.enqueue(b)}if(!this.isPrepareToDie){var c=this;setTimeout(function(){c.processQ()},0)}else{this.processQ()}return b.mIndex};Ajax.Pool.prototype.cancelRequest=function(a){var b=Ajax.Pool.RequestInfo.Pool.getUsedObjectByIndex(a);if(b===null){return false}b.mCanceled=true;return true};Ajax.Pool.prototype.responseHandler=function(b){try{if(this.isDisposed()){return}++this.freeAjax;++this.mDebug.mReceivedResponses;this.incomingResponseEvent.dispatch(b);if(this.isDisposed()){return}if(!this.isPrepareToDie){var c=this;setTimeout(function(){c.processQ()},0)}else{this.processQ()}}catch(a){alert("Ajax.Pool.responseHandler: "+a.message+"\n\nRequest: "+b.request.data+"\n\nUrl:"+b.request.mUrl)}};Ajax.Pool.stateEnum={GO:1,STOP:2};Ajax.Pool.RequestInfo=ISQ.Base.extend({name:"Ajax.Pool.RequestInfo"});Ajax.Pool.RequestInfo.ndx=0;Ajax.Pool.RequestInfo.prototype.ctor=function(){};Ajax.Pool.RequestInfo.prototype.dtor=function(){};Ajax.Pool.RequestInfo.prototype.mData=null;Ajax.Pool.RequestInfo.prototype.mHeaders=null;Ajax.Pool.RequestInfo.prototype.mToken=null;Ajax.Pool.RequestInfo.prototype.mUrl=null;Ajax.Pool.RequestInfo.prototype.mTimeout=null;Ajax.Pool.RequestInfo.prototype.mIsInUse=false;Ajax.Pool.RequestInfo.prototype.mIndex=-1;Ajax.Pool.RequestInfo.prototype.mCanceled=false;Ajax.Pool.RequestInfo.prototype.mMethod=Ajax.methodEnum.POST;Ajax.Pool.RequestInfo.Pool={};Ajax.Pool.RequestInfo.Pool.arr=null;Ajax.Pool.RequestInfo.Pool.init=function(b){Ajax.Pool.RequestInfo.Pool.arr=[];for(var a=0;a<b;++a){Ajax.Pool.RequestInfo.Pool.arr.push(new Ajax.Pool.RequestInfo())}};Ajax.Pool.RequestInfo.Pool.getUsedObjectByIndex=function(a){var b;for(i=0;i<Ajax.Pool.RequestInfo.Pool.arr.length;++i){b=Ajax.Pool.RequestInfo.Pool.arr[i];if(b.mIndex===a){return b}}return null};Ajax.Pool.RequestInfo.Pool.getObject=function(){var c=null;var a;for(a=0;a<Ajax.Pool.RequestInfo.Pool.arr.length;
++a){c=Ajax.Pool.RequestInfo.Pool.arr[a];if(c.mIsInUse===true){continue}c.mIsInUse=true;c.mIndex=Ajax.Pool.RequestInfo.ndx++;c.mCanceled=false;return c}c=new Ajax.Pool.RequestInfo();c.mIsInUse=true;var b=[];for(a=0;a<Ajax.Pool.RequestInfo.Pool.arr.length;++a){b.push(Ajax.Pool.RequestInfo.Pool.arr[a])}b.push(c);c.mIndex=Ajax.Pool.RequestInfo.ndx++;return c};Ajax.Pool.RequestInfo.Pool.returnObject=function(a){a.mData=null;a.mHeaders=null;a.mToken=null;a.mUrl=null;a.mTimeout=null;a.mIsInUse=false;a.mCanceled=false;a.mMethod=Ajax.methodEnum.POST};</script>
    <script type="text/javascript">ISQ.CDC=initializeNS("ISQ.CDC");if(typeof(nanoRep)==="undefined"){window.nanoRep={}}if(typeof(nanoRep.CDC)==="undefined"){nanoRep.CDC={}}nanoRep.CDC.Helper={splitURLArguments:function(e){var g=new Array();var i=e;var c=i.length;if(c===0){return g}var b=function(j){return unescape(j.join("").toString()).replace(/^\s+|\s+$/g,"")};var h=1;var d="";var f=0;var a=new Array();while(f<c){switch(h){case 1:if(i.charAt(f)!=="="){a.push(i.charAt(f))}else{h=2;d=b(a).toLowerCase();a=new Array()}break;case 2:if(i.charAt(f)!=="&"){a.push(i.charAt(f))}else{h=1;g[d]=b(a);a=new Array()}break}++f}if(h===2){g[d]=b(a)}return g},getTargetWindow:function(a,c){if(!a){return window.top}var g=window;if(c){g=window.parent}if(a==="parent"){return g.parent}var f=false;var d;do{try{if(g===window.top){f=true}d=g.frames[a];if(d){return d}}catch(b){}g=g.parent}while(!f);return window.top},parseMessage:function(a){if(!a){return""}var b=nanoRep.CDC.Helper.splitURLArguments(a);b.s=unescape(b.s);b.t=unescape(b.t);return b}};ISQ.CDC.User=ISQ.Base.extend({name:"ISQ.CDC.User"});ISQ.CDC.User.prototype.ctor=function(b){this.mTargetWindowName=b.targetWindowName||"";this.mProxyIFrameUrl=b.proxyIFrameUrl||null;this.mAllowMessagesFrom=b.allowMessagesFrom||null;this.incomingMessageEvent=new ISQ.Event();this.mWidget=b.widget||null;if(typeof(ISQ.CDC.users)==="undefined"){ISQ.CDC.users=new Array()}ISQ.CDC.users.push(this);if(typeof(window.postMessage)!="function"&&typeof(window.postMessage)!="object"){this.mLegacyMode=true;this.mHost_l=window.location.protocol+"//"+window.location.host;if(this.mProxyIFrameUrl){if(this.mProxyIFrameUrl.contains("?")){this.mProxyIFrameUrl+="&srv="+b.server}else{this.mProxyIFrameUrl+="?srv="+b.server}}}else{var a=this;this.mPostMessageEventListener=function(d){if(d.origin!==a.mAllowMessagesFrom){return}var c=ISQ.CDC.Helper.splitURLArguments(d.data);c.s=unescape(d.origin);c.t="*";a.dispatchMessage(c)};if(window.addEventListener){window.addEventListener("message",this.mPostMessageEventListener,false)}else{if(window.attachEvent){window.attachEvent("onmessage",this.mPostMessageEventListener)
}}}};ISQ.CDC.User.prototype.dtor=function(){if(this.mProxyIFrame_l&&this.mProxyIFrame_l.parentNode!==null){document.body.removeChild(this.mProxyIFrame_l)}if(!this.mLegacyMode){if(window.removeEventListener){window.removeEventListener("message",this.mPostMessageEventListener,false)}else{if(window.detachEvent){window.detachEvent("onmessage",this.mPostMessageEventListener)}}}};ISQ.CDC.User.prototype.sendMessage=function(b,e){e=e||"*";if(!this.mLegacyMode){var f=ISQ.CDC.Helper.getTargetWindow(this.mTargetWindowName);b+="&ord="+(++this.mMessageOrdinal);f.postMessage(b,e)}else{if(!this.mMessagesOnSent){this.mMessagesOnSent=new Array()}if(!this.mProxyIFrameBaseUrl_l){var a=new Array();a.push(this.mProxyIFrameUrl);a.push("#");a.push("s=");a.push(escape(this.mHost_l));a.push("&t=");a.push(escape(e));a.push("&twnd=");a.push(this.mTargetWindowName);this.mProxyIFrameBaseUrl_l=a.join("")}var c=function(g,l,h,n){var o=new Array();o.push(g.mProxyIFrameBaseUrl_l);o.push("&");o.push(h);o.push("&ord=");o.push(l);var m="position: absolute; left: 0px; top:-1100px;height:70px;width:70px;";var i=document.createElement("iframe");var j=ISQ.CDC.User.getIframeId();i.setAttribute("id",j);i.setAttribute("name",j);i.setAttribute("src",o.join(""));i.setAttribute("frameBorder","1");i.setAttribute("scrolling","auto");i.setAttribute("width","70px");i.setAttribute("height","70px");i.setAttribute("style",m);if(i.style.setAttribute){i.style.setAttribute("cssText",m)}document.body.appendChild(i);var k=function(){setTimeout(function(){g.mMessagesOnSent[l]=null},100)};if(ISQ.Http.browser.app==="opera"){i.onload=k}else{if(document.addEventListener){i.addEventListener("load",k,true)}else{if(document.attachEvent){i.attachEvent("onload",k)}}}};var d=++this.mMessageOrdinal;this.mMessagesOnSent[d]=new c(this,d,b,e)}};ISQ.CDC.User.prototype.dispatchMessage=function(d){if(d.widget&&this.mWidget!==d.widget){return}if(d.subject&&d.subject=="reset"){this.mLastHandledMessageOrdinal=0;this.mMessageOrdinal=0;this.mReceivedMessages=null;this.mWasReset_debug=true}var h=parseInt(d.ord);
var a=h-this.mLastHandledMessageOrdinal;if(a<=0){return}if(a>1){if(this.mReceivedMessages===null){this.mReceivedMessages=new Array();this.mReceivedMessagesCount=0}this.mReceivedMessages[h]=d;++this.mReceivedMessagesCount}else{try{this.incomingMessageEvent.dispatch(d)}catch(b){}if(this.mReceivedMessages!==null){var g=this.mReceivedMessagesCount;var f=h+1;for(var c=0;c<g;++c,++f){if(!this.mReceivedMessages[f]){break}this.incomingMessageEvent.dispatch(this.mReceivedMessages[f]);h=f;--this.mReceivedMessagesCount}if(this.mReceivedMessagesCount===0){this.mReceivedMessages=null}}this.mLastHandledMessageOrdinal=h}};ISQ.CDC.User.prototype.targetWindowName=function(){return this.mTargetWindowName};ISQ.CDC.User.prototype.allowMessagesFrom=function(){return this.mAllowMessagesFrom};ISQ.CDC.User.prototype.mTargetWindowName=null;ISQ.CDC.User.prototype.mLegacyMode=false;ISQ.CDC.User.prototype.mHost_l="";ISQ.CDC.User.prototype.mProxyIFrameUrl=null;ISQ.CDC.User.prototype.mProxyIFrameBaseUrl_l=null;ISQ.CDC.User.prototype.mCurrentHeight=70;ISQ.CDC.User.prototype.incomingMessageEvent=null;ISQ.CDC.User.prototype.mPostMessageEventListener=null;ISQ.CDC.User.prototype.mIsCDCStation=true;ISQ.CDC.User.prototype.mMessageOrdinal=0;ISQ.CDC.User.prototype.mAllowMessagesFrom=null;ISQ.CDC.User.prototype.mMessagesOnSent=null;ISQ.CDC.User.prototype.mReceivedMessages=null;ISQ.CDC.User.prototype.mLastHandledMessageOrdinal=0;ISQ.CDC.User.prototype.mReceivedMessagesCount=0;ISQ.CDC.User.prototype.mWasReset_debug=false;ISQ.CDC.User.getIframeId=function(){return"nR_CDC"+ISQ.CDC.User.iframeIdCounter++};ISQ.CDC.User.iframeIdCounter=new Date().getTime();</script>
    <script type="text/javascript">var VisualEffects={};VisualEffects.FadeEnum={IN:5,OUT:6};VisualEffects.Fade=function(a){this.mElement=_(a);if(this.mElement===null){throw ("VisualEffects.Fade Ctor: No valid element")}this.fadeInEvent=new ISQ.Event();this.fadeOutEvent=new ISQ.Event();return this};VisualEffects.Fade.prototype.mElement=null;VisualEffects.Fade.prototype.fadeInEvent=null;VisualEffects.Fade.prototype.fadeOutEvent=null;VisualEffects.Fade.prototype.mIsRunning=false;VisualEffects.Fade.prototype.mTimer=null;VisualEffects.Fade.prototype.mInterval=null;VisualEffects.Fade.prototype.mAmount=null;VisualEffects.Fade.prototype.mLeftAmount=null;VisualEffects.Fade.prototype.mTime=null;VisualEffects.Fade.prototype.mLastExecutionTime=null;VisualEffects.Fade.prototype.mAvailableToRun=true;VisualEffects.Fade.prototype.mCurrentDirection=null;VisualEffects.Fade.prototype.mCurrentOpacity=-1;VisualEffects.Fade.prototype.mRemoveFilterStyle=false;VisualEffects.Fade.prototype.mCancelInIe6=false;VisualEffects.Fade.prototype.stop=function(){if(this.mIsRunning){clearTimeout(this.mTimer);this.mIsRunning=false}};VisualEffects.Fade.prototype.fadeOut=function(d,b){try{this.stop();this.mCancelInIe6=b===true?true:false;this.mCurrentOpacity=this.getOpacity();if(this.mCurrentOpacity===0){this.fadeOutEvent.dispatch();return false}this.mCurrentDirection=VisualEffects.FadeEnum.OUT;this.mTime=d;this.mInterval=10;this.mLeftAmount=this.mCurrentOpacity;this.mAmount=this.mLeftAmount/(this.mTime/this.mInterval);if(ISQ.Http.browser.isIE6&&this.mCancelInIe6){this.mAmount=this.mLeftAmount}this.updateOpacity(-this.mAmount);this.mIsRunning=true;var a=this;this.mLastExecutionTime=new Date();this.mTimer=setTimeout(function(){a.fader()},this.mInterval)}catch(c){return false}return true};VisualEffects.Fade.prototype.fadeIn=function(e,d,b){try{this.stop();this.mRemoveFilterStyle=d===true?true:false;this.mCancelInIe6=b===true?true:false;this.mCurrentOpacity=this.getOpacity();if(this.mCurrentOpacity===100){this.fadeInEvent.dispatch();return false}this.mCurrentDirection=VisualEffects.FadeEnum.IN;
this.mTime=e;this.mInterval=10;this.mLeftAmount=(100-this.mCurrentOpacity);this.mAmount=this.mLeftAmount/(this.mTime/this.mInterval);if(ISQ.Http.browser.isIE6&&this.mCancelInIe6){this.mAmount=this.mLeftAmount}this.updateOpacity(this.mAmount);this.mIsRunning=true;var a=this;this.mLastExecutionTime=new Date();this.mTimer=setTimeout(function(){a.fader()},this.mInterval)}catch(c){return false}return true};VisualEffects.Fade.prototype.fader=function(){try{clearTimeout(this.mTimer);if(!this.mIsRunning){return}var b=new Date()-this.mLastExecutionTime;this.mInterval=b;this.mTime-=b;if(this.mTime<=0){this.mTime=0}switch(this.mCurrentDirection){case VisualEffects.FadeEnum.OUT:this.mLeftAmount=this.mCurrentOpacity;if(this.mTime===0){this.mTime=this.mInterval}this.mAmount=this.mLeftAmount/(this.mTime/this.mInterval);this.mAmount=this.mAmount>this.mLeftAmount?this.mLeftAmount:this.mAmount;this.updateOpacity(-this.mAmount);if(this.mCurrentOpacity===0){this.mIsRunning=false;this.fadeOutEvent.dispatch();return}break;case VisualEffects.FadeEnum.IN:this.mLeftAmount=this.mCurrentOpacity>=100?100:(100-this.mCurrentOpacity);if(this.mTime===0){this.mTime=this.mInterval}this.mAmount=this.mLeftAmount/(this.mTime/this.mInterval);this.mAmount=this.mAmount>this.mLeftAmount?this.mLeftAmount:this.mAmount;this.updateOpacity(this.mAmount);if(this.mCurrentOpacity===100){this.mIsRunning=false;if(this.mRemoveFilterStyle&&ISQ.Http.browser.app==="ie"){this.mElement.style.filter="";this.mElement.style.removeAttribute("filter")}this.fadeInEvent.dispatch();return}break}if(!this.mIsRunning){return}var a=this;this.mLastExecutionTime=new Date();this.mTimer=setTimeout(function(){a.fader()},this.mInterval)}catch(c){}};VisualEffects.Fade.prototype.getOpacity=function(){var b=100;if(ISQ.Http.browser.app==="ie"){var c=ISQ.CSS.getValue(this.mElement,"filter");if(typeof(c)!=="undefined"&&c!==null){var e=c.indexOf("alpha(opacity=");if(e!==-1){var a=c.indexOf(",");if(a===-1){a=c.indexOf(")")}var d=parseInt(c.substring(e+14,a));if(!isNaN(d)){b=d}}if(b<0){b=0}else{if(b>100){b=100
}}}}else{var c=ISQ.CSS.getValue(this.mElement,"opacity");if(typeof(c)!=="undefined"&&c!==null){var d=Number(c);if(!isNaN(d)){b=d;b*=100;if(b<0){b=0}else{if(b>100){b=100}}}}}return b};VisualEffects.Fade.prototype.setOpacity=function(a){this.updateOpacity(-this.mCurrentOpacity+a)};VisualEffects.Fade.prototype.updateOpacity=function(c){this.mCurrentOpacity+=c;if(this.mCurrentOpacity<0){this.mCurrentOpacity=0}else{if(this.mCurrentOpacity>100){this.mCurrentOpacity=100}}if(ISQ.Http.browser.app==="ie"){var a=new Array();a.push("alpha(opacity=");a.push(this.mCurrentOpacity);a.push(")");this.mElement.style.filter=a.join("")}else{var b=parseInt(this.mCurrentOpacity)/100;this.mElement.style.opacity=b}};</script>
    <script type="text/javascript">ISQ.GUI=initializeNS("ISQ.GUI");ISQ.GUI.ProgressAnimation=ISQ.Base.extend({name:"ISQ.GUI.ProgressAnimation"});ISQ.GUI.ProgressAnimation.prototype.ctor=function(a){this.mDiv=a.container;this.mArray=new Array();var d=this.mOpacityMaxValue;for(var c=0;c<this.mDivCounter;++c){d-=this.mOpacityDiff;var b=createDiv(this.mDiv,a.boxStyle);if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){b.innerHTML="&nbsp;"}this.mArray[c]={div:b,opacity:d,increment:this.mIncrementValue}}};ISQ.GUI.ProgressAnimation.prototype.dtor=function(){this.stop()};ISQ.GUI.ProgressAnimation.prototype.show=function(a){if(a){if(!this.mOriginalClassName){this.mOriginalClassName=this.mDiv.className}this.mDiv.className=a}this.mDiv.style.display="block";this.start()};ISQ.GUI.ProgressAnimation.prototype.start=function(){if(this.mTimer){return}this.timerFunc()};ISQ.GUI.ProgressAnimation.prototype.timerFunc=function(){if(this.mIsDisposed){return}for(var a=0;a<this.mArray.length;++a){ISQ.CSS.setOpacity(this.mArray[a].div,this.mArray[a].opacity);var b=this.mArray[a].opacity+this.mArray[a].increment;if(b>this.mOpacityMaxValue||b<this.mOpacityMinValue){this.mArray[a].increment*=-1;b=this.mArray[a].opacity+(this.mArray[a].increment*this.mOpacityEdgeSkip)}this.mArray[a].opacity=b}var c=this;this.mTimer=setTimeout(function(){c.timerFunc()},this.mTimerInterval)};ISQ.GUI.ProgressAnimation.prototype.stop=function(){clearTimeout(this.mTimer);this.mTimer=null};ISQ.GUI.ProgressAnimation.prototype.hide=function(){if(this.mOriginalClassName){this.mDiv.className=this.mOriginalClassName}this.mDiv.style.display="none";this.stop()};ISQ.GUI.ProgressAnimation.prototype.container=function(){return this.mDiv};ISQ.GUI.ProgressAnimation.prototype.mDiv=null;ISQ.GUI.ProgressAnimation.prototype.mOriginalClassName=null;ISQ.GUI.ProgressAnimation.prototype.mDivCounter=3;ISQ.GUI.ProgressAnimation.prototype.mOpacityDiff=12;ISQ.GUI.ProgressAnimation.prototype.mTimer=null;ISQ.GUI.ProgressAnimation.prototype.mTimerInterval=50;ISQ.GUI.ProgressAnimation.prototype.mIncrementValue=3;ISQ.GUI.ProgressAnimation.prototype.mOpacityEdgeSkip=5;
ISQ.GUI.ProgressAnimation.prototype.mOpacityMaxValue=60;ISQ.GUI.ProgressAnimation.prototype.mOpacityMinValue=20;</script>
    <script type="text/javascript">ISQ.GUI=initializeNS("ISQ.GUI");ISQ.GUI.IntuitiveInput=ISQ.Base.extend({name:"ISQ.GUI.IntuitiveInput"});ISQ.GUI.IntuitiveInput.prototype.ctor=function(a){this.mInput=a.input;this.mInput.intuitive=this;this.mOnTimeElapsedHandler=a.onTimeElapsedHandler||null;if(!this.mOnTimeElapsedHandler){throw ("Intuitive search ctor: invalid onTimeElapsedHandler")}this.mOnBeginWritingHandler=a.onBeginWritingHandler||null;this.mEnterKeyHandler=a.enterKeyHandler||null;this.mLastValue=this.mInitialValue=a.initialValue||this.mInput.value.Trim();this.mInterval=a.interval||this.mInterval;this.mOriginalKeyUpHandler=a.keyUpHandler||null;if(this.mInput.onkeyup){var b=this.mInput.onkeyup;this.mInput.onkeyup=function(c){b(c);this.intuitive.inputKeyUpHandler.apply(this.intuitive,new Array(c,this.value))}}else{this.mInput.onkeyup=this.inputKeyUpHandler}if(a.processAfterConstructor===true){this.mInput.onkeyup()}else{this.mFirstRun=false}};ISQ.GUI.IntuitiveInput.prototype.dtor=function(){this.mInput.intuitive=null;this.mInput=null;this.mOnTimeElapsedHandler.dispose();this.mOnTimeElapsedHandler=null;if(this.mOnBeginWritingHandler!==null){this.mOnBeginWritingHandler.dispose();this.mOnBeginWritingHandler=null}};ISQ.GUI.IntuitiveInput.prototype.inputKeyUpHandler=function(c,d){if(typeof(this.intuitive)!=="undefined"){arguments.callee.apply(this.intuitive,new Array(c,this.value));return}if(this.mEnterKeyHandler){var a=ISQ.Html.getDomEvent(c);if(a.domEvent.keyCode===13){this.mEnterKeyHandler.handle();return}}if(this.mFirstRun){this.mFirstRun=false;if(this.mLastValue.length===0){return}this.mOnTimeElapsedHandler.handle(this.mLastValue,true);return}if(d===this.mLastValue){return}d=d.Trim();if(this.mKeyUpTimer===null&&this.mOnBeginWritingHandler&&d!==this.mLastValue){this.mOnBeginWritingHandler.handle()}this.mLastValue=d;clearTimeout(this.mKeyUpTimer);if(d===this.mLastQuery){return}if(d.length===0){this.mOnTimeElapsedHandler.handle(d,this.mLastQuery!==d);this.mLastQuery="";this.mKeyUpTimer=null;return}var b=this;this.mKeyUpTimer=setTimeout(function(){if(b.mLastQuery===d){b.mOnTimeElapsedHandler.handle(d,false);
return}b.mLastQuery=d;b.mOnTimeElapsedHandler.handle(d,true);b.mKeyUpTimer=null},this.mInterval)};ISQ.GUI.IntuitiveInput.prototype.resetValue=function(a){if(!a){this.mInput.value=""}this.mLastValue=this.mInitialValue;this.mLastQuery=null;clearTimeout(this.mKeyUpTimer)};ISQ.GUI.IntuitiveInput.prototype.input=function(){return this.mInput};ISQ.GUI.IntuitiveInput.prototype.enable=function(){this.mInput.disabled=false};ISQ.GUI.IntuitiveInput.prototype.disable=function(){this.mInput.disabled=true};ISQ.GUI.IntuitiveInput.prototype.mInput=null;ISQ.GUI.IntuitiveInput.prototype.mLastValue="";ISQ.GUI.IntuitiveInput.prototype.mInitialValue="";ISQ.GUI.IntuitiveInput.prototype.mLastQuery=null;ISQ.GUI.IntuitiveInput.prototype.mOnTimeElapsedHandler=null;ISQ.GUI.IntuitiveInput.prototype.mOriginalKeyUpHandler=null;ISQ.GUI.IntuitiveInput.prototype.mKeyUpTimer=null;ISQ.GUI.IntuitiveInput.prototype.mInterval=500;ISQ.GUI.IntuitiveInput.prototype.mOnBeginWritingHandler=null;ISQ.GUI.IntuitiveInput.prototype.mFirstRun=true;ISQ.GUI.IntuitiveInput.prototype.mEnterKeyHandler=null;</script>
    <script type="text/javascript">ISQ.Protocol={};ISQ.Protocol.connectionStateEnum={DISCONNECTED:-1,CONNECTED:-2,CONNECTING:-3,RECONNECTING:-4,LOGIN_FAILD:-5,CONNECTION_LOST:-6,PRE_CONNECTED:-7};ISQ.Protocol.tokenEnum={LOGIN:-1,OPENCONNECTION:-2,SYSTEM:-3,LOGOUT:-5,CHANGEPASSWORD:-4,DIE:-6};ISQ.Protocol.requestId=new Date().getTime()%100000;ISQ.Protocol.QueueObejct=ISQ.Base.extend({name:"ISQ.Protocol.QueueObejct"});ISQ.Protocol.QueueObejct.indexCounter=-1;ISQ.Protocol.QueueObejct.prototype.ctor=function(a,c,b){this.mData=a;this.mToken=c;this.mTimeout=b;this.mIndex=ISQ.Protocol.QueueObejct.indexCounter--};ISQ.Protocol.QueueObejct.prototype.dtor=function(){delete this.mData;delete this.mToken;delete this.mTimeout};ISQ.Protocol.QueueObejct.prototype.mCancelTokenDispose=false;ISQ.Protocol.QueueObejct.prototype.mData="";ISQ.Protocol.QueueObejct.prototype.mToken="";ISQ.Protocol.QueueObejct.prototype.mTimeout=0;ISQ.Protocol.QueueObejct.prototype.mIndex=-1;ISQ.Protocol.mSessionIdCookie="sessionid";ISQ.Protocol.mInitCodeCookie="initcode";ISQ.Protocol.ClientBase=ISQ.Base.extend({abstractClass:true,name:"ISQ.Protocol.ClientBase"});ISQ.Protocol.ClientBase.abstractClass.onConnectionStateChanged;ISQ.Protocol.ClientBase.abstractClass.onLogin;ISQ.Protocol.ClientBase.abstractClass.createLoginRequest;ISQ.Protocol.ClientBase.abstractClass.onResponseReceived;ISQ.Protocol.ClientBase.abstractClass.onDataRequestFail;ISQ.Protocol.ClientBase.abstractClass.onIncomingData;ISQ.Protocol.ClientBase.prototype.ctor=function(a){if(typeof(a)!=="object"){throw ("Protocol abstract ctor: arguments length invalid")}this.mServer=a.server||"";this.mTtl=a.ttl||this.mTtl;this.mCconnections=a.connections;if(this.mTtl<=0||typeof(this.mTtl)!=="number"){throw ("ISQ.Protocol: Ttl is illegal")}this.mAjax=new Ajax.Pool(this.mServer,this.mCconnections,Ajax.methodEnum.POST,Ajax.typeEnum.ASYNC,this.mTtl);var b=new Ajax.Headers();b.add("Content-Type","text/xml");this.mAjax.setDefaultHeaders(b);this.connectionStateChangeEvent=new ISQ.Event();this.mRestoreSessionById=a.restoreSessionById===true;this.mSaveSessionId=a.saveSessionId===true;
this.mKeepLoggedIn=a.keepLoggedIn===true;this.mAjax.incomingResponseEvent.addHandler(this.responseHandler,this);this.mEnableStats=true;this.mKeepAlive=false;this.mInitCode=ISQ.Http.urlArguments.ic;if(this.mInitCode==null){this.mInitCode=ISQ.Http.Cookies._read(ISQ.Protocol.mInitCodeCookie)}if(this.mInitCode==null){this.mInitCode=""}this.mSaveInitCode=a.saveInitCode!==false;this.mServerLog=new ISQ.Protocol.ServerLog(this);this.mSessionId="0";if(a.sessionId){this.mSessionId=a.sessionId}return this};ISQ.Protocol.ClientBase.prototype.dtor=function(){if(this.mDisposed){return}this.mDisposed=true;this.mAjax.dispose();this.mServerLog.dispose();delete this.mLog};ISQ.Protocol.ClientBase.prototype.prepareToDie=function(a){this.stopOpenConnection();if(this.mKeepAliveToken!==null){this.mKeepAliveToken.dispose()}delete this.mKeepAliveToken;if(this.mQueue!==null){this.mQueue.dispose()}this.connectionStateChangeEvent.dispose();if(this.mReconnectEvent){this.mReconnectEvent.dispose()}this.mAjax.isPrepareToDie=true;this.mAjax.clear();if(a){this.sendCloseSessionRequest()}};ISQ.Protocol.ClientBase.prototype.sendCloseSessionRequest=function(){if(this.mSessionId!=0){this.sendWrappedData({data:this.wrapDataRequest("<die/>"),priority:true,token:new Ajax.Token({id:ISQ.Protocol.tokenEnum.DIE})})}};ISQ.Protocol.ClientBase.prototype.saveSessionCookies=function(b){var c=this.mInitCode;this.mInitCode=b||"0";var a=null;if(this.keepLoggedIn()){a=60*60*24*14}if(this.mSaveInitCode&&(c!==this.mInitCode||a)){ISQ.Http.Cookies._write(ISQ.Protocol.mInitCodeCookie,this.mInitCode,"/console",ISQ.Http.domain(),true,a)}if(this.saveSessionId()){ISQ.Http.Cookies._write(ISQ.Protocol.mSessionIdCookie,this.mSessionId,"/",ISQ.Http.domain(),true)}};ISQ.Protocol.ClientBase.prototype.mLog=null;ISQ.Protocol.ClientBase.prototype.addToLog=function(a){if(debugLevel>2){return}if(this.mLog===null){this.mLog=[]}this.mLog.push(a)};ISQ.Protocol.ClientBase.prototype.reconnectEvent=function(a){if(!this.mReconnectEvent&&!a){this.mReconnectEvent=new ISQ.Event()}return this.mReconnectEvent
};ISQ.Protocol.ClientBase.prototype.changePasswordResponseEvent=function(a){if(!this.mChangePasswordResponseEvent&&!a){this.mChangePasswordResponseEvent=new ISQ.Event()}return this.mChangePasswordResponseEvent};ISQ.Protocol.ClientBase.prototype.keepLoggedIn=function(){if(arguments.length===0){return this.mKeepLoggedIn}this.mKeepLoggedIn=arguments[0]===true};ISQ.Protocol.ClientBase.prototype.initCode=function(){return this.mInitCode};ISQ.Protocol.ClientBase.prototype.keepAlive=function(){return this.mKeepAlive};ISQ.Protocol.ClientBase.prototype.account=function(){if(arguments.length===0){return this.mAccount}this.mAccount=arguments[0].toString()};ISQ.Protocol.ClientBase.prototype.saveSessionId=function(){if(arguments.length===0){return this.mSaveSessionId}this.mSaveSessionId=arguments[0]===true};ISQ.Protocol.ClientBase.prototype.username=function(){if(arguments.length===0){return this.mUsername}this.mUsername=arguments[0]};ISQ.Protocol.ClientBase.prototype.password=function(){if(arguments.length===0){return this.mPassword}this.mPassword=arguments[0]};ISQ.Protocol.ClientBase.prototype.email=function(){if(arguments.length===0){return this.mEmail}var a=arguments[0].toString().Trim();if(!ISQ.Data.checkString(a,"email")){return false}this.mEmail=a};ISQ.Protocol.ClientBase.prototype.fullUsername=function(){if(arguments.length===0){return this.mUsername+"@"+this.mAccount}var b=arguments[0].toString().Trim();if(!ISQ.Data.checkString(b,"username")){return false}var a=b.split("@");this.mUsername=a[0];this.mAccount=a[1]};ISQ.Protocol.ClientBase.prototype.reconnectionTimeLeft=function(){return this.mReconnectTimeLeft};ISQ.Protocol.ClientBase.prototype.connected=function(){return this.mState===ISQ.Protocol.connectionStateEnum.CONNECTED};ISQ.Protocol.ClientBase.prototype.id=function(a){return this.mSessionId};ISQ.Protocol.ClientBase.prototype.connectionStateChanged=function(b,a){if(this.mDisposed){return}this.addToLog("connection state changed: "+b);this.mState=b;if(this.keepAlive()&&this.mState!==ISQ.Protocol.connectionStateEnum.CONNECTED){this.stopOpenConnection()
}this.onConnectionStateChanged(b,a);this.connectionStateChangeEvent.dispatch(this.mState,a)};ISQ.Protocol.ClientBase.prototype.loginCompleted=function(){if(this.mDisposed){return}if(this.wrapDataRequestBuffer){this.sendCloseSessionRequest()}delete this.wrapDataRequestBuffer;this.wrapDataRequestBuffer=null;this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.PRE_CONNECTED,null);this.mSessionId=arguments[0];if(this.mSessionId==""||this.mSessionId==="0"){return}this.saveSessionCookies(arguments[1]);var a=[];for(var c=2;c<arguments.length;++c){a[c-2]=arguments[c]}var b=this.onLogin.apply(this,a);this.mAjax.stop();if(this.mQueue!==null&&this.mQueue.count()>0){while(this.mQueue.count()>0){var d=this.mQueue.dequeue();if(d.mToken&&d.mCancelTokenDispose){d.mToken.disposable=true}this.mAjax.add({data:this.wrapDataRequest(d.mData),token:d.mToken,timeout:d.mTimeout});d.dispose()}this.mQueue.dispose()}this.mAjax.go();if(this.keepAlive()){this.initOpenConnection()}this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.CONNECTED,b)};ISQ.Protocol.ClientBase.prototype.changePassword=function(b){var a=[];a.push("<?xml version='1.0' encoding='UTF-8' ?><nR>");a.push("<ChangePassword username='");a.push(this.fullUsername());a.push("' email='");a.push(this.mEmail);a.push("'>");a.push("<oldPassword><![CDATA[");a.push(this.mPassword);a.push("]]></oldPassword><newPassword><![CDATA[");a.push(b);a.push("]]></newPassword></ChangePassword>");a.push("</nR>");var d=new Ajax.Token({id:ISQ.Protocol.tokenEnum.CHANGEPASSWORD});d.tag=b;var c=a.join("");this.mAjax.add({data:c,token:d})};ISQ.Protocol.ClientBase.prototype.sendData=function(){var a;if(arguments.length===1&&typeof(arguments[0])==="object"){a=arguments[0]}else{a={data:arguments[0],token:arguments[1],timeout:arguments[2],priority:arguments[3]}}if(this.mState===ISQ.Protocol.connectionStateEnum.LOGIN_FAILD||this.mState==ISQ.Protocol.connectionStateEnum.CONNECTION_LOST){return -1}if(this.mState!==ISQ.Protocol.connectionStateEnum.CONNECTED){var b=this.enqueueData_internal(a);if(this.mState===ISQ.Protocol.connectionStateEnum.DISCONNECTED){this.login()
}return b}else{a.data=this.wrapDataRequest(a.data);return this.sendWrappedData(a)}};ISQ.Protocol.ClientBase.prototype.enqueueData_internal=function(a){var b=new ISQ.Protocol.QueueObejct(a.data,a.token,a.timeout);if(this.mQueue===null){this.mQueue=new ISQ.Infra.Queue()}if(b.mToken&&b.mToken.disposable){b.mCancelTokenDispose=true;b.mToken.disposable=false}this.mQueue.enqueue(b);return b.mIndex};ISQ.Protocol.ClientBase.prototype.sendWrappedData=function(a){return this.mAjax.add(a)};ISQ.Protocol.ClientBase.prototype.cancelRequest=function(b){if(b<0){if(this.mQueue===null){return}var c=-1;for(var a=0;a<this.mQueue.length&&c===-1;++a){if(this.mQueue[a].mIndex===b){c=a}}if(c!==-1){var d=this.mQueue[c];if(d.mToken.disposable){d.mToken.dispose()}d.dispose();this.mQueue.splice(c,1)}}else{this.mAjax.cancelRequest(b)}};ISQ.Protocol.ClientBase.prototype.stripToDataAndSend=function(d,c){var a=d.request.data;var e=a.indexOf("<Session");e=a.indexOf(">",e);var b=a.indexOf("</nR>");a=a.substring(e+1,b);c=c===true;this.sendData(a,d.token,d.request.timeout)};ISQ.Protocol.ClientBase.prototype.login=function(a){if(this.mDisposed){return}if(this.mRestoreSessionById){var b=ISQ.Http.Cookies._read(ISQ.Protocol.mSessionIdCookie);if(b!==null){this.loginCompleted.apply(this,[b,this.mInitCode]);ISQ.Http.Cookies._delete(ISQ.Protocol.mSessionIdCookie,"/",ISQ.Http.domain(),true);return}}this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.CONNECTING);var c=new Ajax.Token({id:ISQ.Protocol.tokenEnum.LOGIN});this.mAjax.add({data:a||this.createLoginRequest(),token:c,priority:true})};ISQ.Protocol.ClientBase.prototype.loginWithTimeout=function(a){var b=this;setTimeout(function(){b.login(a.data)},this.loginRetryInterval)};ISQ.Protocol.ClientBase.prototype.loginRetriesReached=function(b){if(b.type===Ajax.responseTypeEnum.TIMEOUT){if(this.mReconnectTimer===null){this.mServerLog.shutdown();this.mReconnectTimeForRetry=0}this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.CONNECTION_LOST,b.status);if(this.mReconnectTimeForRetry<120){this.mReconnectTimeForRetry+=10
}this.reconnect(b)}else{if(b.type===Ajax.responseTypeEnum.UNAVAILABLE){if(this.mReconnectTimer===null){this.mServerLog.shutdown();this.mReconnectTimeForRetry=0}var c=b.status;if(b.xml){var a=b.xml.getElementsByTagName("LoginResponse");if(a.length>0){a=a[0];if(a.firstChild){c=a.firstChild.nodeValue}}}this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.CONNECTION_LOST,c);if(this.mReconnectTimeForRetry<600){this.mReconnectTimeForRetry+=30}this.reconnect(b)}else{this.mServerLog.shutdown();this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.LOGIN_FAILD,b.status)}}};ISQ.Protocol.ClientBase.prototype.wrapDataRequest=function(a){if(this.wrapDataRequestBuffer===null){this.wrapDataRequestBuffer=[];this.wrapDataRequestBuffer.push("<?xml version='1.0' encoding='UTF-8' ?><nR>");this.wrapDataRequestBuffer.push("<Session id='");this.wrapDataRequestBuffer.push(this.mSessionId);this.wrapDataRequestBuffer.push("' requestId='");this.wrapDataRequestBuffer.push(++ISQ.Protocol.requestId);this.wrapDataRequestBuffer.push("' />");this.wrapDataRequestBuffer.push(a);this.wrapDataRequestBuffer.push("</nR>")}else{this.wrapDataRequestBuffer[4]=++ISQ.Protocol.requestId;this.wrapDataRequestBuffer[6]=a}return this.wrapDataRequestBuffer.join("")};ISQ.Protocol.ClientBase.prototype.responseHandler=function(h){if(this.mDisposed){return}var j=h.token!==null?h.token.id:100;try{var f,a;if(j===ISQ.Protocol.tokenEnum.LOGIN){var g=++this.mLoginRetries>=this.mLoginRetriesMax;switch(h.type){case Ajax.responseTypeEnum.UNAVAILABLE:if(!g){this.mLoginRetries=0;if(h.xml===null){this.mServerLog.shutdown();this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.LOGIN_FAILD,"Login failed");return}f=h.xml.getElementsByTagName("LoginResponse");if(f.length===0){this.mServerLog.shutdown();this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.LOGIN_FAILD,"Login failed");return}f=f[0];a="";if(f.childNodes.length>0){a=f.firstChild.nodeValue}this.mServerLog.shutdown();this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.LOGIN_FAILD,a);return
}else{this.loginRetriesReached(h);return}break;case Ajax.responseTypeEnum.OK:this.addToLog("login:200");if(h.xml===null){this.mServerLog.shutdown();this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.LOGIN_FAILD,"Login failed");return}f=h.xml.getElementsByTagName("LoginResponse");if(f===null||f.length===0){if(++this.mLoginRetries<this.mLoginRetriesMax){this.loginWithTimeout(h.request)}else{this.loginRetriesReached(h)}return}f=f[0];var l=f.getAttribute("sessionId")||"0";var m=0;try{m=parseInt(f.getAttribute("timeout"))||0}catch(b){}try{var c=f.getAttribute("errorCode")||"0";if(c==ISQ.Protocol.tokenEnum.CHANGEPASSWORD){window.location.href="https://"+ISQ.Http.domain(true)+"/console/changePw.html?username="+this.fullUsername()+"&email="+f.firstChild.nodeValue;return}}catch(b){}var d=f.getAttribute("initCode")||"0";a="";if(f.childNodes.length>0){a=f.firstChild.nodeValue}if(l==="0"){this.mServerLog.shutdown();this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.LOGIN_FAILD,a);return}this.mLoginRetries=0;this.mKeepAliveRetries=0;this.loginCompleted(l,d,a,m);break;case Ajax.responseTypeEnum.TIMEOUT:case Ajax.responseTypeEnum.FAIL:this.addToLog("login:fail/timeout");if(h.type===Ajax.responseTypeEnum.TIMEOUT&&(!g||(h.corrupted&&this.mLoginRetries<this.mLoginRetriesMax_corrupted))){this.loginWithTimeout(h.request)}else{this.loginRetriesReached(h);return}break}}else{if(j===ISQ.Protocol.tokenEnum.DIE){return}else{if(j===ISQ.Protocol.tokenEnum.CHANGEPASSWORD){if(h.type===Ajax.responseTypeEnum.OK){var i=h.xml.getElementsByTagName("ChangePasswordResponse");if(i!==null&&i.length>0){i=i[0];var k=i.getAttribute("result");if(k==="0"){this.mPassword=h.token.tag}}}if(this.mChangePasswordResponseEvent){this.mChangePasswordResponseEvent.dispatch(h)}}else{if(j===ISQ.Protocol.tokenEnum.SYSTEM){switch(h.type){case Ajax.responseTypeEnum.FAIL:case Ajax.responseTypeEnum.UNAVAILABLE:this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.RECONNECTING,h.status);this.stripToDataAndSend(h,true);this.login();break}}else{if(j===ISQ.Protocol.tokenEnum.OPENCONNECTION){this.mWaitingForKeepAliveResponse=false;
switch(h.type){case Ajax.responseTypeEnum.OK:this.addToLog("open connection:200");this.mKeepAliveRetries=0;if(h.text.length!==0){this.onIncomingData(h)}this.restartOpenConnection(this.mOpenConnectionInterval);break;case Ajax.responseTypeEnum.TIMEOUT:case Ajax.responseTypeEnum.FAIL:case Ajax.responseTypeEnum.UNAVAILABLE:this.addToLog("open connection:fail/timeout");if((h.status!==403||h.type===Ajax.responseTypeEnum.TIMEOUT)&&++this.mKeepAliveRetries<this.mKeepAliveRetriesMax){this.doOpenConnection(this.mOpenConnectionRetryTTL)}else{this.mKeepAliveRetries=0;this.login();return}break}}else{if(j===ISQ.Protocol.tokenEnum.LOGOUT){if(h.token.tag===""){window.location.href="/console/login.html"}else{window.location.href=h.token.tag}}else{switch(h.type){case Ajax.responseTypeEnum.OK:this.addToLog("data:200, token: "+h.token);this.onIncomingData(h);break;case Ajax.responseTypeEnum.TIMEOUT:this.addToLog("data:timeout, token:"+h.token);this.onDataRequestFail(h);break;case Ajax.responseTypeEnum.FAIL:case Ajax.responseTypeEnum.UNAVAILABLE:this.addToLog("data:fail, token:"+h.token);this.onDataRequestFail(h);break}}}}}}}this.onResponseReceived(h)}catch(b){if(debugLevel>1){throw (b)}}};ISQ.Protocol.ClientBase.prototype.initOpenConnection=function(){this.mKeepAliveToken=new Ajax.Token({id:ISQ.Protocol.tokenEnum.OPENCONNECTION,disposable:false});this.buildOpenConnectionString();this.restartOpenConnection(this.mOpenConnectionInterval)};ISQ.Protocol.ClientBase.prototype.sendUpdateRequest=function(){this.doOpenConnection()};ISQ.Protocol.ClientBase.prototype.state=function(){return this.mState};ISQ.Protocol.ClientBase.prototype.doOpenConnection=function(a){a=a||this.mTtl;if(this.mState!==ISQ.Protocol.connectionStateEnum.CONNECTED){return}if(this.mWaitingForKeepAliveResponse){return}this.mWaitingForKeepAliveResponse=true;this.stopOpenConnection();if(this.isDisposed()){return}this.mAjax.add({data:this.wrapDataRequest(this.mOpenConnectionString),token:this.mKeepAliveToken,timeout:a,priority:true})};ISQ.Protocol.ClientBase.prototype.changeOpenConnectionInterval=function(a){this.mOpenConnectionInterval=a
};ISQ.Protocol.ClientBase.prototype.restartOpenConnection=function(b){var a=this;this.mOpenConnectionTimeout=setTimeout(function(){a.doOpenConnection()},b)};ISQ.Protocol.ClientBase.prototype.stopOpenConnection=function(){clearTimeout(this.mOpenConnectionTimeout)};ISQ.Protocol.ClientBase.prototype.buildOpenConnectionString=function(){var a=[];a.push("<oC ");if(this.mOpenConnectionHash){for(var b in this.mOpenConnectionHash){a.push(b);a.push("='");a.push(this.mOpenConnectionHash[b]);a.push("' ")}}a.push("/>");this.mOpenConnectionString=a.join("")};ISQ.Protocol.ClientBase.prototype.addOpenConnectionAttribute=function(b,c,a){if(!this.mOpenConnectionHash){this.mOpenConnectionHash=[]}this.mOpenConnectionHash[b]=c;if(!a){this.buildOpenConnectionString()}};ISQ.Protocol.ClientBase.prototype.replaceOpenConnectionAttribute=function(a,b){this.removeOpenConnectionAttribute(a,true);this.addOpenConnectionAttribute(a,b,true);this.buildOpenConnectionString()};ISQ.Protocol.ClientBase.prototype.removeOpenConnectionAttribute=function(b,a){if(!this.mOpenConnectionHash){return}if(!this.mOpenConnectionHash[b]){return}delete this.mOpenConnectionHash[b];if(!a){this.buildOpenConnectionString()}};ISQ.Protocol.ClientBase.prototype.logout=function(a){ISQ.Protocol.ClientBase.prototype.stopOpenConnection();this.deleteInitCode();if(this.mState===ISQ.Protocol.connectionStateEnum.CONNECTED){a=a||null;var b=new Ajax.Token({id:ISQ.Protocol.tokenEnum.LOGOUT});if(a!==null&&typeof(a)==="string"){b.tag=a}else{b.tag=""}this.sendWrappedData({data:this.wrapDataRequest("<logout />"),token:b,priority:true})}};ISQ.Protocol.ClientBase.prototype.deleteInitCode=function(){ISQ.Http.Cookies._delete(ISQ.Protocol.mInitCodeCookie,"/console",ISQ.Http.domain(),true)};ISQ.Protocol.ClientBase.prototype.reconnect=function(a){this.mReconnectTimeLeft=this.mReconnectTimeForRetry;if(this.reconnectEvent(true)){this.reconnectEvent().dispatch(this.mReconnectTimeLeft,a)}this.doReconnect()};ISQ.Protocol.ClientBase.prototype.doReconnect=function(){var a=this;this.mReconnectTimer=setTimeout(function(){a.reconnectTimerElapsed()
},this.mReconnectInterval)};ISQ.Protocol.ClientBase.prototype.reconnectTimerElapsed=function(){--this.mReconnectTimeLeft;if(this.reconnectEvent(true)){this.reconnectEvent().dispatch(this.mReconnectTimeLeft)}if(this.mReconnectTimeLeft===0){this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.RECONNECTING);this.login()}else{this.doReconnect()}};ISQ.Protocol.ClientBase.prototype.reconnectNow=function(){if(this.mState===ISQ.Protocol.connectionStateEnum.CONNECTED||this.mState==ISQ.Protocol.connectionStateEnum.CONNECTING||this.mState===ISQ.Protocol.connectionStateEnum.RECONNECTING){return}if(this.mReconnectTimer!==null){clearTimeout(this.mReconnectTimer)}this.login()};ISQ.Protocol.ClientBase.prototype.mServerLog=null;ISQ.Protocol.ClientBase.prototype.sendServerLog=function(a,b){this.mServerLog.send(a,b)};ISQ.Protocol.ClientBase.prototype.mServer="";ISQ.Protocol.ClientBase.prototype.mState=ISQ.Protocol.connectionStateEnum.DISCONNECTED;ISQ.Protocol.ClientBase.prototype.mAjax=null;ISQ.Protocol.ClientBase.prototype.mCconnections=0;ISQ.Protocol.ClientBase.prototype.mTtl=10000;ISQ.Protocol.ClientBase.prototype.mInitCode="";ISQ.Protocol.ClientBase.prototype.mSaveInitCode=true;ISQ.Protocol.ClientBase.prototype.mSessionId="0";ISQ.Protocol.ClientBase.prototype.mLoginRetries=0;ISQ.Protocol.ClientBase.prototype.mLoginRetriesMax=1;ISQ.Protocol.ClientBase.prototype.mLoginRetriesMax_corrupted=5;ISQ.Protocol.ClientBase.prototype.mKeepAliveRetries=0;ISQ.Protocol.ClientBase.prototype.mKeepAliveRetriesMax=2;ISQ.Protocol.ClientBase.prototype.mWaitingForKeepAliveResponse=false;ISQ.Protocol.ClientBase.prototype.mUsername="";ISQ.Protocol.ClientBase.prototype.mPassword="";ISQ.Protocol.ClientBase.prototype.mAccount="";ISQ.Protocol.ClientBase.prototype.mQueue=null;ISQ.Protocol.ClientBase.prototype.mEnableStats=true;ISQ.Protocol.ClientBase.prototype.wrapDataRequestBuffer=null;ISQ.Protocol.ClientBase.prototype.loginRetryInterval=3500;ISQ.Protocol.ClientBase.prototype.mKeepAlive=false;ISQ.Protocol.ClientBase.prototype.mOpenConnectionInterval=2500;
ISQ.Protocol.ClientBase.prototype.mOpenConnectionRetryTTL=3000;ISQ.Protocol.ClientBase.prototype.mOpenConnectionTimeout=null;ISQ.Protocol.ClientBase.prototype.mOpenConnectionString="";ISQ.Protocol.ClientBase.prototype.mOpenConnectionHash=null;ISQ.Protocol.ClientBase.prototype.mKeepLoggedIn=false;ISQ.Protocol.ClientBase.prototype.mSaveSessionId=false;ISQ.Protocol.ClientBase.prototype.mRestoreSessionById=false;ISQ.Protocol.ClientBase.prototype.mDisposed=false;ISQ.Protocol.ClientBase.prototype.mEmail="";ISQ.Protocol.ClientBase.prototype.mReconnectTimer=null;ISQ.Protocol.ClientBase.prototype.mReconnectTimeForRetry=10;ISQ.Protocol.ClientBase.prototype.mReconnectTimeLeft=0;ISQ.Protocol.ClientBase.prototype.mReconnectInterval=1000;ISQ.Protocol.ClientBase.prototype.mKeepAliveToken=null;ISQ.Protocol.ClientBase.prototype.connectionStateChangeEvent=null;ISQ.Protocol.ClientBase.prototype.mReconnectEvent=null;ISQ.Protocol.ClientBase.prototype.mChangePasswordResponseEvent=null;</script>
    <script type="text/javascript">ISQ.Protocol.ServerLog=ISQ.Base.extend({name:"ISQ.Protocol.ServerLog"});ISQ.Protocol.ServerLog.eLevelEnum={INFO:"Info",DEBUG:"Debug",ERROR:"Error"};ISQ.Protocol.ServerLog.prototype.ctor=function(a){if(!a.isDerivedOf(ISQ.Protocol.ClientBase)){throw ("ISQ.Protocol.ServerLog.send: clientProtocol is not of type ISQ.Protocol.BaseClient")}this.client=a;this.token=new Ajax.Token({id:ISQ.Protocol.tokenEnum.SYSTEM,disposable:false})};ISQ.Protocol.ServerLog.prototype.dtor=function(){this.shutdown();delete this.client};ISQ.Protocol.ServerLog.prototype.initialize=function(a){if(a!==""){this.enabled=true;var b=a.split("|delimiter|");this.logFilter=b[0];this.requiredLogLevel=b[1];if(this.logFilter!=="*"){this.regExp=new RegExp();this.regExp.compile(this.logFilter,"i")}}};ISQ.Protocol.ServerLog.prototype.shutdown=function(){this.regExp=null;this.enabled=false};ISQ.Protocol.ServerLog.prototype.send=function(c,d){try{if(!this.enabled){return}if(!d||d===""){return}if(this.requiredLogLevel===ISQ.Protocol.ServerLog.eLevelEnum.ERROR&&c!==ISQ.Protocol.ServerLog.eLevelEnum.ERROR){return}if(this.regExp===null||!this.regExp.test(navigator.userAgent)){return}var a=new Array();a.push("<serverLog eLevel='");a.push(c);a.push("'>");a.push(d);a.push("</serverLog>");this.client.sendData(a.join(""),this.token,null,true)}catch(b){alert(b.message)}};ISQ.Protocol.ServerLog.prototype.token=null;ISQ.Protocol.ServerLog.prototype.logFilter="";ISQ.Protocol.ServerLog.prototype.regExp=null;ISQ.Protocol.ServerLog.prototype.client=null;ISQ.Protocol.ServerLog.prototype.enabled=false;ISQ.Protocol.ServerLog.prototype.requiredLogLevel=ISQ.Protocol.ServerLog.eLevelEnum.ERROR;</script>
    <script type="text/javascript">ISQ.Protocol.WidgetClient=ISQ.Protocol.ClientBase.extend({name:"ISQ.Protocol.WidgetClient"});ISQ.Protocol.WidgetClient.enumRequestType={SENDQUERY:1,THUMBUP:2,ESCALATE:3,CONTACTFORM:4};ISQ.Protocol.WidgetClient.sessionIdKey="sid";ISQ.Protocol.WidgetClient.prototype.ctor=function(a){this.mPageUrl=a.referer||"";this.mAccount=a.account||"";this.mEnableStats=a.enableStats!==false;this.mPageId=a.pageId||null;this.mRequestedKb=a.requestedKb||null;this.mIsAnonymous=true;this.mContexts=a.contexts||null;this.mDoctype=a.doctype||"";if(this.mAccount===""){throw ("Protocol WidgetClient ctor: missing account")}this.mUsername=a.username||"";this.mPassword=a.password||"";if(this.mUsername!==""){this.mIsAnonymous=false}this.mSaveInitCode=false;return this};ISQ.Protocol.WidgetClient.prototype.dtor=function(){this.logoutTimerStop()};ISQ.Protocol.WidgetClient.prototype.closeSession=function(){if(this.connected()){this.sendCloseSessionRequest();this.mState=ISQ.Protocol.connectionStateEnum.DISCONNECTED;this.mContextsSentToServer=false}};ISQ.Protocol.WidgetClient.prototype.connected=function(){return this.mState===ISQ.Protocol.connectionStateEnum.CONNECTED};ISQ.Protocol.WidgetClient.prototype.context=function(){return this.mContexts};ISQ.Protocol.WidgetClient.prototype.saveSessionCookie=function(b){var a=[];a.push(this.mSessionId);a.push("_");a.push(new Date().getTime());a.push("_");a.push(this.mLogoutTimeout-(2*this.mOpenConnectionInterval));for(var c=0;c<b.length;++c){a.push("_");a.push(b[c])}ISQ.Http.Cookies._write(ISQ.Protocol.WidgetClient.sessionIdKey,a.join(""),"/widget",ISQ.Http.domain())};ISQ.Protocol.WidgetClient.prototype.restoreSessionFromCookie=function(){var d={result:false};if(this.mState===ISQ.Protocol.connectionStateEnum.CONNECTED||this.mState===ISQ.Protocol.connectionStateEnum.CONNECTING||this.mState===ISQ.Protocol.connectionStateEnum.RECONNECTING){return d}var a=ISQ.Http.Cookies._read(ISQ.Protocol.WidgetClient.sessionIdKey);if(!a){return d}ISQ.Http.Cookies._delete(ISQ.Protocol.WidgetClient.sessionIdKey,"/widget",ISQ.Http.domain());
if(a.length<3){return d}var e=a.split("_");var f=e[1];if(!f){return d}var c=new Date().getTime();var b=parseInt(e[2]);if(c-f>b){return d}this.mResumeSessionId=e[0];this.login();d.result=true;if(e.length>3){d.data=e.splice(3,e.length-3)}return d};ISQ.Protocol.WidgetClient.prototype.mIsAnonymous=true;ISQ.Protocol.WidgetClient.prototype.mPageUrl="";ISQ.Protocol.WidgetClient.prototype.mLogoutTimeout=-1;ISQ.Protocol.WidgetClient.prototype.mLogoutTimer=null;ISQ.Protocol.WidgetClient.prototype.mQueries=0;ISQ.Protocol.WidgetClient.prototype.mFailedDataRequests=0;ISQ.Protocol.WidgetClient.prototype.mResumeSessionId=0;ISQ.Protocol.WidgetClient.prototype.mMaxFailedDataRequests=3;ISQ.Protocol.WidgetClient.prototype.mPageId=null;ISQ.Protocol.WidgetClient.prototype.mRequestedKb=null;ISQ.Protocol.WidgetClient.prototype.mContexts=null;ISQ.Protocol.WidgetClient.prototype.mContextsSentToServer=false;ISQ.Protocol.WidgetClient.prototype.mDoctype="";ISQ.Protocol.WidgetClient.prototype.onConnectionStateChanged=function(){if(this.mState!==ISQ.Protocol.connectionStateEnum.CONNECTED){this.logoutTimerStop();this.mContextsSentToServer=false}};ISQ.Protocol.WidgetClient.prototype.onLogin=function(){if(arguments.length===0){return}this.mServerLog.initialize(arguments[0]);this.mLogoutTimeout=arguments[1]*1000;this.logoutTimerRestart();return null};ISQ.Protocol.WidgetClient.prototype.createLoginRequest=function(){var a=new Array();a.push("<?xml version='1.0' encoding='UTF-8' ?><nR>");if(!this.mIsAnonymous){a.push("<Login username='");a.push(this.fullUsername());a.push("' password='");a.push(this.mPassword);a.push("' keepLoggedIn='false' initCode='");a.push(this.mInitCode);if(this.mResumeSessionId){a.push(" resumeId='");a.push(this.mResumeSessionId);a.push("'")}a.push(" >")}else{a.push("<Login anonymous='true' ");if(this.mResumeSessionId){a.push(" resumeId='");a.push(this.mResumeSessionId);a.push("'")}a.push(" >")}a.push("<WidgetAPI version='1.23");a.push("' account='");a.push(this.mAccount);a.push("' enableStats='");a.push(this.mEnableStats);a.push("' doctype='");
a.push(this.mDoctype);if(this.mPageId){a.push("' pageId='");a.push(this.mPageId)}if(this.mRequestedKb){a.push("' requestedKb='");a.push(this.mRequestedKb)}a.push("'><pageUrl><![CDATA[");a.push(this.mPageUrl);a.push("]]></pageUrl></WidgetAPI>");a.push("</Login></nR>");return a.join("")};ISQ.Protocol.WidgetClient.prototype.onDataRequestFail=function(a){if(++this.mFailedDataRequests===this.mMaxFailedDataRequests){this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.LOGIN_FAILD,a.status);return}this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.RECONNECTING,a.status);this.sendContexts();this.stripToDataAndSend(a,true);this.login()};ISQ.Protocol.WidgetClient.prototype.onResponseReceived=function(a){this.logoutTimerRestart()};ISQ.Protocol.WidgetClient.prototype.logout=function(){this.logoutTimerElapsed()};ISQ.Protocol.WidgetClient.prototype.logoutTimerElapsed=function(){if(this.mServerLog){this.mServerLog.shutdown()}this.connectionStateChanged(ISQ.Protocol.connectionStateEnum.DISCONNECTED)};ISQ.Protocol.WidgetClient.prototype.logoutTimerStart=function(){var a=this;this.mLogoutTimer=setTimeout(function(){a.logoutTimerElapsed()},this.mLogoutTimeout)};ISQ.Protocol.WidgetClient.prototype.logoutTimerStop=function(){clearTimeout(this.mLogoutTimer)};ISQ.Protocol.WidgetClient.prototype.logoutTimerRestart=function(){this.logoutTimerStop();this.logoutTimerStart()};ISQ.Protocol.WidgetClient.prototype.onIncomingData=function(a){this.mFailedDataRequests=0;if(a.token===null||a.token.callback===null){return}a.token.callback.handle(a)};ISQ.Protocol.WidgetClient.prototype.sendContexts=function(c){if(!this.mContexts){return}if(this.mContextsSentToServer){return}var b=0;for(var a in this.mContexts){if(!this.mContexts[a]){continue}++b}if(b===0){return}var d=!c;if(d){c=[]}c.push("<setContext count='");c.push(b);c.push("'>");for(var a in this.mContexts){if(!this.mContexts[a]){continue}c.push("<![CDATA[");c.push(a);c.push("]]><![CDATA[");c.push(this.mContexts[a]);c.push("]]>")}c.push("</setContext>");if(d){_session().sendData(c.join(""))
}this.mContextsSentToServer=true};ISQ.Protocol.WidgetClient.prototype.setContext=function(a){this.mContexts=a;this.mContextsSentToServer=false;if(this.mState===ISQ.Protocol.connectionStateEnum.CONNECTED){this.sendContexts()}};ISQ.Protocol.WidgetClient.prototype.sendQuestion=function(a,f,g,d,e,h,c){++this.mQueries;var b=[];this.sendContexts(b);b.push("<question autoQuestion='");b.push(d===true);if(e===true){b.push("' isSameQuery='true")}b.push("' requestId='");b.push(g);b.push("'><text><![CDATA[");b.push(ISQ.Data.unHTML(f));b.push("]]></text>");if(typeof(h)!=="undefined"&&c){b.push("<translation language='");b.push(c);b.push("' ><![CDATA[");b.push(h);b.push("]]></translation>")}b.push("</question>");_session().sendData(b.join(""),new Ajax.Token({callback:a}))};ISQ.Protocol.WidgetClient.prototype.getAnswerById=function(c,a,e,b){++this.mQueries;var d=new Array();d.push("<getAnswerById id='");d.push(a);d.push("' requestId='");d.push(e);if(b){d.push("' autoQuestion='true")}d.push("' />");_session().sendData(d.join(""),new Ajax.Token({callback:c}))};ISQ.Protocol.WidgetClient.prototype.sendContactForm=function(c,g,d,l,f,b,h){var j=new Array();j.push("<contactForm interfaceId='");j.push(d.interfaceId);j.push("' jsonFormat='true");if(f){j.push("' language='");j.push(f)}j.push("'>");l=ISQ.Data.unHTML(l);originalSubject="";j.push("<fields><![CDATA[ [");for(var k=0;k<d.values.length;++k){var a=ISQ.Data.unHTML(d.values[k].value);if(b){a=ISQ.Data.blockCreditCardNumbers(a,b);l=ISQ.Data.blockCreditCardNumbers(l,b)}j.push('{ "name": "');j.push(ISQ.Tools.Base64.encodeString(d.values[k].name));j.push('", "type": "');j.push(d.values[k].type);j.push('", "value": "');j.push(ISQ.Tools.Base64.encodeString(a));j.push('" }');if(k!=d.values.length-1){j.push(",")}if(d.values[k].type==="subject"){l=a}if(d.values[k].type==="originalSubject"){originalSubject=a}if(typeof(d.values[k].value)==="undefined"||typeof(d.values[k].name)==="undefined"||typeof(d.values[k].type)==="undefined"){this.sendServerLog(ISQ.Protocol.ServerLog.eLevelEnum.ERROR,"Undefined value in contactForm. name:"+d.values[k].name+", type:"+d.values[k].type+", value:"+d.values[k].value)
}}j.push("] ]]></fields>");j.push("</contactForm>");var e=new Array();this.sendContexts(e);e.push("<event type='postQuestion'");e.push(" escType='");e.push(h);e.push("' >");if(f){e.push("<translation language='");e.push(f);e.push("'><![CDATA[");e.push(l);e.push("]]></translation>")}if(isNaN(g)){g=-1}e.push("<question searchResultId='");e.push(g);e.push("'><![CDATA[");e.push(originalSubject||l);e.push("]]></question>");e.push(j.join(""));e.push("</event>");_session().sendData(e.join(""),new Ajax.Token({callback:c,tag:{escType:h,query:l}}))};ISQ.Protocol.WidgetClient.prototype.escalateQuestion=function(b,a,g,e,h,f,c){var d=new Array();this.sendContexts(d);d.push("<event type='postQuestion'");d.push(" escType='");d.push(f);if(c){d.push("' chatStartAction='");d.push(c)}d.push("' >");if(e){d.push("<translation language='");d.push(e);d.push("'><![CDATA[");d.push(h);d.push("]]></translation>")}if(isNaN(a)){a=-1}d.push("<question searchResultId='");d.push(a);d.push("'><![CDATA[");d.push(ISQ.Data.unHTML(g));d.push("]]></question>");d.push("</event>");_session().sendData(d.join(""),new Ajax.Token({callback:b,tag:{escType:f,query:g}}))};ISQ.Protocol.WidgetClient.prototype.thumbUp=function(b,a,e,d,f){var c=new Array();c.push("<event type='thumb-up' topicId='");c.push(a);c.push("'><question><![CDATA[");c.push(ISQ.Data.unHTML(e));c.push("]]></question>");if(d){c.push("<translation language='");c.push(d);c.push("'><![CDATA[");c.push(f);c.push("]]></translation>")}c.push("</event>");_session().sendData(c.join(""),new Ajax.Token({callback:b}))};ISQ.Protocol.WidgetClient.prototype.translationFailed=function(d,e,a,b){var c=new Array();c.push("<event type='translationFailed' errorCode='");c.push(d);if(a!=null){c.push("' apiProvider='");c.push(a)}c.push("'>");if(e){c.push("<message><![CDATA[");c.push(e);c.push("]]></message>")}c.push("</event>");_session().sendData(c.join(""),new Ajax.Token({callback:b}))};ISQ.Protocol.WidgetClient.prototype.requestPrechatSurvey=function(a,b,c){var d=new Array();d.push("<preChatSurvey><urlBase><![CDATA[https://api.liveperson.net/api/account/");
d.push(a);d.push("]]></urlBase>");d.push("<urlParams><![CDATA[");d.push("?v=1&appKey=");d.push(b);d.push("]]></urlParams></preChatSurvey>");_session().sendData(d.join(""),new Ajax.Token({callback:c}))};ISQ.Protocol.WidgetClient.prototype.chatRequest=function(f,a,b,e,c){var d=new Array();d.push("<requestChatStart><url><![CDATA[");d.push(f);d.push(".json?v=1&appKey=");d.push(b);d.push("]]></url>");d.push("<jsonData><![CDATA[");d.push(e);d.push("]]></jsonData>");d.push("</requestChatStart>");_session().sendData(d.join(""),new Ajax.Token({callback:c}))};ISQ.Protocol.WidgetClient.prototype.requestChatSuggestions=function(a,c,d){var b=new Array();b.push("<chatSuggestion");b.push(" requestId='");b.push(d);b.push("'><![CDATA[");b.push(ISQ.Data.unHTML(c));b.push("]]>");b.push("</chatSuggestion>");_session().sendData(b.join(""),new Ajax.Token({callback:a}))};ISQ.Protocol.WidgetClient.prototype.sendChatLine=function(c,b){return;var a=new Array();a.push("<chatlinereport");a.push(" type='");a.push(c);a.push("'><![CDATA[");a.push(b);a.push("]]>");a.push("</chatlinereport>");_session().sendData(a.join(""))};ISQ.Protocol.WidgetClient.prototype.chatEnded=function(){return;_session().sendData("<chatclosedreport />")};</script>
    <script type="text/javascript">ISQ.Debug=initializeNS("ISQ.Debug");var _debug=function(){return ISQ.Debug};ISQ.Debug.insertText=function(b){if(!debugLevel){return}this.show();var a=createDiv(this.mPopup.contentNode);a.innerHTML=b};ISQ.Debug.insertHTML=function(a){if(!debugLevel){return}this.show();this.mPopup.contentNode.appendChild(a)};ISQ.Debug.insertStackCallback=function(){var f=30;var a=new Array();var b=arguments.callee.caller;b=b.caller;for(var d=0;d<f&&b!==null;++d){var c=false;for(var e=0;e<a.Length&&!c;++e){if(a[e]===b){c=true}}if(c){break}a.push(b);b=b.caller}this.insertText("Printing callstack");this.insertArray(a)};ISQ.Debug.insertArray=function(a){for(var b=0;b<a.length;++b){this.insertText(b+": "+a[b])}};ISQ.Debug.createPopup=function(){var d=createDiv(document.body,"border:1px solid #cdcdcd;background:#fff;width:300px;");var e=createElement("h2",d);e.innerHTML="Debug";var b=createLink({text:"(close)",onclick:function(){this.debugConsole.hide()},parent:d});b.debugConsole=this;var c=createDiv(d,"width:100%;height:300px;overflow-y:auto;margin-top:20px;border-top:1px solid #666;font-size:14px;font-family:verdana");c.id="nanoRepDebugDiv";this.mPopup=new ISQ.GUI.Popup({position:{type:ISQ.GUI.Popup.PositionType.SCREEN_LEFT_TOP,adjust:false},element:d,drag:true,blockerOptions:{show:false}});this.mPopup.contentNode=c};ISQ.Debug.show=function(){if(!this.mPopup){this.createPopup()}this.mPopup.show()};ISQ.Debug.hide=function(){this.mPopup.hide()};ISQ.Debug.mPopup=null;</script>
    <script type="text/javascript">ISQ.Widget=initializeNS("ISQ.Widget");ISQ.Widget.enumState={questions:1,autoQuestions:2,allQuestions:3,chat:4,chatSurvey:8,allChat:12,contactForm:16,customLink:32,nonChatEscalations:48,allEscalations:60};ISQ.Widget.enumMobileHandlingMode={none:0,inactive:1,normalWidget:2};ISQ.Widget.account="";ISQ.Widget.cdcFrame="";ISQ.Widget.sendingCDCMessages=false;ISQ.Widget.cdcVersion="1";ISQ.Widget.onloadQuestion="";ISQ.Widget.onloadQuestionId="";ISQ.Widget.isFloat=false;ISQ.Widget.referer={normal:"",escaped:""};ISQ.Widget.state=ISQ.Widget.enumState.questions;ISQ.Widget.userActive=false;ISQ.Widget.lastQueryKeyTime=0;ISQ.Widget.updateQueryDiff_ms=2000;ISQ.Widget.customTitle="";ISQ.Widget.customTeaserText="";ISQ.Widget.dynamicSize=false;ISQ.Widget.dynamicMaxSize=0;ISQ.Widget.mobileHandlingMode=ISQ.Widget.enumMobileHandlingMode.none;ISQ.Widget.isPreview=ISQ.Http.urlArguments.preview==="true";ISQ.Widget.reportEvents=ISQ.Http.hashArguments.reportevents==="true";ISQ.Widget.Log=initializeNS("ISQ.Widget.Log");ISQ.Widget.Log.statusEnum={RED:1,GREEN:2};ISQ.Widget.Log.openPopup=function(){if(!ISQ.Widget.Debug.enabled){return}if(ISQ.Widget.Log.window&&!ISQ.Widget.Log.window.closed){ISQ.Widget.Log.window.focus()}else{ISQ.Widget.Log.on()}};ISQ.Widget.Log.on=function(){var c=560;var b=screen.width-c-20;ISQ.Widget.Debug.enabled=false;var d=window.open("","nanoRepLog","width="+c+",height=330,left="+b+",top=0,scrollbars=yes");if(!d){return}if(!d.document){return}try{d.document.open();d.document.write("<html><title>widget log</title>");d.document.write("<body style='margin:10px; font-size:12px; font-family:arial;'>");d.document.write("<div id='logComments' style='width:95%; height:100%;'>");if(ISQ.Widget.Log.messages){d.document.write(ISQ.Widget.Log.messages.join(""));ISQ.Widget.Log.messages=null}d.document.write("</div></body></html>");d.document.close();ISQ.Widget.Log.window=d;ISQ.Widget.Log.element=d.document.getElementById("logComments");ISQ.Widget.Debug.enabled=true;ISQ.Widget.Log.autoScroll()}catch(a){ISQ.Widget.Debug.enabled=false}};ISQ.Widget.Log.add=function(j,i){try{if(!ISQ.Widget.Debug.enabled){return
}i=i||ISQ.Widget.Log.statusEnum.GREEN;var b="";if(i===ISQ.Widget.Log.statusEnum.GREEN){b="#006600"}else{if(i===ISQ.Widget.Log.statusEnum.RED){b="#BB0000";ISQ.Widget.Log.openPopup()}}var c=new Date();var h=[];h.push(c.ToString("%d/%m/%y %H:%M:%S"));h.push("  -  ");h.push(j);if(ISQ.Widget.Log.element){var g=ISQ.Widget.Log.window.document.createElement("span");g.style.color=b;g.innerHTML=h.join("");ISQ.Widget.Log.element.appendChild(g);var a=ISQ.Widget.Log.window.document.createElement("br",ISQ.Widget.Log.element);ISQ.Widget.Log.element.appendChild(a);ISQ.Widget.Log.autoScroll()}else{if(!ISQ.Widget.Log.messages){ISQ.Widget.Log.messages=[]}ISQ.Widget.Log.messages.push('<span style="color:');ISQ.Widget.Log.messages.push(b);ISQ.Widget.Log.messages.push('">');ISQ.Widget.Log.messages.push(h.join(""));ISQ.Widget.Log.messages.push("</span>");ISQ.Widget.Log.messages.push("<br/>")}}catch(f){}};ISQ.Widget.Log.autoScroll=function(){var a=ISQ.Widget.Log.window.document.body.scrollHeight;var b=ISQ.Widget.Log.window.document.body.offsetHeight;if(a>b){ISQ.Widget.Log.window.document.body.scrollTop=a-b}};ISQ.Widget.Log.element=null;ISQ.Widget.Log.window=null;ISQ.Widget.Log.alwaysOn=false;ISQ.Widget.Log.messages=null;ISQ.Widget.Debug=initializeNS("ISQ.Widget.Debug");ISQ.Widget.Debug.enabled=false;ISQ.Widget.Debug.register=function(){if(document.addEventListener){document.addEventListener("keyup",ISQ.Widget.Debug.keyUpEvent,true)}else{if(document.attachEvent){document.attachEvent("onkeyup",ISQ.Widget.Debug.keyUpEvent)}}};ISQ.Widget.Debug.keyUpEvent=function(b){var a=b||window.event;if(a.shiftKey&&a.ctrlKey){if(a.keyCode==81||a.keyCode==87){ISQ.Widget.Log.openPopup()}else{if(a.keyCode===90){ISQ.Widget.Debug.togglePopup()}}}};ISQ.Widget.Debug.togglePopup=function(){var a=_("debugPopup").style.display;if(a==="block"){_("debugPopup").style.display="none"}else{_("debugPopup").style.display="block"}};ISQ.Widget.Debug.closeSession=function(){_session().closeSession();ISQ.Widget.Debug.togglePopup()};ISQ.Debug.insertText=function(a,b){if(!debugLevel){return
}b=b||ISQ.Widget.Log.statusEnum.RED;ISQ.Widget.Log.add(a,b)};ISQ.Widget.init=function(){var debug=ISQ.Http.hashArguments.debug;if(debugLevel||(typeof(debug)!=="undefined"&&(debug==="true"||debug==="isq"))){ISQ.Widget.Debug.register();ISQ.Widget.Debug.enabled=true;if(ISQ.Widget.Log.alwaysOn){ISQ.Widget.Log.on()}}if(ISQ.Http.browser.isFF3){eval("[0,1]")}if(ISQ.Http.hashArguments.referer){ISQ.Widget.referer.normal=ISQ.Http.hashArguments.referer}else{if(ISQ.Http.urlArguments.referer){ISQ.Widget.referer.normal=ISQ.Http.urlArguments.referer}else{ISQ.Widget.referer.normal=""}}if(ISQ.Widget.referer.normal&&!ISQ.Widget.referer.normal.contains(":")&&!ISQ.Widget.referer.normal.contains(".")){ISQ.Widget.referer.normal=ISQ.Http.Cookies.decode64(ISQ.Widget.referer.normal)}var ndx=ISQ.Widget.referer.normal.toLowerCase().indexOf("%3a");if(ndx>6||ndx===-1){ISQ.Widget.referer.escaped=escape(ISQ.Widget.referer.normal)}else{ISQ.Widget.referer.escaped=ISQ.Widget.referer.normal;ISQ.Widget.referer.normal=unescape(ISQ.Widget.referer.normal)}ISQ.Widget.account=ISQ.Http.urlArguments.account;ISQ.Widget.Log.add("Initiating a widget for <u>"+ISQ.Widget.account+"</u> account");ISQ.Widget.cdcFrame=ISQ.Widget.getInnerFrameUrl(ISQ.Http.hashArguments.cdcframe,ISQ.Widget.referer.normal,true);if(ISQ.Widget.cdcFrame){ISQ.Widget.cdcVersion=ISQ.Http.hashArguments.cdcversion||"1"}ISQ.Widget.isFloat=ISQ.Http.hashArguments.isfloat==="true";ISQ.Widget.dynamicSize=!ISQ.Widget.isFloat&&ISQ.Http.hashArguments.dynamicsize==="true";ISQ.Widget.dynamicMaxSize=parseInt(ISQ.Http.hashArguments.dynamicmaxsize)||0;if(isNaN(ISQ.Widget.dynamicMaxSize)){ISQ.Widget.dynamicMaxSize=0}ISQ.Widget.sendingCDCMessages=window.top!==window&&(ISQ.Http.hashArguments.cnf==="true"||ISQ.Widget.supportsPostMessage||(ISQ.Widget.cdcFrame&&(ISQ.Widget.dynamicSize||ISQ.Widget.isFloat)));ISQ.Widget.CDC.init();var resetCDC=ISQ.Http.Cookies._read("resetcdc");if(resetCDC==="1"){ISQ.Http.Cookies._delete("resetcdc","/widget",ISQ.Http.domain());ISQ.Widget.CDC.sendMessage("subject=reset")}if(!ISQ.Widget.Protocol.init()){return
}ISQ.Widget.Cnf.load();var htmlCollapseHeight=ISQ.Http.hashArguments.htmlcollapseheight;if(typeof(htmlCollapseHeight)!=="undefined"){ISQ.Widget.HTML.htmlCollapseHeight=parseInt(htmlCollapseHeight)}_("footerNanoRepLink").href+=ISQ.Widget.account;_("nanoRepLogo_col").href+=ISQ.Widget.account};ISQ.Widget.pageUnload=function(){ISQ.Widget.Chat.pageUnload();if(ISQ.Widget.Log.element){ISQ.Widget.Log.element.innerHTML=""}};ISQ.Widget.Cnf=initializeNS("ISQ.Widget.Cnf");ISQ.Widget.Cnf.load=function(){if(ISQ.Http.hashArguments.cnf==="true"&&window.top!==window){ISQ.Cnf={};if(ISQ.Widget.sendingCDCMessages){ISQ.Widget.CDC.sendMessage("subject=cnf")}}else{ISQ.Tools.FileLoader.load(ISQ.Widget.buildCNFSource(null,ISQ.Widget.account,ISQ.Widget.isFloat,ISQ.Http.urlArguments.kb,ISQ.Widget.referer.escaped),new ISQ.Handler(function(){setTimeout(function(){if(ISQ.Widget.isFloat){ISQ.Cnf=ISQ.Cnf_Float}else{ISQ.Cnf=ISQ.Cnf_Embed}ISQ.Widget.Cnf.postDownload()},0)}))}};ISQ.Widget.Cnf.postDownload=function(){ISQ.Widget.loadHandler()};ISQ.Widget.Css=initializeNS("ISQ.Widget.Css");ISQ.Widget.Css.RTL_CSS_identifier="html.rtl_css_file";ISQ.Widget.Css.dynamic_RTL_CSS_identifier="html.dynamic_rtl_css_file";ISQ.Widget.loadHandler=function(){var i;if(ISQ.Http.browser.isAndroid){var size=ISQ.Html.screenSize();if(size.h===0){setTimeout(ISQ.Widget.loadHandler,10);return}}if(typeof(ISQ.Cnf.skinCSS)==="string"&&ISQ.Cnf.skinCSS){if(ISQ.Cnf.skinCSS.contains(" ")){ISQ.CSS.addNewStyle(ISQ.Cnf.skinCSS)}else{ISQ.CSS.addNewStyle(ISQ.Tools.Base64.decode(ISQ.Cnf.skinCSS))}}if(typeof(ISQ.Cnf.skinCSS_rtl)==="string"&&ISQ.Cnf.skinCSS_rtl){if(ISQ.Cnf.skinCSS_rtl.contains(" ")){ISQ.CSS.addNewStyle(ISQ.Cnf.skinCSS_rtl)}else{ISQ.CSS.addNewStyle(ISQ.Tools.Base64.decode(ISQ.Cnf.skinCSS_rtl))}}if(typeof(ISQ.Cnf.customCSS)==="string"){var customCssProcessed=false;var ndx=ISQ.Cnf.customCSS.indexOf("@import");if(ndx!==-1&&!ISQ.Http.browser.isAndroid){var customCssErr=false;var customCSS=[];var endNdx=-1;var imports=[];do{customCSS.push(ISQ.Cnf.customCSS.substring(0,ndx));ndx=ISQ.Cnf.customCSS.indexOf("(",ndx);
if(ndx===-1){customCssErr=true;break}endNdx=ISQ.Cnf.customCSS.indexOf(")",ndx);if(endNdx===-1){customCssErr=true;break}imports.push(ISQ.Cnf.customCSS.substring(ndx+2,endNdx-1));endNdx=ISQ.Cnf.customCSS.indexOf(";",endNdx);if(endNdx++===-1){customCssErr=true;break}ndx=ISQ.Cnf.customCSS.indexOf("@import",endNdx)}while(ndx!==-1);if(!customCssErr){if(endNdx!==ISQ.Cnf.customCSS.length){customCSS.push(ISQ.Cnf.customCSS.substring(endNdx))}ISQ.CSS.addNewStyle(customCSS.join(""));customCssProcessed=true;for(i=0;i<imports.length;++i){var lnk=createElement("link");lnk.rel="stylesheet";lnk.setAttribute("rel","stylesheet");lnk.href=imports[i];lnk.setAttribute("href",imports[i]);document.getElementsByTagName("HEAD")[0].appendChild(lnk)}}}if(!customCssProcessed){ISQ.CSS.addNewStyle(ISQ.Cnf.customCSS)}}if(ISQ.Cnf.applyLabelToTickets){var parts=ISQ.Cnf.applyLabelToTickets.split(",");for(i=0;i<parts.length;i++){ISQ.Forms.reportPreDefinedValue("label_"+parts[i],parts[i],"label")}}if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){setTimeout(function(){document.body.style.position="relative";document.body.style.left=0;document.body.style.top=0},0)}ISQ.Widget.Localize={};if(!ISQ.Cnf.ignoreScriptCustomValues){if(ISQ.Http.hashArguments.languagecode){ISQ.Cnf.initialUiLanguage=ISQ.Tools.getUniformLanguageCode(ISQ.Http.hashArguments.languagecode)}else{if(ISQ.Http.urlArguments.languagecode){ISQ.Cnf.initialUiLanguage=ISQ.Tools.getUniformLanguageCode(ISQ.Http.urlArguments.languagecode)}}}if(!ISQ.Cnf.initialUiLanguage){if(ISQ.Cnf.uiLanguageCode){ISQ.Cnf.initialUiLanguage=ISQ.Cnf.uiLanguageCode}else{ISQ.Cnf.initialUiLanguage=ISQ.Cnf.kbLanguageCode}}ISQ.Widget.Localize.array=ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage];if(!ISQ.Widget.Localize.array){ISQ.Cnf.initialUiLanguage="en";ISQ.Widget.Localize.array=ISQ.Widget.Texts.en}ISQ.Cnf.currentUiLanguage=ISQ.Cnf.initialUiLanguage;ISQ.Widget.Log.add("<b>UI</b> Language code:<u>"+ISQ.Cnf.currentUiLanguage+"</u>");ISQ.Widget.Log.add("<b>KB</b> Language code:<u>"+ISQ.Cnf.kbLanguageCode+"</u>");if(ISQ.Widget.Localize.array.dir!=="rtl"){ISQ.CSS.toggleCss(ISQ.Widget.Css.RTL_CSS_identifier,false);
ISQ.CSS.toggleCss(ISQ.Widget.Css.dynamic_RTL_CSS_identifier,false);ISQ.Widget.HTML.dynamicRTLCssLoaded=false}if(ISQ.Http.browser.app==="chrome"){window.onbeforeunload=ISQ.Widget.pageUnload}else{window.onunload=ISQ.Widget.pageUnload}ISQ.Widget.HTML.setPointers();ISQ.Widget.HTML.enablePIE();_("txtChatInput").value="";ISQ.Widget.HTML.queryField.value="";if(ISQ.Http.browser.isIPad||ISQ.Http.browser.isIPhone){ISQ.Widget.HTML.queryField.className+=" apple"}if(!ISQ.Cnf.ignoreScriptCustomValues){if(ISQ.Http.hashArguments.bgcolor||ISQ.Http.urlArguments.bgcolor){var color;if(ISQ.Http.hashArguments.bgcolor){color=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.bgcolor)}else{color=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.bgcolor)}_("widgetTitleWrapper").style.backgroundColor=color;ISQ.Widget.HTML.footerWrapper.style.backgroundColor=color;_("widgetMinimizedFooter").style.backgroundColor=color}if(ISQ.Http.hashArguments.teaser){ISQ.Widget.customTeaserText=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.teaser)}else{if(ISQ.Http.urlArguments.teaser){ISQ.Widget.customTeaserText=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.teaser)}}if(ISQ.Http.hashArguments.title){ISQ.Widget.customTitle=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.title)}else{if(ISQ.Http.urlArguments.title){ISQ.Widget.customTeaserText=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.title)}}if(ISQ.Http.hashArguments.color){_("widgetTitleText").style.color=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.color)}else{if(ISQ.Http.urlArguments.color){ISQ.Widget.customTeaserText=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.color)}}}_("widgetContainer").style.display="block";_("widgetLoading").style.display="none";ISQ.Widget.setInitialTexts();if(ISQ.Cnf.floatTeaser_width){ISQ.Cnf.floatTeaser_WidgetSize[0]=ISQ.Cnf.floatTeaser_width}if(!ISQ.Widget.isFloat){_("minimizeButtonWrapper").style.display="none"}var footerResult=ISQ.Data.getDBAnswerAsHtml(ISQ.Cnf.answerFooter,true);ISQ.Cnf.answerFooter=footerResult.text;ISQ.Cnf.answerFooterScript=footerResult.script;
if(ISQ.Cnf.translationEnabled){var staticTexts=[ISQ.Cnf.answerFooter,ISQ.Widget.Localize.array.searchMsgNOResults,ISQ.Widget.Localize.array.searchMsgResults,ISQ.Widget.Localize.array.newSearch,ISQ.Widget.Localize.array.askBy,ISQ.Widget.Localize.array.email,ISQ.Widget.Localize.array.chat,"Translating","Translated from "+ISQ.Tools.getLanguageName(ISQ.Cnf.kbLanguageCode)+", click to turn on or off"];try{var apiKeys=eval("({"+ISQ.Cnf.translationApiKey+"})");ISQ.Widget.TranslationHelper.init(staticTexts,ISQ.Cnf.kbLanguageCode,apiKeys,ISQ.Cnf.translationLanguages,ISQ.Cnf.translationDetectionOnly);ISQ.Translation.Infra.failureEvent.addHandler(ISQ.Widget.Translation.translationFailedHandler)}catch(ex){ISQ.Widget.Log.add("Exception initializing translations: "+ex,ISQ.Widget.Log.statusEnum.RED);ISQ.Cnf.translationEnabled=false}}ISQ.Widget.HTML.Mobile.setMode();ISQ.Widget.Query.init();if(ISQ.Cnf.limited){ISQ.Widget.HTML.limitedMode()}else{var chatResumed=false;if(ISQ.Cnf.livePersonID&&ISQ.Cnf.chatEnabled&&ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.inactive){chatResumed=ISQ.Widget.Chat.init()}if(!chatResumed&&!ISQ.Widget.onloadQuestion&&!ISQ.Widget.onloadQuestionId){ISQ.Widget.AutoQuestions.init(ISQ.Cnf.autoQuestions,ISQ.Cnf.autoQuestionsInterval,ISQ.Cnf.repeatAutoQuestions)}var initialText=ISQ.Cnf.initialText||ISQ.Widget.onloadQuestion||ISQ.Widget.onloadQuestionId;if(initialText&&((ISQ.Widget.state&ISQ.Widget.enumState.allChat)===0)){ISQ.Widget.HTML.queryField.className+=" initialText";ISQ.Widget.HTML.queryField.value=ISQ.Cnf.initialText}if(ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions||initialText){ISQ.Widget.Query.setFocus()}if(ISQ.Http.hashArguments.onloadquestion){ISQ.Widget.onloadQuestion=ISQ.Http.Cookies.decode64(ISQ.Http.hashArguments.onloadquestion)}else{if(ISQ.Http.urlArguments.onloadquestion){ISQ.Widget.onloadQuestion=ISQ.Http.Cookies.decode64(ISQ.Http.urlArguments.onloadquestion)}}if(ISQ.Http.hashArguments.onloadquestionid){ISQ.Widget.onloadQuestionId=ISQ.Http.hashArguments.onloadquestionid;
if(ISQ.Widget.onloadQuestionId){ISQ.Widget.state=ISQ.Widget.enumState.questions}}else{if(ISQ.Http.urlArguments.onloadquestionid){ISQ.Widget.onloadQuestionId=ISQ.Http.urlArguments.onloadquestionid;if(ISQ.Widget.onloadQuestionId){ISQ.Widget.state=ISQ.Widget.enumState.questions}}else{if(ISQ.Cnf.onloadQuestionId){ISQ.Widget.onloadQuestionId=ISQ.Cnf.onloadQuestionId;ISQ.Widget.state=ISQ.Widget.enumState.autoQuestions}}}}ISQ.Widget.HTML.resizeHandler();if(ISQ.Cnf.customerBrandingLogo){var img=new Image();img.onload=function(){this.loaded=true;ISQ.Widget.onCustomerLogoLoad()};ISQ.Cnf.customerBrandingLogo_img=img;img.src=ISQ.Cnf.customerBrandingLogo;ISQ.Cnf.customerBrandingLogo_img.loaded=false}if(ISQ.Cnf.hideBranding){_("footerNanoRepLink").style.display="none";_("logoInCollapsedMode").style.display="none"}if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.display="block";_("customerBrandingText").innerHTML=ISQ.Cnf.customerBrandingText}if(ISQ.Cnf.hideByEmailIcon){_("repByEmail").className="noActionBarIcon"}if(!ISQ.Http.browser.isIE6&&!ISQ.Http.browser.usesViewport){ISQ.Html.ReSize.init(ISQ.Html.ReSize.enumListenTo.both,true);ISQ.Html.ReSize.Event.addHandler(function(){ISQ.Widget.HTML.resizeHandler(null,true)})}else{if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isTablet||ISQ.Widget.mobileHandlingMode==ISQ.Widget.enumMobileHandlingMode.inactive){setInterval(ISQ.Widget.HTML.resizePollingHandler,20)}else{window.addEventListener("orientationchange",ISQ.Widget.HTML.Mobile.orientationChanged)}}var notifyClick=ISQ.Http.hashArguments.notifyclick||false;if(notifyClick==="true"&&!ISQ.Http.browser.isMobile){if(!ISQ.Http.browser.isTablet){document.onclick=function(){if(ISQ.Widget.HTML.ignoreNextClickEvent){ISQ.Widget.HTML.ignoreNextClickEvent=false;return}if(ISQ.Http.browser.isIE6){setTimeout(function(){ISQ.Widget.CDC.sendMessage("subject=click")},0)}else{ISQ.Widget.CDC.sendMessage("subject=click")}}}else{_("chatStatusWrapper").addEventListener("click",function(evt){ISQ.Widget.CDC.sendMessage("subject=click")});_("widgetTitleWrapper").addEventListener("click",function(evt){if(ISQ.Widget.HTML.Mobile.ignoreClickEvent){ISQ.Widget.HTML.Mobile.ignoreClickEvent=false;
return}ISQ.Widget.CDC.sendMessage("subject=click")});ISQ.Widget.HTML.queryField.addEventListener("click",function(evt){ISQ.Widget.CDC.sendMessage("subject=click")});_("contentAreaWrapper").addEventListener("click",function(evt){ISQ.Widget.CDC.sendMessage("subject=click")})}}ISQ.Forms.loadEvent.addHandler(ISQ.Widget.ContactForm.onload);ISQ.Forms.clickEvent.addHandler(ISQ.Widget.ContactForm.clickEventHandler);ISQ.Forms.tabEvent.addHandler(ISQ.Widget.ContactForm.tabChangedHandler);if(ISQ.Widget.sendingCDCMessages){var msg=null;if(ISQ.Widget.isFloat){msg="subject=load";if(typeof(ISQ.Cnf.dockRTL)!=="undefined"){msg+="&dockrtl="+ISQ.Cnf.dockRTL}if(ISQ.Cnf.floatOpenOnLoad===true||ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||ISQ.Widget.state===ISQ.Widget.enumState.chat||ISQ.Widget.onloadQuestion||ISQ.Widget.onloadQuestionId){msg+="&stateonload=";if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||ISQ.Widget.state===ISQ.Widget.enumState.chat||ISQ.Widget.onloadQuestion||ISQ.Widget.onloadQuestionId){msg+="expand"}else{if(ISQ.Cnf.floatOpenOnLoad===true){msg+="collapse"}else{msg+="teaser"}}}if(typeof(ISQ.Cnf.floatAutoMinimizeTimeout)!=="undefined"&&ISQ.Widget.state!==ISQ.Widget.enumState.chat&&!ISQ.Widget.onloadQuestion&&!ISQ.Widget.onloadQuestionId){msg+="&autominimize="+ISQ.Cnf.floatAutoMinimizeTimeout}if(typeof(ISQ.Cnf.floatOpenOnHover)!=="undefined"){msg+="&openonhover="+ISQ.Cnf.floatOpenOnHover}if(ISQ.Cnf.titleTeaserText){msg+="&teasertext="+ISQ.Http.Cookies.encode64(ISQ.Cnf.titleTeaserText)}if(ISQ.Cnf.generatedTeaser_textFont){msg+="&teaserfont="+ISQ.Http.Cookies.encode64(ISQ.Cnf.generatedTeaser_textFont)}if(ISQ.Cnf.titleColor){msg+="&teasercolor="+ISQ.Http.Cookies.encode64(ISQ.Cnf.titleColor)}msg+="&teaserdir="+ISQ.Widget.Localize.array.dir;if(ISQ.Cnf.generatedTeaser_textPosition){msg+="&teaserposition="+ISQ.Cnf.generatedTeaser_textPosition[0]+","+ISQ.Cnf.generatedTeaser_textPosition[1]}if(ISQ.Cnf.generatedTeaser_textSize){msg+="&teasersize="+ISQ.Cnf.generatedTeaser_textSize[0]+","+ISQ.Cnf.generatedTeaser_textSize[1]
}if(ISQ.Cnf.floatMarginSide){msg+="&marginside="+ISQ.Cnf.floatMarginSide}if(ISQ.Cnf.floatMarginBottom){msg+="&marginbottom="+ISQ.Cnf.floatMarginBottom}if(ISQ.Cnf.floatTeaser_width){msg+="&teaserwidth="+ISQ.Cnf.floatTeaser_width}if(ISQ.Cnf.containerBoxShadow){msg+="&containerBoxShadow="+ISQ.Http.Cookies.encode64(ISQ.Cnf.containerBoxShadow)}if(ISQ.Cnf.ignoreScriptCustomValues){msg+="&ignorescriptcustomvalues="+ISQ.Cnf.ignoreScriptCustomValues}ISQ.Widget.CDC.sendMessage(msg)}else{if(ISQ.Widget.dynamicSize){ISQ.Widget.HTML.dynamicSize_sendMessage(true)}}}ISQ.Widget.reportEvents|=(ISQ.Cnf.integrateWithGA===true);if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=load&integrate_ga="+(ISQ.Cnf.integrateWithGA===true))}if(!ISQ.Cnf.limited){if(ISQ.Widget.onloadQuestion){ISQ.Widget.state=ISQ.Widget.enumState.questions;ISQ.Widget.HTML.queryField.value=ISQ.Widget.onloadQuestion;ISQ.Widget.Query.analyzeQuery(ISQ.Widget.onloadQuestion);ISQ.Widget.Query.clearTextboxOnInteraction=true}else{if(ISQ.Widget.onloadQuestionId){ISQ.Widget.Query.tempQuestionTrailId=ISQ.Widget.onloadQuestionId;ISQ.Widget.Query.getAnswerById(ISQ.Widget.onloadQuestionId);ISQ.Widget.Query.clearTextboxOnInteraction=true}else{if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.go()}}}}};ISQ.Widget.setUiLanguage=function(b){if(!b){return}if(ISQ.Cnf.currentUiLanguage===b){return}var a=ISQ.Translation.Infra.getLanguageDirection(b);if(a==="rtl"&&!ISQ.Widget.HTML.dynamicRTLCssLoaded){ISQ.CSS.toggleCss(ISQ.Widget.Css.RTL_CSS_identifier,true);ISQ.CSS.toggleCss(ISQ.Widget.Css.dynamic_RTL_CSS_identifier,true);ISQ.Widget.HTML.dynamicRTLCssLoaded=true;if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=directionchanged&rtl=true")}}else{if(a==="ltr"&&ISQ.Widget.HTML.dynamicRTLCssLoaded){ISQ.CSS.toggleCss(ISQ.Widget.Css.RTL_CSS_identifier,false);ISQ.CSS.toggleCss(ISQ.Widget.Css.dynamic_RTL_CSS_identifier,false);ISQ.Widget.HTML.dynamicRTLCssLoaded=false;if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=directionchanged&rtl=false")
}}}if(ISQ.Widget.Texts[b]){ISQ.Cnf.currentUiLanguage=b;ISQ.Widget.Localize.array=ISQ.Widget.Texts[b];return}if(ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage]){ISQ.Cnf.currentUiLanguage=ISQ.Cnf.initialUiLanguage;ISQ.Widget.Localize.array=ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage];return}ISQ.Cnf.currentUiLanguage="en";ISQ.Widget.Localize.array=ISQ.Widget.Texts.en};ISQ.Widget.HTML={};ISQ.Widget.HTML.setPointers=function(){ISQ.Widget.HTML.queryField=_("txtSearch");ISQ.Widget.HTML.searchContainer=_("searchContainer");ISQ.Widget.HTML.answerPane=_("answerPane");ISQ.Widget.HTML.chatPane=_("chatPane");ISQ.Widget.HTML.contentWrapper=_("contentAreaWrapper");ISQ.Widget.HTML.titleWrapper=_("widgetTitleWrapper");ISQ.Widget.HTML.titleText=_("widgetTitleText");ISQ.Widget.HTML.actionBarWrapper=_("actionBarWrapper");ISQ.Widget.HTML.actionBarContainer=_("actionBarContainer");ISQ.Widget.HTML.actionBarQuery=_("actionBarQuery");ISQ.Widget.HTML.contactForm=_("contactForm");ISQ.Widget.HTML.searchWrapper=_("searchContainerWrapper");ISQ.Widget.HTML.chatStatus=_("chatStatus");ISQ.Widget.HTML.chatInputWrapper=_("chatInputWrapper");ISQ.Widget.HTML.txtEmailChat=_("txtEmailChat");ISQ.Widget.HTML.footerWrapper=_("widgetFooterWrapper")};ISQ.Widget.HTML.fixBrandingColor=function(){var e=ISQ.Widget.HTML.footerWrapper;var b=ISQ.CSS.getSelectorStyle("#widgetFooterWrapper");if(!b){return}var c=ISQ.Tools.stringToPairArray(b.cssText,":",";",true,true);if(c.display==="none"||c.visibility==="hidden"){return}var a=b.backgroundColor;if(!a){a=b["background-color"]}alert(a)};ISQ.Widget.HTML.Mobile={};ISQ.Widget.HTML.Mobile.ignoreClickEvent=false;ISQ.Widget.HTML.Mobile.formPredefinedData=null;ISQ.Widget.HTML.Mobile.context=null;ISQ.Widget.HTML.Mobile.positionSet=false;ISQ.Widget.HTML.Mobile.incrementedBottom=0;ISQ.Widget.HTML.Mobile.setMode=function(){if(!ISQ.Http.browser.isMobile){return}document.body.style.webkitTextSizeAdjust="100%";ISQ.Http.Cookies._delete("nouserstats","/widget",ISQ.Http.domain(false),false);if(window.top===window){ISQ.Widget.mobileHandlingMode=ISQ.Widget.enumMobileHandlingMode.normalWidget;
document.body.parentNode.style.overflow="visible";document.body.parentNode.style.height="auto";document.body.style.overflow="visible";document.body.style.height="auto";ISQ.Widget.HTML.contentWrapper.style.overflow="visible";ISQ.Widget.HTML.contentWrapper.style.overflowY="visible";ISQ.Widget.HTML.Mobile.hideAddressbar();ISQ.Widget.HTML.queryField.style.display="block";ISQ.Widget.setTitle();_("minimizeButtonWrapper").style.display="none";var a=null;if(window.localStorage){a=window.localStorage.getItem("nanorep.api."+ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped))}if(!a){a=ISQ.Http.Cookies._readCaseSensitive(ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped));if(a){ISQ.Http.Cookies._delete(ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped),"/widget",ISQ.Http.domain(false),false)}}if(a){var a=ISQ.Tools.stringToPairArray(unescape(a),"=","&",false,false);if(a.f){ISQ.Forms.incomingPreDefinedValuesFromMessage(a.f)}if(a.c){_session().setContext(ISQ.Widget.CDC_getKeyValueArrayFromMessage(a.c))}}ISQ.Widget.HTML.Mobile.setWidths();ISQ.Widget.HTML.Mobile.setPositions()}else{ISQ.Widget.mobileHandlingMode=ISQ.Widget.enumMobileHandlingMode.inactive;ISQ.Widget.HTML.queryField.onclick=null;_("minimizeButtonWrapper").style.display="block"}};ISQ.Widget.HTML.Mobile.orientationChanged=function(){var a=ISQ.Html.screenSize();if(a.h==ISQ.Widget.HTML.currentHeight||a.w===ISQ.Widget.HTML.currentWidth){setTimeout(ISQ.Widget.HTML.Mobile.orientationChanged,20);return}ISQ.Widget.HTML.Mobile.hideAddressbar();ISQ.Widget.HTML.resizeHandler(a,true);ISQ.Widget.Query.resizeAnswerElements()};ISQ.Widget.HTML.Mobile.setPositions=function(){if(ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.normalWidget){return}if(ISQ.Cnf.customerBrandingLogo&&(!ISQ.Cnf.customerBrandingLogo_img||!ISQ.Cnf.customerBrandingLogo_img.loaded)){return}if(ISQ.Widget.HTML.Mobile.positionSet){return}ISQ.Widget.HTML.Mobile.positionSet=true;var b=new Array();b.push(ISQ.Widget.HTML.footerWrapper);b.push(_("actionBarWrapper"));b.push(_("chatInputWrapper"));
iteration(b,function(f){f.style.position="fixed";f.style.bottom=ISQ.Widget.HTML.Mobile.incrementedBottom+"px";f.style.width="100%";ISQ.Widget.HTML.Mobile.incrementedBottom+=ISQ.CSS.getElementHeight(f,true);if(ISQ.CSS.getElementStyle(f,"display")==="none"){f.style.display="none"}});ISQ.Widget.HTML.contentWrapper.style.minHeight=(window.outerHeight+ISQ.Widget.HTML.Mobile.incrementedBottom)+"px";var c=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.footerWrapper,"background-color");var d=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.footerWrapper,"opacity");if(ISQ.Tools.getOpacityFromRGBA(c)===0||d===0){var a=ISQ.CSS.getElementStyle(document.body,"background-color");if(ISQ.Tools.getOpacityFromRGBA(a)===0){ISQ.Widget.HTML.footerWrapper.style.backgroundColor="#fff"}else{ISQ.Widget.HTML.footerWrapper.style.backgroundColor=a}}if(ISQ.Http.browser.isAndroid){var e=null;window.addEventListener("touchmove",function(){iteration(b,function(f){if(f.style.display!=="none"){f.style.display="none";f.toShow=true}});clearTimeout(e)});window.addEventListener("touchend",function(){clearTimeout(e);e=setTimeout(function(){iteration(b,function(f){if(f.toShow){f.style.display="block"}f.toShow=false})},200)})}ISQ.Widget.HTML.Mobile.setScrollPaddingHeight()};ISQ.Widget.HTML.Mobile.setScrollPaddingHeight=function(){_("mobileScrollPadding").style.display="block";var a=ISQ.Widget.HTML.Mobile.incrementedBottom;_("mobileScrollPadding").style.height=a+"px"};ISQ.Widget.HTML.Mobile.beforeOpeningWidget=function(){ISQ.Http.Cookies._write("nouserstats","1","/widget",ISQ.Http.domain(false),false);var a=[];if(ISQ.Widget.HTML.Mobile.formPredefinedData){a.push("f=");a.push(ISQ.Widget.HTML.Mobile.formPredefinedData)}if(ISQ.Widget.HTML.Mobile.context){if(a.length!==0){a.push("&")}a.push("c=");a.push(ISQ.Widget.HTML.Mobile.context)}if(a.length===0){return}if(window.localStorage){window.localStorage.setItem("nanorep.api."+ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped),a.join(""))}else{ISQ.Http.Cookies._write(ISQ.Http.Cookies.encode64(ISQ.Widget.referer.escaped),a.join(""),"/widget",ISQ.Http.domain(false),false)
}};ISQ.Widget.HTML.Mobile.hideAddressbar=function(a){if(ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.normalWidget){return}setTimeout(function(){window.scrollTo(0,1)},a||0)};ISQ.Widget.HTML.Mobile.setWidths=function(a){if(!ISQ.Http.browser.usesViewport){return}if(ISQ.Widget.HTML.currentlyResizing&&!a){return}if(ISQ.Http.browser.isMobile&&ISQ.Widget.mobileHandlingMode!==ISQ.Widget.enumMobileHandlingMode.normalWidget){return}var b;b=ISQ.CSS.getElementWidth(_("widgetTitleWrapper"),true);b-=ISQ.CSS.getElementWidth(_("widgetTitleLeft"),true);b-=ISQ.CSS.getElementWidth(_("widgetTitleRight"),true);b-=ISQ.CSS.getElementWidth(_("minimizeButtonWrapper"),true);ISQ.CSS.setWidthIncludingPadding(ISQ.Widget.HTML.titleText,b-20);if(_("searchContainer").offsetWidth!==0&&ISQ.Widget.HTML.searchContainer.firstChild!==null){b=ISQ.CSS.getElementWidth(_("searchContainerWrapper"),true);ISQ.CSS.setWidthIncludingPadding(_("txtSearch"),b-20);b-=ISQ.CSS.getElementWidth(_("searchContainerLeft"),true);ISQ.Widget.HTML.searchContainer.firstChild.style.display="block";b-=ISQ.CSS.getElementWidth(ISQ.Widget.HTML.searchContainer.firstChild,true);b-=ISQ.CSS.getElementWidth(_("searchContainerRight"),true);b-=ISQ.CSS.getHorizonalMargin(_("txtSearch"));ISQ.CSS.setWidthIncludingPadding(_("txtSearch"),b-20);ISQ.Widget.HTML.searchContainer.firstChild.style.display="none"}if(_("chatStatusContainer").offsetWidth!==0){b=ISQ.CSS.getElementWidth(_("chatStatusContainer"),true);b-=ISQ.CSS.getElementWidth(_("chatStatusIcon"),true);b-=ISQ.CSS.getElementWidth(_("closeChat"),true);b-=ISQ.CSS.getHorizonalMargin(_("chatStatus"));ISQ.CSS.setWidthIncludingPadding(_("chatStatus"),b-20)}if(_("chatInputContainer").offsetWidth!==0){b=ISQ.CSS.getElementWidth(_("chatInputContainer"),true);b-=ISQ.CSS.getElementWidth(_("btnSendChat"),true);b-=ISQ.CSS.getHorizonalMargin(_("txtChatInput"));ISQ.CSS.setWidthIncludingPadding(_("txtChatInput"),b-40)}};ISQ.Widget.HTML.enablePIE=function(){if(typeof(ISQ.Cnf.roundedCornersIEEnabled)!=="undefined"&&!ISQ.Cnf.roundedCornersIEEnabled){return
}if(ISQ.Http.browser.app!=="ie"){return}if(ISQ.Http.browser.isIE6&&!ISQ.Widget.isFloat){return}if(ISQ.Http.browser.isIE6&&window.location.href.startsWith("https://")){return}PIE_init();if(typeof(PIE)==="undefined"){return}setTimeout(function(){PIE.attach(ISQ.Widget.HTML.titleWrapper)},0);setTimeout(function(){PIE.attach(ISQ.Widget.HTML.footerWrapper)},0);setTimeout(function(){PIE.attach(_("widgetMinimizedFooter"))},0);setTimeout(function(){PIE.attach(_("searchContainer"))},0);setTimeout(function(){PIE.attach(_("actionBarWrapper"))},0)};ISQ.Widget.HTML.disablePIE=function(){if(typeof(ISQ.Cnf.roundedCornersIEEnabled)!=="undefined"&&!ISQ.Cnf.roundedCornersIEEnabled){return}if(typeof(PIE)==="undefined"||ISQ.Http.browser.app!=="ie"){return}if(ISQ.Http.browser.isIE6&&!ISQ.Widget.isFloat){return}if(ISQ.Http.browser.isIE6&&window.location.href.startsWith("https://")){return}PIE.detach(ISQ.Widget.HTML.titleWrapper);PIE.detach(ISQ.Widget.HTML.footerWrapper);PIE.detach(_("widgetMinimizedFooter"));PIE.detach(_("searchContainer"));PIE.detach(_("actionBarWrapper"))};ISQ.Widget.HTML.resizeHandler=function(e,a){if(!e){e=ISQ.Html.screenSize()}ISQ.Widget.HTML.currentHeight=e.h;ISQ.Widget.HTML.currentWidth=e.w;if(ISQ.Http.browser.isMobile&&ISQ.Widget.mobileHandlingMode==ISQ.Widget.enumMobileHandlingMode.normalWidget){ISQ.Widget.HTML.Mobile.setWidths();return}if(a&&!ISQ.Widget.HTML.resizeTimer){ISQ.Widget.HTML.currentlyResizing=true;ISQ.Widget.HTML.resizeTimer=setInterval(ISQ.Widget.HTML.resizeTimerElapsed,ISQ.Widget.HTML.resizeTimerInterval)}if(!ISQ.Widget.dynamicSize){if(ISQ.Widget.HTML.currentHeight<=ISQ.Widget.HTML.htmlCollapseHeight){ISQ.Widget.HTML.toTeaser()}else{if(ISQ.Widget.HTML.isTeaser){ISQ.Widget.HTML.toNormal()}}}if(ISQ.Http.browser.isMobile){_("minimizeButtonWrapper").style.display="none";ISQ.Widget.setTitle()}var b=e.h;b-=_("widgetTitleWrapper").offsetHeight;b-=ISQ.Widget.HTML.searchWrapper.offsetHeight;if(ISQ.Widget.HTML.isTeaser){b-=_("widgetMinimizedFooter").offsetHeight;b-=_("chatStatusWrapper").offsetHeight}else{b-=ISQ.Widget.HTML.footerWrapper.offsetHeight;
b-=ISQ.Widget.HTML.actionBarWrapper.offsetHeight;if(_("chatStatusWrapper").style.display!=="none"){b-=_("chatStatusWrapper").offsetHeight}b-=ISQ.Widget.HTML.chatInputWrapper.offsetHeight;var d=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.contentWrapper,"margin-top");if(d){b-=parseInt(d)}var c=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.contentWrapper,"margin-bottom");if(c){b-=parseInt(c)}}if(ISQ.Cnf.showLogoInCollapsedMode){if(!ISQ.Cnf.hideBranding&&ISQ.Widget.HTML.currentWidth===ISQ.Cnf.floatCollapsed_WidgetSize[0]&&ISQ.Widget.HTML.currentHeight===ISQ.Cnf.floatCollapsed_WidgetSize[1]){_("logoInCollapsedMode").style.display="block"}else{_("logoInCollapsedMode").style.display="none"}}if(b<0){b=0}ISQ.Widget.HTML.contentWrapper.style.height=b+"px";ISQ.Widget.HTML.Mobile.setWidths(true)};ISQ.Widget.HTML.actionBarIsShown=false;ISQ.Widget.HTML.showActionBar=function(){if(ISQ.Widget.HTML.currentlyResizing||ISQ.Widget.HTML.isTeaser){ISQ.Widget.HTML.pendingShowActionBar=true;return}ISQ.Widget.HTML.pendingShowActionBar=false;ISQ.Widget.HTML.actionBarIsShown=true;if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.actionBarContainer)){if(ISQ.Widget.HTML.actionBarFader===null){ISQ.Widget.HTML.actionBarFader=new VisualEffects.Fade(ISQ.Widget.HTML.actionBarContainer);ISQ.Widget.HTML.actionBarFader.fadeOutEvent.addHandler(ISQ.Widget.HTML.post_hideActionBarFader);ISQ.Widget.HTML.actionBarFader.fadeInEvent.addHandler(ISQ.Widget.HTML.post_showActionBar)}ISQ.Widget.HTML.actionBarFader.setOpacity(0);ISQ.Widget.HTML.actionBarWrapper.style.display="block";ISQ.Widget.HTML.actionBarContainer.style.display="block";ISQ.Widget.HTML.actionBarFader.fadeIn(500,true);ISQ.Widget.HTML.resizeHandler()}else{ISQ.Widget.HTML.actionBarWrapper.style.display="block";ISQ.Widget.HTML.actionBarContainer.style.display="block";ISQ.Widget.HTML.resizeHandler()}};ISQ.Widget.HTML.hide_finishFunction=null;ISQ.Widget.HTML.hideActionBar=function(a,b){ISQ.Widget.Log.add("hide action bar");ISQ.Widget.HTML.actionBarIsShown=false;if(a){ISQ.Widget.HTML.hide_finishFunction=a}if(!b&&ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.actionBarContainer)){if(ISQ.Widget.HTML.actionBarFader===null){return
}ISQ.Widget.HTML.actionBarFader.fadeOut(200)}else{ISQ.Widget.HTML.post_hideActionBarFader()}};ISQ.Widget.HTML.post_hideActionBarFader=function(){ISQ.Widget.HTML.actionBarWrapper.style.display="none";ISQ.Widget.HTML.actionBarContainer.style.display="none";ISQ.Widget.HTML.resizeHandler();if(ISQ.Widget.HTML.hide_finishFunction){ISQ.Widget.HTML.hide_finishFunction();ISQ.Widget.HTML.hide_finishFunction=null}};ISQ.Widget.HTML.post_showActionBar=function(){};ISQ.Widget.HTML.scrollContentToBottom=function(){ISQ.Widget.HTML.contentWrapper.scrollTop=ISQ.Widget.HTML.contentWrapper.scrollHeight-ISQ.Widget.HTML.contentWrapper.offsetHeight};ISQ.Widget.HTML.limitedMode=function(){ISQ.Widget.Log.add("Widget is running in limited mode");ISQ.Widget.HTML.queryField.style.display="none";ISQ.Widget.HTML.queryField.style.visibility="hidden";ISQ.Widget.HTML.queryField.value="Limited mode";ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.email,null,true);ISQ.Widget.HTML.queryField.value=""};ISQ.Widget.HTML.resizePollingHandler=function(){var a=ISQ.Html.screenSize();if(a.h==ISQ.Widget.HTML.currentHeight&&a.w===ISQ.Widget.HTML.currentWidth){return}ISQ.Widget.HTML.Mobile.hideAddressbar();ISQ.Widget.HTML.resizeHandler(a,true)};ISQ.Widget.HTML.timeoutFixContent=0;ISQ.Widget.HTML.fixContentWidths=function(){ISQ.Widget.HTML.timeoutFixContent=0;ISQ.Widget.HTML.fixContentWidths_internal()};ISQ.Widget.HTML.fixContentWidths_internal=function(){if(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6){if(ISQ.Widget.HTML.contentWrapper.scrollHeight>ISQ.Widget.HTML.contentWrapper.offsetHeight){var a,c,b;if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){a=(ISQ.Widget.HTML.contentWrapper.offsetWidth-ISQ.Html.scrollBarWidth())-2;b=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.chatPane,"padding-left");c=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.chatPane,"padding-right")}else{a=(ISQ.Widget.HTML.searchWrapper.offsetWidth-ISQ.Html.scrollBarWidth())-2;b=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.answerPane,"padding-left");c=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.answerPane,"padding-right")
}if(a<=0){if(++ISQ.Widget.HTML.timeoutFixContent<40){setTimeout(ISQ.Widget.HTML.fixContentWidths_internal,50)}return}if(b){a-=parseInt(b)}if(c){a-=parseInt(c)}a+="px";_("answerPane").style.width=a;_("contentArea").style.width=a;if(ISQ.Http.browser.isIE6&&ISQ.Widget.Localize.array.dir==="rtl"){var d=ISQ.Widget.HTML.searchWrapper.offsetWidth;if(d){d=d+"px"}else{d="auto"}setTimeout(function(){ISQ.Widget.HTML.searchWrapper.style.width=d},0)}}else{_("answerPane").style.width="auto";_("contentArea").style.width="100%"}}};ISQ.Widget.HTML.hasContent=function(){if((ISQ.Widget.state&ISQ.Widget.enumState.allEscalations)!==0){return true}if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)!==0&&_query(true,true).length!==0){return true}return false};ISQ.Widget.HTML.minimizeBtnClicked=function(){ISQ.Widget.HTML.Mobile.ignoreClickEvent=true;var a=ISQ.Widget.HTML.hasContent();ISQ.Widget.HTML.ignoreNextClickEvent=true;ISQ.Widget.CDC.sendMessage("subject=minimize&openExpand="+a,true);if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.clearTextboxOnInteraction=true;ISQ.Widget.AutoQuestions.stop_()}};ISQ.Widget.HTML.toTeaser=function(){ISQ.Widget.HTML.isTeaser=true;ISQ.Widget.HTML.contentWrapper.className="empty";ISQ.Widget.HTML.footerWrapper.style.display="none";_("widgetMinimizedFooter").style.display="block";if(ISQ.Widget.isFloat){_("minimizeButtonWrapper").style.display="none"}ISQ.Widget.HTML.actionBarWrapper.style.display="none";if(ISQ.Widget.state===ISQ.Widget.enumState.chat){if(!ISQ.Widget.HTML.chatStatus.originalText){ISQ.Widget.HTML.chatStatus.originalText=ISQ.Widget.HTML.chatStatus.innerHTML;ISQ.Data.autoEllipseText(ISQ.Widget.HTML.chatStatus.innerHTML,ISQ.Widget.HTML.chatStatus.offsetWidth,ISQ.Widget.HTML.chatStatus)}_("closeChat").style.display="none";_("chatPane").style.display="none";ISQ.Widget.HTML.chatInputWrapper.style.display="none";_("chatStatusContainer").className="chatStatusContainerMinimized"}else{if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){_("contactForm").style.display="none"
}else{_("answerPane").style.display="none"}}ISQ.Widget.setTitle()};ISQ.Widget.HTML.toNormal=function(){ISQ.Widget.HTML.isTeaser=false;ISQ.Widget.HTML.contentWrapper.className="";_("widgetMinimizedFooter").style.display="none";if(ISQ.Widget.isFloat){_("minimizeButtonWrapper").style.display="inline"}if(ISQ.Widget.HTML.hasContent()&&ISQ.Widget.Query.numberOfTopics!==0&&(ISQ.Widget.state&ISQ.Widget.enumState.nonChatEscalations)===0){ISQ.Widget.HTML.actionBarWrapper.style.display="block"}if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)!==0){_("answerPane").style.display="block"}if(ISQ.Widget.state===ISQ.Widget.enumState.chat){ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.HTML.chatStatus.originalText;ISQ.Widget.HTML.chatStatus.originalText=null;_("chatPane").style.display="block";_("closeChat").style.display="block";ISQ.Widget.HTML.chatInputWrapper.style.display="block";_("chatStatusContainer").className=""}else{if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){_("contactForm").style.display="block"}}if(ISQ.Widget.state!==ISQ.Widget.enumState.contactForm||ISQ.Cnf.showFooterWithContactForm!==false){ISQ.Widget.HTML.footerWrapper.style.display="block"}ISQ.Widget.setTitle()};ISQ.Widget.HTML.canPerformFade=function(b){if(typeof(b.isFadeAvailable)==="bool"){return b.isFadeAvailable}if(ISQ.Http.browser.app!=="ie"){b.isFadeAvailable=true;return b.isFadeAvailable}var a=ISQ.CSS.getElementStyle(b,"background-color");if(!a||a.toLowerCase()=="transparent"){b.isFadeAvailable=false}else{b.isFadeAvailable=true}return b.isFadeAvailable};ISQ.Widget.HTML.resizeTimerElapsed=function(){if(!ISQ.Widget.HTML.lastWindowSize){ISQ.Widget.HTML.lastWindowSize={};ISQ.Widget.HTML.resizeStarted()}if(ISQ.Widget.HTML.currentHeight==ISQ.Widget.HTML.lastWindowSize.h&&ISQ.Widget.HTML.currentWidth==ISQ.Widget.HTML.lastWindowSize.w){clearInterval(ISQ.Widget.HTML.resizeTimer);ISQ.Widget.HTML.resizeTimer=null;ISQ.Widget.HTML.lastWindowSize=null;ISQ.Widget.HTML.currentlyResizing=false;ISQ.Widget.HTML.resizeStopped();return}ISQ.Widget.HTML.lastWindowSize.h=ISQ.Widget.HTML.currentHeight;
ISQ.Widget.HTML.lastWindowSize.w=ISQ.Widget.HTML.currentWidth};ISQ.Widget.HTML.resizeStarted=function(){if(!ISQ.Widget.dynamicSize&&!ISQ.Http.browser.isMobile){ISQ.Widget.HTML.actionBarWrapper.style.display="none";ISQ.Widget.HTML.actionBarContainer.style.display="none"}};ISQ.Widget.HTML.resizeStopped=function(){if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){ISQ.Widget.HTML.disablePIE();ISQ.Widget.HTML.enablePIE()}if(ISQ.Widget.dynamicSize&&ISQ.Http.browser.app=="ff"&&ISQ.Http.browser.version.indexOf("3.")===0){document.body.scrollTop=0}if(ISQ.Widget.HTML.isTeaser){return}if(ISQ.Widget.HTML.pendingShowActionBar){if(ISQ.Widget.state==ISQ.Widget.enumState.questions){ISQ.Widget.Query.showActionBar()}else{if(ISQ.Widget.state==ISQ.Widget.enumState.chat){ISQ.Widget.HTML.showActionBar();if(ISQ.Widget.Chat.resumingChat){ISQ.Widget.HTML.scrollContentToBottom()}}else{if(ISQ.Widget.state==ISQ.Widget.enumState.chatSurvey){ISQ.Widget.HTML.showActionBar()}}}}else{if(ISQ.Widget.HTML.actionBarIsShown&&!ISQ.Http.browser.isMobile){if(!ISQ.Widget.dynamicSize){ISQ.Widget.HTML.showActionBar();ISQ.Widget.HTML.resizeHandler()}}else{if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm&&(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6)&&_("clientFormTabDivs")){_("clientFormTabDivs",true).style.display="none";_("clientFormTabDivs").style.display="block"}}}if(_("customerLogo").pendingResize){ISQ.Widget.onCustomerLogoLoad()}if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)!==0){ISQ.Widget.Query.resizeAnswerElements()}ISQ.Widget.HTML.Mobile.setWidths()};ISQ.Widget.HTML.dynamicSize_sendMessageTimer=null;ISQ.Widget.HTML.dynamicSize_sendMessage=function(b){if(!ISQ.Widget.dynamicSize){return}if(ISQ.Widget.HTML.dynamicSize_sendMessageTimer){clearTimeout(ISQ.Widget.HTML.dynamicSize_sendMessageTimer)}var a=function(){var f=ISQ.Widget.HTML.contentWrapper;f.style.overflowY="hidden";var d=0;if(ISQ.Http.browser.app==="chrome"||ISQ.Http.browser.app==="safari"||ISQ.Http.browser.isMobile){d+=_("widgetContainer").scrollHeight}else{var e=ISQ.Html.pageSize(false,true);
d+=e.h}if(ISQ.Widget.state===ISQ.Widget.enumState.chat){var c=250;if(ISQ.Cnf.chatHeight_dynamicSizeMode){c=ISQ.Cnf.chatHeight_dynamicSizeMode}d+=c-f.offsetHeight}else{d+=_("contentArea").scrollHeight-f.offsetHeight}if(ISQ.Widget.dynamicMaxSize&&d>ISQ.Widget.dynamicMaxSize){f.style.overflowY="auto";d=ISQ.Widget.dynamicMaxSize}else{if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){f.style.overflowY="auto"}}ISQ.Widget.CDC.sendMessage("subject=setSize&height="+d)};if(b===true){a()}else{ISQ.Widget.HTML.dynamicSize_sendMessageTimer=setTimeout(function(){a()},0)}};ISQ.Widget.HTML.currentHeight=0;ISQ.Widget.HTML.currentWidth=0;ISQ.Widget.HTML.isTeaser=false;ISQ.Widget.HTML.htmlCollapseHeight=85;ISQ.Widget.HTML.searchAnim=null;ISQ.Widget.HTML.actionBarFader=null;ISQ.Widget.HTML.ignoreNextClickEvent=false;ISQ.Widget.HTML.currentlyResizing=false;ISQ.Widget.HTML.resizeTimerInterval=100;ISQ.Widget.HTML.resizeTimer=null;ISQ.Widget.HTML.lastWindowSize=null;ISQ.Widget.HTML.pendingShowActionBar=false;ISQ.Widget.HTML.dynamicRTLCssLoaded=true;ISQ.Widget.AutoQuestions=initializeNS("ISQ.Widget.AutoQuestions");ISQ.Widget.AutoQuestions.array=null;ISQ.Widget.AutoQuestions.interval=10000;ISQ.Widget.AutoQuestions.currentIndex=-1;ISQ.Widget.AutoQuestions.timeout=null;ISQ.Widget.AutoQuestions.repeatMode=true;ISQ.Widget.AutoQuestions.init=function(e,b,f){if(!e){return false}ISQ.Widget.AutoQuestions.array=new Array();var d=e.split(";");var c=d.length;for(var a=0;a<c;++a){if(d[a].Trim()!=""){ISQ.Widget.AutoQuestions.array.push(d[a])}}ISQ.Widget.AutoQuestions.interval=!isNaN(b)?parseInt(b):ISQ.Widget.AutoQuestions.interval;ISQ.Widget.AutoQuestions.repeatMode=f===true&&ISQ.Widget.AutoQuestions.array.length>1;ISQ.Widget.Log.add("Initiated "+ISQ.Widget.AutoQuestions.array.length+" auto questions with "+ISQ.Widget.AutoQuestions.interval+" interval between them");ISQ.Widget.state=ISQ.Widget.enumState.autoQuestions;return true};ISQ.Widget.AutoQuestions.showNext=function(){ISQ.Widget.AutoQuestions.timeout=setTimeout(ISQ.Widget.AutoQuestions.go,ISQ.Widget.AutoQuestions.interval)
};ISQ.Widget.AutoQuestions.go=function(){if(ISQ.Widget.AutoQuestions.array===null||ISQ.Widget.AutoQuestions.array.length<1){return}var a=ISQ.Widget.AutoQuestions.array.length;var b=ISQ.Widget.AutoQuestions.currentIndex+1;if(b===a){if(!ISQ.Widget.AutoQuestions.repeatMode){return}b=0}var c=ISQ.Widget.AutoQuestions.array[b];ISQ.Widget.AutoQuestions.currentIndex=b;ISQ.Widget.Query.ask(c);if(ISQ.Cnf.initialText===""){ISQ.Widget.HTML.queryField.blur()}};ISQ.Widget.AutoQuestions.stop_=function(){ISQ.Widget.state=ISQ.Widget.enumState.questions;clearTimeout(ISQ.Widget.AutoQuestions.timeout);if(ISQ.Widget.Query.typeTimer!==null){ISQ.Widget.Query.typeTimer.cancel();ISQ.Widget.Query.typeTimer.dispose();ISQ.Widget.Query.typeTimer=null}ISQ.Widget.Query.lastQuerySent=""};ISQ.Widget.AutoQuestions.getCurrentQuestion=function(){return ISQ.Widget.AutoQuestions.array[ISQ.Widget.AutoQuestions.currentIndex]};ISQ.Widget.Protocol={};ISQ.Widget.Protocol.serverPath="/KB";ISQ.Widget.Protocol.client=null;ISQ.Widget.Protocol.isEstablished=false;var _session=function(){return ISQ.Widget.Protocol.client};ISQ.Widget.Protocol.init=function(){try{ISQ.Widget.Log.add("Creating Protocol Client");var a=true;if(ISQ.Widget.isPreview){a=false}ISQ.Widget.Protocol.client=new ISQ.Protocol.WidgetClient({server:"/KB",ttl:10000,connections:1,referer:ISQ.Widget.referer.normal,account:ISQ.Widget.account,enableStats:a,pageId:ISQ.Http.hashArguments.pageid,requestedKb:ISQ.Http.urlArguments.kb,doctype:ISQ.Http.hashArguments.doctype});ISQ.Widget.Protocol.client.connectionStateChangeEvent.addHandler(this.onConnectionStateChange)}catch(b){var c=b.message||b;ISQ.Widget.Log.add("Exception in protocol.init(): "+c);return false}return true};ISQ.Widget.Protocol.onConnectionStateChange=function(a,b){var c;switch(a){case ISQ.Protocol.connectionStateEnum.DISCONNECTED:ISQ.Widget.Log.add("connectionState has changed: Disconnected");break;case ISQ.Protocol.connectionStateEnum.CONNECTED:ISQ.Widget.Log.add("connectionState has changed: Connected to account "+ISQ.Widget.account);if(ISQ.Http.browser.app==="opera"&&ISQ.Widget.Chat.chatStarted){ISQ.Widget.Chat.saveCookie()
}break;case ISQ.Protocol.connectionStateEnum.CONNECTING:ISQ.Widget.Log.add("connectionState has changed: Connecting");break;case ISQ.Protocol.connectionStateEnum.RECONNECTING:ISQ.Widget.Log.add("connectionState has changed: Re-Connecting");break;case ISQ.Protocol.connectionStateEnum.LOGIN_FAILD:ISQ.Widget.Log.add("connectionState has changed: Login has failed",ISQ.Widget.Log.statusEnum.RED);break;case ISQ.Protocol.connectionStateEnum.CONNECTION_LOST:ISQ.Widget.Log.add("connectionState has changed: connection lost",ISQ.Widget.Log.statusEnum.GREEN);break}};ISQ.Widget.Query={};ISQ.Widget.Query.isSameQuery=false;ISQ.Widget.Query.lastQuerySent="";ISQ.Widget.Query.lastQuerySent_time=null;ISQ.Widget.Query.pendingRequest=false;ISQ.Widget.Query.timer=null;ISQ.Widget.Query.activeRequestId=-1;ISQ.Widget.Query.ignoreKeyCodes=new Array();ISQ.Widget.Query.kbLanguageCode="";ISQ.Widget.Query.numberOfTopics=0;ISQ.Widget.Query.previousAnswers=null;ISQ.Widget.Query.firstAnswerId=-1;ISQ.Widget.Query.chatEscalationAction=null;ISQ.Widget.Query.chatInviteContent=null;ISQ.Widget.Query.chatPushed=false;ISQ.Widget.Query.fader=null;ISQ.Widget.Query.cachedAnswerTranslationDelimiter=":";ISQ.Widget.Query.previousDetectedLanguage=null;ISQ.Widget.Query.previousResponseWasAutoQuestion=false;ISQ.Widget.Query.queryTranslator=null;ISQ.Widget.Query.answerTranslator=null;ISQ.Widget.Query.queryChangedEvent=null;ISQ.Widget.Query.typeTimer=null;ISQ.Widget.Query.typeInterval=50;ISQ.Widget.Query.questionsTrail=null;ISQ.Widget.Query.tempQuestionTrailId=null;ISQ.Widget.Query.gettingAnswerById=false;ISQ.Widget.Query.setFocusByScript=false;ISQ.Widget.Query.firstUserTyping=true;ISQ.Widget.Query.clearTextboxOnInteraction=false;ISQ.Widget.Query.searchDelay_min=250;ISQ.Widget.Query.searchDelay_max=2500;ISQ.Widget.Query.searchDelay_history=new ISQ.Infra.LinkedList();ISQ.Widget.Query.elementsToResize=null;ISQ.Widget.Query.resizeableTags=["IMG","OBJECT","EMBED","IFRAME"];ISQ.Widget.Query.lastQueryTranslation=null;ISQ.Widget.Query.answerPaneWidth=0;ISQ.Widget.Query.mobile_previousValue=null;
ISQ.Widget.Query.mobile_ignoreNextChange=false;ISQ.Widget.Query.userActiveReported=false;ISQ.Widget.Query.lastAutoQuestionRequestId=-1;ISQ.Widget.Query.contextCategories=null;var _query=function(b,a){var c=ISQ.Widget.HTML.queryField.value;if(!ISQ.Widget.userActive&&!a){return""}if(b===true){c=c.Trim()}return c};ISQ.Widget.Query.init=function(){ISQ.Widget.Query.ignoreKeyCodes[13]=true;ISQ.Widget.Query.ignoreKeyCodes[16]=true;ISQ.Widget.Query.ignoreKeyCodes[17]=true;ISQ.Widget.Query.ignoreKeyCodes[18]=true;ISQ.Widget.Query.ignoreKeyCodes[20]=true;ISQ.Widget.Query.ignoreKeyCodes[37]=true;ISQ.Widget.Query.ignoreKeyCodes[38]=true;ISQ.Widget.Query.ignoreKeyCodes[39]=true;ISQ.Widget.Query.ignoreKeyCodes[40]=true;ISQ.Widget.Query.ignoreKeyCodes[91]=true;ISQ.Widget.Query.ignoreKeyCodes[92]=true;ISQ.Widget.HTML.searchAnim=new ISQ.GUI.ProgressAnimation({container:createDiv(ISQ.Widget.HTML.searchContainer,".searchAnim")});ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.Query.queryChangedEvent=new ISQ.Event();var a=ISQ.Http.hashArguments.searchdelay||ISQ.Http.urlArguments.searchdelay;if(a){a=parseInt(a)}if(!isNaN(a)){ISQ.Widget.Query.searchDelay_min=a}if((ISQ.Http.browser.isMobile&&ISQ.Widget.mobileHandlingMode===ISQ.Widget.enumMobileHandlingMode.normalWidget)||ISQ.Http.browser.isTablet){ISQ.Widget.Query.mobile_previousValue=ISQ.Cnf.initialText||null;setInterval(ISQ.Widget.Query.queryInterval_mobile,100);ISQ.Widget.HTML.queryField.onkeyup=null}};ISQ.Widget.Query.queryInterval_mobile=function(){if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){return}var b=_query(false,true);if(b===ISQ.Widget.Query.mobile_previousValue){return}ISQ.Widget.Query.mobile_previousValue=b;if(ISQ.Widget.Query.mobile_ignoreNextChange){ISQ.Widget.Query.mobile_ignoreNextChange=false;return}ISQ.Widget.userActive=true;var a={keyCode:b.charCodeAt(b.length-1)};ISQ.Widget.Query.keyUpHandler(a)};ISQ.Widget.Query.onFocusHandler=function(a){if(ISQ.Http.browser.isMobile){if(ISQ.Widget.mobileHandlingMode===ISQ.Widget.enumMobileHandlingMode.inactive){ISQ.Widget.HTML.queryField.blur()
}else{if(ISQ.Http.browser.isAndroid&&(ISQ.Widget.Query.gettingAnswerById||!ISQ.Widget.userActive)){ISQ.Widget.Query.clearTextboxOnInteraction=true;ISQ.Widget.Query.userInteractionHandler(a)}ISQ.Widget.HTML.Mobile.hideAddressbar(20)}return}if(!ISQ.Widget.sendingCDCMessages){ISQ.Widget.HTML.queryField.onfocus=null;return false}else{if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=textfieldFocus")}}};ISQ.Widget.Query.onBlurHandler=function(){if(!ISQ.Widget.sendingCDCMessages){ISQ.Widget.HTML.queryField.onblur=null;return false}if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=blur")}};ISQ.Widget.Query.setFocus=function(){if(ISQ.Widget.isPreview||ISQ.Cnf.autoGrabFocusInEmbed===false||ISQ.Widget.isFloat||ISQ.Http.browser.isMobile){return}ISQ.Widget.Query.setFocusByScript=true;try{ISQ.Widget.HTML.queryField.focus();ISQ.Widget.Log.add("Focus:  was added to query field")}catch(a){setTimeout(function(){try{ISQ.Widget.HTML.queryField.focus();ISQ.Widget.Log.add("Focus: was added to query field with timeout")}catch(b){}},0)}};ISQ.Widget.Query.onclickHandler=function(b,a){if(ISQ.Http.browser.isAndroid){return}ISQ.Widget.Query.userInteractionHandler(b,a)};ISQ.Widget.Query.userInteractionHandler=function(b,a){if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||ISQ.Cnf.initialText||ISQ.Widget.Query.clearTextboxOnInteraction){if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.stop_()}if((a&&!ISQ.Widget.userActive)||ISQ.Widget.Query.clearTextboxOnInteraction){ISQ.Widget.HTML.queryField.value="";ISQ.Widget.HTML.queryField.className=ISQ.Widget.HTML.queryField.className.replace("initialText","");ISQ.Widget.Query.mobile_ignoreNextChange=true}ISQ.Widget.Query.clearTextboxOnInteraction=false}return false};ISQ.Widget.Query.keyPressHandler=function(b){var a=b||window.event;if(a.keyCode===13){return false}ISQ.Widget.userActive=true};ISQ.Widget.Query.keyDownHandler=function(a){ISQ.Widget.Query.userInteractionHandler(a,true);ISQ.Widget.userActive=true;ISQ.Widget.HTML.queryField.onkeydown=null
};ISQ.Widget.Query.pasteHandler=function(a){ISQ.Widget.Query.userInteractionHandler(a,true);ISQ.Widget.userActive=true;setTimeout(function(){ISQ.Widget.Query.keyUpHandler(a)},0)};ISQ.Widget.Query.keyUpHandler=function(b){var a=b||window.event;if(!ISQ.Widget.userActive){return}if(typeof(a.keyCode)!="unknown"&&ISQ.Widget.Query.ignoreKeyCodes[a.keyCode]){return false}if(ISQ.Cnf.limited&&ISQ.Widget.state!==ISQ.Widget.enumState.contactForm){return false}if(ISQ.Widget.state===ISQ.Widget.enumState.customLink){ISQ.Widget.state=ISQ.Widget.enumState.questions}ISQ.Widget.Query.clearQuestionTrail();ISQ.Widget.Query.searchDelay_history.addLast(new Date());if(ISQ.Widget.Query.searchDelay_history.count()===6){ISQ.Widget.Query.searchDelay_history.remove(ISQ.Widget.Query.searchDelay_history.head())}ISQ.Widget.Query.analyzeQuery(_query(false));return false};ISQ.Widget.Query.ask=function(d,a,b){var c=(!ISQ.Cnf.initialText||ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions);if(ISQ.Cnf.autoQuestionsTypeEffect&&c&&!b){ISQ.Widget.Query.analyzeQuery(d,a,b);ISQ.Widget.Query.typeTimer=new ISQ.Timer(new ISQ.Handler(ISQ.Widget.Query.typeQuestion),false,d,0);ISQ.Widget.Query.typeTimer.start(ISQ.Widget.Query.typeInterval)}else{if(c){ISQ.Widget.HTML.queryField.value=d}ISQ.Widget.Query.analyzeQuery(d,a,b)}};ISQ.Widget.Query.questionLinkClicked=function(a){ISQ.Widget.Query.appendQuestionToTrail();ISQ.Widget.Query.tempQuestionTrailId=a;ISQ.Widget.Query.getAnswerById(a)};ISQ.Widget.Query.clearQuestionTrail=function(){if(ISQ.Widget.Query.questionsTrail){ISQ.Widget.Query.questionsTrail.dispose();ISQ.Widget.Query.questionsTrail=null}ISQ.Widget.Query.tempQuestionTrailId=null};ISQ.Widget.Query.appendQuestionTag=function(b,a,c){b.push("<a href='javascript:void(0)' onclick='ISQ.Widget.Query.questionLinkClicked(\"");b.push(a);b.push("\")'>");b.push(c);b.push("</a>")};ISQ.Widget.Query.appendQuestionToTrail=function(){if(!ISQ.Widget.Query.questionsTrail){ISQ.Widget.Query.questionsTrail=new ISQ.Infra.Stack()}if(!ISQ.Widget.Query.tempQuestionTrailId){var a=ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions?ISQ.Widget.AutoQuestions.getCurrentQuestion():_query(true,true);
ISQ.Widget.Query.questionsTrail.push({tag:a,isTagAnId:false})}else{ISQ.Widget.Query.questionsTrail.push({tag:ISQ.Widget.Query.tempQuestionTrailId,isTagAnId:true})}ISQ.Widget.Query.tempQuestionTrailId=null};ISQ.Widget.Query.popQuestionFromTrail=function(){if(!ISQ.Widget.Query.questionsTrail){return null}return ISQ.Widget.Query.questionsTrail.pop()};ISQ.Widget.Query.getCurrentQuestionFromTrail=function(){if(!ISQ.Widget.Query.questionsTrail){return null}return ISQ.Widget.Query.questionsTrail.peek()};ISQ.Widget.Query.typeQuestion=function(b,a){if(a===b.length){ISQ.Widget.Query.typeTimer.dispose();return}ISQ.Widget.HTML.queryField.value=b.substr(0,a+1);ISQ.Widget.Query.typeTimer.start(ISQ.Widget.Query.typeInterval,b,a+1)};ISQ.Widget.Query.analyzeQuery=function(g,a,b){g=g.replace(/\n/g," ");var l=g.Trim();ISQ.Widget.Query.gettingAnswerById=false;if(ISQ.Widget.state===ISQ.Widget.enumState.questions){if(l.length===0){if(ISQ.Widget.Query.timer!==null){clearTimeout(ISQ.Widget.Query.timer)}ISQ.Widget.Query.lastQuerySent="";ISQ.Widget.Query.hideAnswers(null,!ISQ.Widget.dynamicSize);ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.HTML.hideActionBar();ISQ.Widget.Query.firstUserTyping=true;ISQ.Widget.Query.previousAnswers=null;return}a=ISQ.Widget.Query.previousResponseWasAutoQuestion;if(!a&&g===ISQ.Widget.Query.lastQuerySent){if(!ISQ.Widget.Query.pendingRequest){if(ISQ.Widget.Query.timer!==null){clearTimeout(ISQ.Widget.Query.timer)}ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.Query.firstUserTyping=true}return}if(ISQ.Widget.Query.timer!==null){clearTimeout(ISQ.Widget.Query.timer)}ISQ.Widget.HTML.searchAnim.show()}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.send(l)}else{if(ISQ.Widget.Query.firstUserTyping&&ISQ.Widget.state===ISQ.Widget.enumState.questions){if(ISQ.Widget.reportEvents){if(!ISQ.Widget.Query.userActiveReported){ISQ.Widget.CDC.sendMessage("subject=event&type=useractive");ISQ.Widget.Query.userActiveReported=true}ISQ.Widget.CDC.sendMessage("subject=event&type=userstartedtyping")}if(ISQ.Widget.isFloat){ISQ.Widget.CDC.sendMessage("subject=userWrites")
}ISQ.Widget.Query.firstUserTyping=false}var e=new Date().getTime();if(b||(ISQ.Widget.Query.isSameQuery&&e-ISQ.Widget.lastQueryKeyTime>ISQ.Widget.updateQueryDiff_ms)){ISQ.Widget.Query.isSameQuery=false}ISQ.Widget.lastQueryKeyTime=new Date().getTime();var h;if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){h=0}else{if(ISQ.Widget.Query.searchDelay_history.count()>2){var k=0;var f=ISQ.Widget.Query.searchDelay_history.head();var d=f.next();while(d){var c=(d.data()-f.data());if(c<ISQ.Widget.Query.searchDelay_min){c=ISQ.Widget.Query.searchDelay_min}else{if(c>ISQ.Widget.Query.searchDelay_max){c=ISQ.Widget.Query.searchDelay_max}}k+=c;f=d;d=d.next()}h=k/ISQ.Widget.Query.searchDelay_history.count()*2}else{h=ISQ.Widget.Query.searchDelay_min*2}}var j=function(){ISQ.Widget.Query.firstUserTyping=true;ISQ.Widget.Query.timerElapsedHandler(l,a);ISQ.Widget.Query.timer=null};var i=0;if(ISQ.Widget.Query.lastQuerySent_time){i=e-ISQ.Widget.Query.lastQuerySent_time}else{if(ISQ.Widget.Query.searchDelay_history.count()!==0){i=e-ISQ.Widget.Query.searchDelay_history.tail().data()}}if(i>=5000){j()}else{ISQ.Widget.Query.timer=setTimeout(j,h)}}};ISQ.Widget.Query.countWords=function(c){var a=0;while(c.charAt(a)===" "&&a<c.length){++a}if(a===c.length){return 0}var b=false;var d=1;for(;a<c.length;++a){if(c.charAt(a)!==" "){b=false;continue}else{if(b){continue}b=true;++d}}return d};ISQ.Widget.Query.timerElapsedHandler=function(b,a){ISQ.Widget.Query.queryChangedEvent.dispatch(b);if((!a&&b===ISQ.Widget.Query.lastQuerySent)||b.length===0){ISQ.Widget.HTML.searchAnim.hide();return}if(ISQ.Widget.Query.firstAnswerId==-1){ISQ.Widget.Query.hideAnswers(null,true)}if(ISQ.Cnf.limited){return}if(ISQ.Widget.state===ISQ.Widget.enumState.questions){ISQ.Widget.Query.send(b)}else{ISQ.Widget.HTML.searchAnim.hide()}};ISQ.Widget.Query.send=function(a,b){if(ISQ.Cnf.limited){return}if(!b){if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=query&isAutoQuestion="+(ISQ.Widget.state==ISQ.Widget.enumState.autoQuestions)+"&data="+ISQ.Tools.Base64.encodeString(a))
}if(a===""){ISQ.Widget.Log.add("empty query");return}ISQ.Widget.Log.add("Is same query: "+ISQ.Widget.Query.isSameQuery)}ISQ.Widget.Query.lastQuerySent=a;ISQ.Widget.Query.lastQuerySent_time=new Date();++ISQ.Widget.Query.activeRequestId;if(ISQ.Widget.state==ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.lastAutoQuestionRequestId=ISQ.Widget.Query.activeRequestId}if(ISQ.Cnf.translationEnabled&&ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.queryTranslator=new ISQ.Widget.TranslationHelper.QueryTranslator({query:ISQ.Widget.Query.lastQuerySent,handler:new ISQ.Handler(ISQ.Widget.Query.send_internal),queryId:ISQ.Widget.Query.activeRequestId})}else{ISQ.Widget.Query.send_internal(ISQ.Widget.Query.lastQuerySent,ISQ.Widget.Query.activeRequestId)}ISQ.Widget.Query.pendingRequest=true};ISQ.Widget.Query.send_internal=function(c,b,d,a){if(b!=ISQ.Widget.Query.activeRequestId){return}a=ISQ.Tools.getUniformLanguageCode(a);ISQ.Widget.setUiLanguage(a||ISQ.Cnf.kbLanguageCode);ISQ.Widget.Query.lastQueryTranslation=d;ISQ.Widget.setTitle();if(d&&ISQ.Widget.state===ISQ.Widget.enumState.questions){ISQ.Widget.HTML.searchAnim.show("searchAnim searchAnimTranslating")}_session().sendQuestion(ISQ.Widget.Query.responseHandler,c,b,ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions,ISQ.Widget.Query.isSameQuery,d,a);ISQ.Widget.Query.isSameQuery=true;ISQ.Widget.Query.elementsToResize=null};ISQ.Widget.Query.getAnswerById=function(a){var b=false;if(ISQ.Widget.Query.firstAnswerId==-1){b=true;ISQ.Widget.Query.hideAnswers(null,true)}++ISQ.Widget.Query.activeRequestId;if(!b){ISQ.Widget.Query.hideAnswers(null,true)}ISQ.Widget.Query.lastQuerySent="";ISQ.Widget.HTML.queryField.value="";ISQ.Widget.Query.mobile_ignoreNextChange=true;ISQ.Widget.HTML.searchAnim.show();ISQ.Widget.Query.gettingAnswerById=true;ISQ.Widget.Query.pendingRequest=true;_session().getAnswerById(ISQ.Widget.Query.responseHandler,a,ISQ.Widget.Query.activeRequestId,ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions)};ISQ.Widget.Query.responseHandler=function(response){ISQ.Widget.Log.add("Query response received. parsing answers");
var results=null;var similiarAnswers=false;var isAutoQuestion=false;var xml=response.xml;if(xml===null){ISQ.Widget.Log.add("Query: Illegal xml");ISQ.Widget.HTML.searchAnim.hide();_session().sendServerLog(ISQ.Protocol.ServerLog.eLevelEnum.DEBUG,"parseAnswers: illegal XML")}else{if(xml.childNodes.length==0){ISQ.Widget.Log.add("Query: Answer XML - empty");ISQ.Widget.HTML.searchAnim.hide();_session().sendServerLog(ISQ.Protocol.ServerLog.eLevelEnum.DEBUG,"parseAnswers: XML is empty")}else{if(xml.childNodes[0].nodeName==="parsererror"||(xml.childNodes.length>1&&xml.childNodes[1].nodeName==="parsererror")){ISQ.Widget.Log.add("Query: Illegal xml");ISQ.Widget.HTML.searchAnim.hide();_session().sendServerLog(ISQ.Protocol.ServerLog.eLevelEnum.DEBUG,"parseAnswers: error parsing XML")}else{var contextCategories=ISQ.Data.Xml.getFirstElementByName(xml,"contextCategories");if(contextCategories){try{var jsonData=eval("("+(contextCategories.firstChild.nodeValue)+")");ISQ.Widget.Query.contextCategories=[];for(var i=0;i<jsonData.values.length;++i){ISQ.Widget.Query.contextCategories[jsonData.values[i].id]=jsonData.values[i]}}catch(e){ISQ.Widget.Query.contextCategories=null}}var resultsNode=xml.getElementsByTagName("Results")[0];if(ISQ.Widget.Query.activeRequestId!=resultsNode.getAttribute("requestId")){ISQ.Widget.Log.add("Query: Request Id doesn't match. sent: "+ISQ.Widget.Query.activeRequestId+", received: "+resultsNode.getAttribute("requestId"));return}else{if(resultsNode.getAttribute("detectLanguage")==="true"){ISQ.Widget.Query.send(ISQ.Widget.Query.lastQuerySent,true);return}ISQ.Widget.Query.kbLanguageCode=resultsNode.getAttribute("kbLanguageCode");var differentLanguage=ISQ.Widget.Query.previousDetectedLanguage&&ISQ.Widget.Query.previousDetectedLanguage!==ISQ.Widget.TranslationHelper.detectedLanguage;ISQ.Widget.Query.previousDetectedLanguage=ISQ.Widget.TranslationHelper.detectedLanguage;var topicsArr=resultsNode.getElementsByTagName("Topic");ISQ.Widget.Query.numberOfTopics=topicsArr.length;results=new Array();for(var i=0;i<ISQ.Widget.Query.numberOfTopics;
++i){results.push(ISQ.Widget.Query.getResultObject(topicsArr[i]))}if(!ISQ.Widget.Query.previousResponseWasAutoQuestion&&!differentLanguage&&ISQ.Widget.Query.previousAnswers&&results.length===ISQ.Widget.Query.previousAnswers.length){var i=0;for(i=0;i<ISQ.Widget.Query.previousAnswers.length;++i){if(!ISQ.Widget.Query.compareResults(ISQ.Widget.Query.previousAnswers[i],results[i])){break}}similiarAnswers=i===ISQ.Widget.Query.previousAnswers.length}ISQ.Widget.Query.previousResponseWasAutoQuestion=ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions||ISQ.Widget.Query.gettingAnswerById;isAutoQuestion=resultsNode.getAttribute("requestId")<=ISQ.Widget.Query.lastAutoQuestionRequestId}}}}if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=incomingsearchresults&hasresults="+(results.length!==0)+"&isAutoQuestion="+isAutoQuestion)}if(!similiarAnswers){ISQ.Widget.Query.hideAnswers(results,true)}else{ISQ.Widget.HTML.searchAnim.hide()}ISQ.Widget.Query.pendingRequest=false};ISQ.Widget.Query.processAnswers=function(n){if(!n||((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0)){ISQ.Widget.HTML.searchAnim.hide();return}if(ISQ.Widget.HTML.queryField.value===""&&ISQ.Widget.state===ISQ.Widget.enumState.questions&&!ISQ.Widget.Query.gettingAnswerById){ISQ.Widget.HTML.searchAnim.hide();return}try{var r=null;ISQ.Widget.Query.firstAnswerId=-1;ISQ.Widget.Query.chatEscalationAction=ISQ.Widget.Query.numberOfTopics==0?ISQ.Widget.enumChatEscalationActions.normal:ISQ.Widget.enumChatEscalationActions.hide;ISQ.Widget.Query.chatPushed=false;ISQ.Widget.Query.previousAnswers=null;if(ISQ.Widget.Query.numberOfTopics>0){ISQ.Widget.Query.previousAnswers=new Array();var m;for(var k=0;k<ISQ.Widget.Query.numberOfTopics;k++){m=n[k];ISQ.Widget.Query.previousAnswers.push(m);if(k===0){ISQ.Widget.Query.firstAnswerId=m.id;if(ISQ.Widget.Query.gettingAnswerById){ISQ.Widget.Query.mobile_ignoreNextChange=true;ISQ.Widget.Query.lastQuerySent=m.title;if(!ISQ.Widget.userActive&&ISQ.Cnf.initialText){ISQ.Widget.HTML.queryField.value=ISQ.Cnf.initialText
}else{ISQ.Widget.HTML.queryField.value=m.title}}}ISQ.Widget.Query.chatEscalationAction=Math.max(ISQ.Widget.Query.chatEscalationAction,m.chatEscalationAction);if(!ISQ.Widget.Query.chatInviteContent){ISQ.Widget.Query.chatInviteContent=m.chatInviteContent}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions&&ISQ.Widget.Query.chatEscalationAction==ISQ.Widget.enumChatEscalationActions.pushChat){ISQ.Widget.Query.chatEscalationAction=ISQ.Widget.enumChatEscalationActions.normal}if(typeof(lpChatConfig)!=="undefined"){if(m.chatRequiredSkill){lpChatConfig.skill=m.chatRequiredSkill}else{if(ISQ.Cnf.chatAgentSkill){lpChatConfig.skill=ISQ.Cnf.chatAgentSkill}}}if(ISQ.Widget.Query.toTranslateContent(ISQ.Widget.Query.kbLanguageCode)){if(m.answerTranslation){var b=m.answerTranslation.split(ISQ.Widget.Query.cachedAnswerTranslationDelimiter);var q=ISQ.Tools.Base64.decodeString(b[0]);var p=ISQ.Tools.Base64.decodeString(b[1]);var a=new ISQ.Widget.TranslationHelper.Answer({id:m.id,title:m.title,summary:m.summary,extraInfo:{externalSourceType:m.externalSourceType,externalSourceId:m.externalSourceId,attachments:m.attachments},isCachedTranslation:true,translatedTitle:q,translatedSummary:p,provider:m.translationProvider,context:m.context});if(!r){r=new Array()}r.push(a)}else{var p=null,o=false;if(m.externalSourceType=="twitter"){p=summary;o=true}var a=new ISQ.Widget.TranslationHelper.Answer({id:m.id,title:m.title,summary:m.summary,translatedSummary:m.translatedSummary,skipSummary:o,extraInfo:{externalSourceType:m.externalSourceType,externalSourceId:m.externalSourceId,attachments:m.attachments},sourceLanguage:ISQ.Widget.Query.kbLanguageCode,context:m.context});if(!r){r=new Array()}r.push(a)}}else{var h=ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.kbLanguageCode)?ISQ.Translation.Infra.getLanguageDirection(ISQ.Widget.TranslationHelper.detectedLanguage):ISQ.Widget.Localize.array.dir;ISQ.Widget.Query.appendSingleAnswer({answerNum:k,title:m.title,summary:m.summary,externalSourceType:m.externalSourceType,externalSourceId:m.externalSourceId,attachments:m.attachments,footer:ISQ.Cnf.answerFooter,id:m.id,direction:h,showTranslateIcon:false,visible:true,context:m.context})
}}}else{var l=ISQ.Widget.Query.getCurrentQuestionFromTrail();if(l){var c=createDiv(ISQ.Widget.HTML.answerPane,".answerBackLinkContainer");var f=createLink({text:ISQ.Widget.getStaticText("back"),parent:c,onclick:function(){ISQ.Widget.Query.popQuestionFromTrail();ISQ.Widget.Query.tempQuestionTrailId=null;if(!this.question.isTagAnId){ISQ.Widget.Query.ask(this.question.tag,true)}else{ISQ.Widget.Query.tempQuestionTrailId=this.question.tag;ISQ.Widget.Query.getAnswerById(this.question.tag)}}});f.question=l}var h=ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.kbLanguageCode)?ISQ.Translation.Infra.getLanguageDirection(ISQ.Widget.TranslationHelper.detectedLanguage):ISQ.Widget.Localize.array.dir;var g=createDiv(ISQ.Widget.HTML.answerPane,"direction:"+h);g.innerHTML=ISQ.Widget.getStaticText("searchMsgNOResults")}if(r&&r.length>0){ISQ.Widget.Query.answerTranslator=new ISQ.Widget.TranslationHelper.AnswersTranslator({answers:r,handler:new ISQ.Handler(ISQ.Widget.Query.answersTranslated),queryId:ISQ.Widget.Query.activeRequestId});if(ISQ.Widget.Query.gettingAnswerById){ISQ.Widget.HTML.queryField.value=""}}else{ISQ.Widget.Query.displayAnswers(false)}}catch(j){ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.Log.add("Query.parseAnswers:"+j,ISQ.Widget.Log.statusEnum.RED)}};ISQ.Widget.Query.getResultObject=function(a){return{title:a.getElementsByTagName("title")[0].firstChild.nodeValue,summary:a.getElementsByTagName("Summary")[0].firstChild.nodeValue,attachments:a.getElementsByTagName("attachments")[0].firstChild.nodeValue,id:a.getAttribute("id"),externalSourceType:a.getAttribute("externalSourceType"),externalSourceId:a.getAttribute("externalSourceId"),answerTranslation:a.getElementsByTagName("Translation").length>0?a.getElementsByTagName("Translation")[0].firstChild.nodeValue:null,translationProvider:a.getElementsByTagName("Translation").length>0?parseInt(a.getElementsByTagName("Translation")[0].getAttribute("provider")):null,chatEscalationAction:parseInt(a.getElementsByTagName("chatEscalationAction")[0].getAttribute("value")),chatInviteContent:a.getElementsByTagName("chatEscalationAction")[0].firstChild?a.getElementsByTagName("chatEscalationAction")[0].firstChild.nodeValue:null,chatRequiredSkill:a.getElementsByTagName("chatRequiredSkill").length>0?a.getElementsByTagName("chatRequiredSkill")[0].firstChild.nodeValue:null,context:a.getElementsByTagName("context").length>0?ISQ.Data.parseArticleContext(a.getElementsByTagName("context")[0].firstChild.nodeValue):null}
};ISQ.Widget.Query.compareResults=function(a,b){return a.title===b.title&&a.summary===b.summary&&a.id===b.id&&a.attachments===b.attachments&&a.externalSourceType===b.externalSourceType&&a.externalSourceId===b.externalSourceId&&a.answerTranslation===b.answerTranslation&&a.translationProvider===b.translationProvider&&a.chatEscalationAction===b.chatEscalationAction&&a.chatInviteContent===b.chatInviteContent&&a.chatRequiredSkill===b.chatRequiredSkill&&a.context===b.context};ISQ.Widget.Query.answersTranslated=function(h,g){if(g!=ISQ.Widget.Query.activeRequestId){return}if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0){return}var c=ISQ.Widget.TranslationHelper.getStaticTranslation(ISQ.Widget.TranslationHelper.staticTranslationsEnum.footer);var b=ISQ.Translation.Infra.getLanguageDirection(ISQ.Widget.TranslationHelper.detectedLanguage);var f=ISQ.Translation.Infra.getLanguageDirection(ISQ.Cnf.initialUiLanguage);var e=new Array();for(var d=0;d<h.length;d++){var a=h[d];if(!a.failed){ISQ.Widget.Query.appendSingleAnswer({answerNum:d,title:a.translatedTitle,summary:a.translatedSummary,externalSourceType:a.extraInfo.externalSourceType,externalSourceId:a.extraInfo.externalSourceId,attachments:a.extraInfo.attachments,footer:c,id:a.id,direction:b,showTranslateIcon:true,visible:true,apiProvider:a.provider,context:a.context})}ISQ.Widget.Query.appendSingleAnswer({answerNum:d,title:a.title,summary:a.summary,externalSourceType:a.extraInfo.externalSourceType,externalSourceId:a.extraInfo.externalSourceId,attachments:a.extraInfo.attachments,footer:ISQ.Cnf.answerFooter,id:a.id,direction:f,showTranslateIcon:true,visible:a.failed,apiProvider:a.provider,context:a.context});if(!a.failed&&!a.isCachedTranslation){e.push(a)}if(d==0&&ISQ.Widget.Query.gettingAnswerById){ISQ.Widget.HTML.queryField.value=a.translatedTitle;ISQ.Widget.Query.lastQuerySent=a.translatedTitle}}ISQ.Widget.Query.displayAnswers(false);if(e.length>0){ISQ.Widget.Translation.addTranslatedAnswersToServerCache(e,ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage))
}};ISQ.Widget.Query.appendSingleAnswer=function(obj){var padding;var tbody=createTable(ISQ.Widget.HTML.answerPane,"",obj.direction,".answerTable");var tableId="tblAnswer_"+obj.id;tbody.parentNode.setAttribute("id",tableId+obj.visible);if(!obj.visible){ISQ.CSS.setStyle(tbody.parentNode,".answerTable &display:none;")}var textAlign=obj.direction==="rtl"?"right":"left";var textAlignOpp=obj.direction==="rtl"?"left":"right";if(obj.title&&obj.title.Trim()!==""){var tr=createRow(tbody,".TRanswerOnMouseout");tr.onmouseover=function(){this.className="TRanswerOnMouseover"};tr.onmouseout=function(){this.className="TRanswerOnMouseout"};var td=createTd(tr,"","top");var titleText;var titleTable=createTable(td,"100%",obj.direction);var titleTr=createRow(titleTable);var titleTd=createTd(titleTr,"","top",".answerTitle");var externalSourceIconShown=false;if(obj.externalSourceType){var result=ISQ.Widget.Query.parseExternalSourceTitle(obj.title,obj.externalSourceType,obj.externalSourceId);titleText=result.title;if(result.sourceIcon!==null){externalSourceIconShown=true;td=createTd(titleTr,"","top",".answerIcon");td.appendChild(result.sourceIcon)}}else{titleText=ISQ.Data.breakWords(obj.title)}if(obj.answerNum==0){var previousQuestion=ISQ.Widget.Query.getCurrentQuestionFromTrail();if(previousQuestion){var backDiv=createDiv(titleTd,".answerBackLinkContainer");var backLink=createLink({text:ISQ.Widget.getStaticText("back"),parent:backDiv,onclick:function(){ISQ.Widget.Query.popQuestionFromTrail();ISQ.Widget.Query.tempQuestionTrailId=null;if(!this.question.isTagAnId){ISQ.Widget.Query.ask(this.question.tag,true)}else{ISQ.Widget.Query.tempQuestionTrailId=this.question.tag;ISQ.Widget.Query.getAnswerById(this.question.tag)}}});backLink.question=previousQuestion}}createDiv(titleTd).innerHTML=titleText;if(obj.context!=null&&ISQ.Widget.Query.contextCategories){var d=createDiv(titleTd,".answerContextContainer");for(var ndx in obj.context){if((ISQ.Widget.Query.contextCategories[ndx].flags&ISQ.Widget.enumKBCategoriesFlags.visibleInWidget)!=ISQ.Widget.enumKBCategoriesFlags.visibleInWidget){continue
}createElement("span",d,".answerContext").innerHTML=obj.context[ndx]}}var translationIcon=null;if(obj.showTranslateIcon&&ISQ.Cnf.translationEnabled){var dir=obj.visible?obj.direction:null;translationIcon=ISQ.Widget.Translation.createTranslationIcon(tableId,obj.apiProvider,obj.dir,obj.visible);if(translationIcon!==null){padding="&padding-"+(externalSourceIconShown?textAlign:textAlignOpp)+": 5px;";td=createTd(titleTr,"","top",".answerIcon"+padding);td.appendChild(translationIcon)}}if(ISQ.Widget.state===ISQ.Widget.enumState.questions&&ISQ.Widget.userActive&&!obj.externalSourceType){padding=translationIcon?"":"&padding-"+textAlign+": 5px;";td=createTd(titleTr,"","top",".answerIcon"+padding);ISQ.Widget.ThumbUp.Rememberer.addIcon(td,ISQ.Widget.Query.lastQuerySent,obj.id,obj.visible)}}var answerBuilder=[];var summaryResult=ISQ.Data.getDBAnswerAsHtml(obj.summary,false,ISQ.Widget.Query.appendQuestionTag);var summary=summaryResult.text;if(obj.externalSourceType){summary=ISQ.Widget.Query.parseExternalSourceSummary(summary,obj.externalSourceType)}answerBuilder.push(summary);if(obj.attachments){answerBuilder.push('<ul class="attachments">');var att=obj.attachments.split(",");for(var i=0;i<att.length;i++){answerBuilder.push("<li>");ISQ.Widget.Query.buildAttachmentLink(att[i],answerBuilder);answerBuilder.push("</li>")}answerBuilder.push("</ul>")}if(obj.answerNum===ISQ.Widget.Query.numberOfTopics-1||!ISQ.Cnf.showFooterOnlyOnLastAnswer){answerBuilder.push('<div class="answerFooter">');answerBuilder.push(obj.footer);answerBuilder.push("</div>")}var summaryTr=createRow(tbody);var summaryTd=createTd(summaryTr,"","top",".answerBody");summaryTd.innerHTML=answerBuilder.join("");if(summaryResult.script){eval(""+summaryResult.script+"")}if(ISQ.Cnf.answerFooterScript&&(obj.answerNum===ISQ.Widget.Query.numberOfTopics-1||!ISQ.Cnf.showFooterOnlyOnLastAnswer)){eval(""+ISQ.Cnf.answerFooterScript+"")}ISQ.Widget.Query.resizeSingleAnswerElements(summaryTd,true)};ISQ.Widget.Query.buildAttachmentLink=function(c,a){var b=c.indexOf("/");if(b==-1){return
}a.push('<a href="');a.push("http://");a.push(c.substring(0,b));a.push(".s3.amazonaws.com/");a.push(c.substring(b+1));a.push('" target="_blank">');a.push(c.substring(c.lastIndexOf("/")+1));a.push("</a>")};ISQ.Widget.Query.toTranslateContent=function(b,c){if(!ISQ.Cnf.translationEnabled||ISQ.Cnf.translationDetectionOnly){return false}if(!ISQ.Widget.TranslationHelper.languageEnabled){return false}if(!c){c=ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage)}if(!c){return false}var a=ISQ.Tools.getUniformLanguageCode(b);return c!=a};ISQ.Widget.Query.getFader=function(){if(ISQ.Widget.Query.fader===null){ISQ.Widget.Query.fader=new VisualEffects.Fade(ISQ.Widget.HTML.answerPane);ISQ.Widget.Query.fader.fadeOutEvent.addHandler(ISQ.Widget.Query.fader_fadeOutHandler);ISQ.Widget.Query.fader.fadeInEvent.addHandler(ISQ.Widget.Query.fader_fadeInHandler)}return ISQ.Widget.Query.fader};ISQ.Widget.Query.displayAnswers=function(d){var a=(ISQ.Widget.LP.isAvailable||(ISQ.Cnf.customEscalationLink&&ISQ.Cnf.customEscalationLink_Action===ISQ.Widget.enumCustomLinkStats.countChatEscalation));if(ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions&&ISQ.Widget.Query.chatInviteContent&&ISQ.Widget.Query.chatEscalationAction==ISQ.Widget.enumChatEscalationActions.inviteChat&&a){var b=createDiv(null,".chatInviteDiv");b.innerHTML=ISQ.Widget.Query.chatInviteContent;ISQ.Widget.HTML.answerPane.insertBefore(b,ISQ.Widget.HTML.answerPane.firstChild);ISQ.Widget.Query.chatInviteContent=null;if(ISQ.Widget.LP.isAvailable){b.onclick=function(){ISQ.Widget.Chat.requestChat(false,ISQ.Widget.enumChatEscalationActions.inviteChat)}}else{b.onclick=function(){b.style.display="none";ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.customChat,ISQ.Widget.enumChatEscalationActions.inviteChat)}}}if(!d&&ISQ.Widget.state!==ISQ.Widget.enumState.autoQuestions&&ISQ.Widget.userActive){ISQ.Widget.Query.showActionBar()}ISQ.Widget.HTML.answerPane.style.display="block";if(ISQ.Http.browser.full!=="safari3"){ISQ.Widget.HTML.contentWrapper.scrollTop=0}ISQ.Widget.HTML.dynamicSize_sendMessage();
if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.answerPane)){var c=ISQ.Widget.Query.getFader();c.fadeIn(200,true)}else{ISQ.Widget.Query.fader_fadeInHandler()}if(a&&ISQ.Widget.state===ISQ.Widget.enumState.questions&&ISQ.Widget.Query.chatEscalationAction==ISQ.Widget.enumChatEscalationActions.pushChat&&!ISQ.Widget.Query.chatPushed){ISQ.Widget.Query.chatPushed=true;if(ISQ.Widget.LP.isAvailable){ISQ.Widget.Chat.requestChat(false,ISQ.Widget.enumChatEscalationActions.pushChat)}else{ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.customChat,ISQ.Widget.enumChatEscalationActions.pushChat)}}ISQ.Widget.Query.resizeAnswerElements()};ISQ.Widget.Query.showActionBar=function(){var d=null;var b=null;var c=null;if(ISQ.Cnf.customEscalationLink&&ISQ.Cnf.customEscalationLink_Action!==ISQ.Widget.enumCustomLinkStats.countChatEscalation){d=c=_("customLink")}else{d=_("repByEmail")}d.innerHTML=ISQ.Widget.getStaticText("email");var i=false;switch(ISQ.Cnf.showChatConfiguration){case ISQ.Widget.enumShowChatConfiguration.always:i=ISQ.Widget.Query.chatEscalationAction>ISQ.Widget.enumChatEscalationActions.hide;break;case ISQ.Widget.enumShowChatConfiguration.selectedAnswers:i=ISQ.Widget.Query.chatEscalationAction>ISQ.Widget.enumChatEscalationActions.normal;break;case ISQ.Widget.enumShowChatConfiguration.selectedAnswers_and_noAnswers:i=ISQ.Widget.Query.chatEscalationAction>ISQ.Widget.enumChatEscalationActions.normal||ISQ.Widget.Query.firstAnswerId===-1;break}if(i){if(ISQ.Cnf.customEscalationLink&&ISQ.Cnf.customEscalationLink_Action===ISQ.Widget.enumCustomLinkStats.countChatEscalation){b=c=_("customChat")}else{if(ISQ.Widget.LP.isAvailable){b=_("repByChat")}}if(b){b.innerHTML=ISQ.Widget.getStaticText("chat")}}if(c){c.href=ISQ.Widget.Query.buildCustomLink(ISQ.Cnf.customEscalationLink);switch(ISQ.Cnf.customEscalationLink_target){case ISQ.Widget.enumCustomLinkTarget.CurrentPage:c.target="_top";break;case ISQ.Widget.enumCustomLinkTarget.NewTab:c.target="_blank";break;case ISQ.Widget.enumCustomLinkTarget.Popup:c.target="_blank";break;case ISQ.Widget.enumCustomLinkTarget.Widget:c.target="_self";
break;default:c.target="_blank";break}}_("customLink").style.display="none";_("repByEmail").style.display="none";_("customChat").style.display="none";_("repByChat").style.display="none";_("actionBarSep").style.display="none";if(b){b.style.display="block";if(ISQ.Cnf.alwaysShowEscalationLink){_("actionBarSep").style.display="block";d.style.display="block"}}else{d.style.display="block"}ISQ.Widget.HTML.showActionBar();if(ISQ.Widget.HTML.pendingShowActionBar){return}var a=_("actionBarText");a.innerHTML="";var k=ISQ.Widget.HTML.actionBarQuery.offsetWidth;var g=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.actionBarQuery,"padding-left");if(g){k-=parseInt(g)}var h=ISQ.CSS.getElementStyle(ISQ.Widget.HTML.actionBarQuery,"padding-right");if(h){k-=parseInt(h)}var e=ISQ.CSS.getElementStyle(a,"margin-left");if(e){k-=parseInt(e)}var f=ISQ.CSS.getElementStyle(a,"margin-right");if(f){k-=parseInt(f)}k=k-_("repByEmail").offsetWidth-_("actionBarSep").offsetWidth-_("repByChat").offsetWidth;var j=ISQ.Cnf.customAskRepByText||ISQ.Widget.getStaticText("askBy");ISQ.Data.autoEllipseText(j,k,a,null,null,"#actionBarWrapper")};ISQ.Widget.Query.buildCustomLink=function(d){var c=d.replace("{QUERY}",encodeURIComponent(_query(true)));var a=nanoRep.Widget.API.getCustomParams();for(var b in a){c=c.replace("{"+b+"}",encodeURIComponent(a[b]))}c=c.replace(/\{.*?\}/g,"");return c};ISQ.Widget.Query.hideAnswers=function(c,a,d){ISQ.Widget.Query.fader_clearAnswers=a;ISQ.Widget.Query.fader_tempXml=c;if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.answerPane)){var b=ISQ.Widget.Query.getFader();b.fadeOut(200)}else{ISQ.Widget.Query.fader_fadeOutHandler()}if(ISQ.Cnf.translationEnabled){ISQ.Widget.Translation.toggleTranslationTooltip(null,false)}};ISQ.Widget.Query.resizeSingleAnswerElements=function(b,a){for(var d=0;d<ISQ.Widget.Query.resizeableTags.length;++d){var c=b.getElementsByTagName(ISQ.Widget.Query.resizeableTags[d]);for(var e=0;e<c.length;++e){if(!ISQ.Widget.HTML.isTeaser){ISQ.Widget.Query.resizeAnswerElement(c[e])}if(a){if(!ISQ.Widget.Query.elementsToResize){ISQ.Widget.Query.elementsToResize=new Array()
}ISQ.Widget.Query.elementsToResize.push(c[e])}if(ISQ.Widget.Query.resizeableTags[d]==="IMG"){c[e].onload=function(){this.loaded=true;this.setAttribute("loaded","true");if(ISQ.Widget.HTML.isTeaser){return}if(ISQ.Widget.HTML.currentlyResizing){return}ISQ.Widget.Query.resizeAnswerElement(this)}}}}};ISQ.Widget.Query.resizeAnswerElements=function(){if(ISQ.Widget.HTML.isTeaser){return}if(ISQ.Widget.HTML.currentlyResizing){return}var b=ISQ.CSS.getElementWidth(ISQ.Widget.HTML.answerPane);ISQ.Widget.Query.answerPaneWidth=b;if(!ISQ.Widget.Query.elementsToResize){return}for(var a=0;a<ISQ.Widget.Query.elementsToResize.length;++a){ISQ.Widget.Query.resizeAnswerElement(ISQ.Widget.Query.elementsToResize[a])}};ISQ.Widget.Query.resizeAnswerElement=function(c){if(ISQ.Widget.Query.answerPaneWidth<=0){return}if(c.nodeName==="IMG"){var f=c.getAttribute("loaded")==="true";if(!f&&!c.loaded){return}}var e=parseInt(c.getAttribute("lastResizeWidth"));if(!isNaN(e)){if(e===ISQ.Widget.Query.answerPaneWidth){return}}else{if(c.lastResizeWidth===ISQ.Widget.Query.answerPaneWidth){return}}c.lastResizeWidth=ISQ.Widget.Query.answerPaneWidth;c.setAttribute("lastResizeWidth",ISQ.Widget.Query.answerPaneWidth);var b=c.getAttribute("widthChanged")==="true";var j=c.offsetWidth;if(j===0){return}if(j>ISQ.Widget.Query.answerPaneWidth||b){var a=c.getAttribute("_ratio");if(!a){var d=c.offsetHeight;a=d/j;c.setAttribute("_ratio",a)}else{a=parseFloat(a)}var i=c.getAttribute("originalWidth");if(!i){i=j;c.setAttribute("originalWidth",i)}else{i=parseFloat(i)}var h=ISQ.Widget.Query.answerPaneWidth-5;if(h>i){h=i}var g=parseInt(a*h);c.style.width=h+"px";c.style.height=g+"px";c.setAttribute("widthChanged","true");c.setAttribute("width",h+"px");c.setAttribute("height",g+"px")}};ISQ.Widget.Query.fader_clearAnswers=false;ISQ.Widget.Query.fader_tempXml=null;ISQ.Widget.Query.fader_fadeOutHandler=function(){if(ISQ.Widget.Query.fader_clearAnswers){clearNode(ISQ.Widget.HTML.answerPane)}else{ISQ.Widget.HTML.answerPane.style.display="none";ISQ.Widget.HTML.dynamicSize_sendMessage()
}ISQ.Widget.Query.fader_clearAnswers=false;ISQ.Widget.Query.firstAnswerId=-1;if(ISQ.Widget.Query.fader_tempXml){ISQ.Widget.Query.processAnswers(ISQ.Widget.Query.fader_tempXml);ISQ.Widget.Query.fader_tempXml=null}};ISQ.Widget.Query.fader_fadeInHandler=function(){ISQ.Widget.HTML.searchAnim.hide();ISQ.Widget.HTML.fixContentWidths();if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.showNext()}};ISQ.Widget.getStaticText=function(b){var a;if(ISQ.Cnf.translationEnabled&&ISQ.Widget.TranslationHelper.detectedLanguage&&ISQ.Widget.TranslationHelper.staticTranslationsEnum[b]){a=ISQ.Widget.TranslationHelper.getStaticTranslation(ISQ.Widget.TranslationHelper.staticTranslationsEnum[b])}if(!a){a=ISQ.Widget.Localize.array[b]}return a};ISQ.Widget.setInitialTexts=function(){if(ISQ.Cnf.customEmailButtonText){ISQ.Widget.Localize.array.email=ISQ.Cnf.customEmailButtonText.Trim()}if(ISQ.Cnf.customAskRepByText){ISQ.Widget.Localize.array.askBy=ISQ.Cnf.customAskRepByText.Trim()}if(ISQ.Cnf.customChatButtonText){ISQ.Widget.Localize.array.chat=ISQ.Cnf.customChatButtonText.Trim()}if(ISQ.Cnf.customNoAnswersText){ISQ.Widget.Localize.array.searchMsgNOResults=ISQ.Cnf.customNoAnswersText.Trim()}if(ISQ.Cnf.titleTeaserText){ISQ.Widget.Localize.array.titleTeaserText=ISQ.Cnf.titleTeaserText.Trim()}if(ISQ.Cnf.titleNormalText){ISQ.Widget.Localize.array.titleNormalText=ISQ.Cnf.titleNormalText.Trim()}ISQ.Widget.setTitle()};ISQ.Widget.setTitle=function(){var a;if(ISQ.Widget.customTitle){a=ISQ.Widget.customTitle}if(ISQ.Widget.HTML.isTeaser&&(!ISQ.Widget.isFloat||ISQ.Widget.HTML.currentWidth!==ISQ.Cnf.floatCollapsed_WidgetSize[0])){if(ISQ.Widget.customTeaserText){a=ISQ.Widget.customTeaserText}else{if(!ISQ.Widget.customTitle){a=ISQ.Widget.getStaticText("titleTeaserText")}}}else{a=ISQ.Widget.getStaticText("titleNormalText")}ISQ.Widget.HTML.titleText.innerHTML=a};ISQ.Widget.onCustomerLogoLoad=function(){var c=ISQ.Cnf.customerBrandingLogo_img;var a=_("customerLogo");a.src=c.src;var b=_("widgetFooter");if(ISQ.Widget.HTML.currentlyResizing||ISQ.Widget.HTML.isTeaser){a.pendingResize=true;
return}a.pendingResize=false;a.style.display="block";if(b.offsetHeight<c.height){b.style.height=c.height+"px";ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage()}else{var d=Math.floor(b.offsetHeight/2)-Math.floor(c.height/2)+"px";a.style.marginTop=d;if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.lineHeight=b.offsetHeight+"px"}}ISQ.Widget.HTML.Mobile.setPositions()};ISQ.Widget.Translation=initializeNS("ISQ.Widget.Translation");ISQ.Widget.Translation.createTranslationIcon=function(e,a,b,f){var d=createLink({style:f?".translationIcon":".translationIconOff",onclick:function(){ISQ.Widget.Translation.toggleTranslationTooltip(this,false);ISQ.Widget.Translation.toggleAnswerTranlsationVisibility(e)}});d.onmouseover=function(){ISQ.Widget.Translation.toggleTranslationTooltip(this,true)};d.onmouseout=function(){ISQ.Widget.Translation.toggleTranslationTooltip(this,false)};if(ISQ.Widget.Translation.translationTooltipDiv===null){ISQ.Widget.Translation.translationTooltipDiv=createDiv(document.body,".translationTooltip")}if(b){ISQ.Widget.Translation.translationTooltipDiv.style.direction=b}var c=new Array();c.push(ISQ.Widget.TranslationHelper.getStaticTranslation(ISQ.Widget.TranslationHelper.staticTranslationsEnum.translatedFrom));c.push("<p dir=ltr>");switch(a){case ISQ.Translation.Infra.providerEnum.Microsoft:c.push("Translation powered by Microsoft&reg; Translator");break;case ISQ.Translation.Infra.providerEnum.GoogleV1:case ISQ.Translation.Infra.providerEnum.GoogleV2:c.push("Translation powered by <img src='/widget/skins/googleLogo.png?cv=1' align='absmiddle' alt=''/>");break}c.push("</p>");ISQ.Widget.Translation.translationTooltipDiv.innerHTML=c.join("");return d};ISQ.Widget.Translation.toggleTranslationTooltip=function(a,d){if(!ISQ.Widget.Translation.translationTooltipDiv){return}var e=ISQ.Widget.Translation.translationTooltipDiv;if(d){if(!a){return}var c=ISQ.Html.position(a);var g=ISQ.Html.screenSize().w;var f=e.offsetWidth;var b=(c.x-f/2+8);b=b<0?0:b+f>g?g-f:b;e.style.left=b+"px";e.style.top=(c.y+20-ISQ.Widget.HTML.contentWrapper.scrollTop)+"px";
e.style.visibility="visible"}else{e.style.visibility="hidden"}};ISQ.Widget.Translation.toggleAnswerTranlsationVisibility=function(e){var a=e+"true";var b=e+"false";var c=_(a);var d=_(b);if(c&&d){var f=c.style.display;c.style.display=d.style.display;d.style.display=f;ISQ.Widget.Query.resizeSingleAnswerElements(d,false);ISQ.Widget.HTML.dynamicSize_sendMessage()}};ISQ.Widget.Translation.translationFailedHandler=function(b,a){var c=null;var d=a==null?"":ISQ.Translation.Infra.getProviderName(a);switch(b){case ISQ.Translation.Infra.failureEnum.DetectionTimeout:c="Language detection has timed out using provider: "+d;break;case ISQ.Translation.Infra.failureEnum.DetectionApiFallback:c="Language detection: falling back from provider: "+d;break;case ISQ.Translation.Infra.failureEnum.TranslationTimeout:c="Translation has timed out using provider: "+d;break;case ISQ.Translation.Infra.failureEnum.TranslationApiFallback:c="Translation: falling back to provider: "+d;break;case ISQ.Translation.Infra.failureEnum.TranslationDead:c="Both API Providers have failed. Translations are now turned off.";ISQ.Cnf.translationEnabled=false;if(ISQ.Widget.Query.answerTranslator){ISQ.Widget.Query.answerTranslator.translationFailed();ISQ.Widget.Query.answerTranslator=null}else{if(ISQ.Widget.Query.queryTranslator){ISQ.Widget.Query.queryTranslator.translationFailed();ISQ.Widget.Query.queryTranslator=null}}break}_session().translationFailed(b,c,a,null)};ISQ.Widget.Translation.addTranslatedAnswersToServerCache=function(k,e){if(!k||k.length==0){return}var b=[];for(var c=0;c<k.length;c++){var a=k[c];var j=ISQ.Tools.Base64.encodeString(a.translatedTitle);var g=ISQ.Tools.Base64.encodeString(a.translatedSummary);var h=j+ISQ.Widget.Query.cachedAnswerTranslationDelimiter+g;var d=!a.extraInfo.externalSourceType;var f=a.provider;b.push({key:a.id,translation:h,isKeyNumeric:d,provider:f})}ISQ.Translation.Service.ServerDictionary.addTranslations(b,e)};ISQ.Widget.Translation.translationTooltipDiv=null;ISQ.Widget.Query.parseExternalSourceTitle=function(g,f,e){var b="",a="",c="";
switch(f){case"twitter":g=ISQ.Data.parseTwitterStatus(g);b="twitterSourceIcon";a="This answer's source is Twitter";c="http://www.twitter.com/"+e;break}var d=createLink({style:".answerSourceIcon "+b,title:a,href:c,target:"_blank"});return{title:g,sourceIcon:d}};ISQ.Widget.Query.parseExternalSourceSummary=function(b,a){switch(a){case"twitter":return(new Date(ISQ.Tools.Time.toClientTicks(b))).ToString("%d/%m/%y   %H:%M")}};ISQ.Widget.ThumbUp={};ISQ.Widget.ThumbUp.send=function(a){if(!a){return}var c=_query(true);if(!c){return}if(ISQ.Widget.reportEvents){var b="";iteration(ISQ.Widget.Query.previousAnswers,function(d){if(d.id===a){b=d.title;return false}});ISQ.Widget.CDC.sendMessage("subject=event&type=like&query="+ISQ.Tools.Base64.encodeString(c)+"&answer="+ISQ.Tools.Base64.encodeString(b))}ISQ.Widget.HTML.hideActionBar();_session().thumbUp(ISQ.Widget.ThumbUp.parseResponse,a,c,ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage),ISQ.Widget.Query.lastQueryTranslation)};ISQ.Widget.ThumbUp.parseResponse=function(a){var b=a.xml.getElementsByTagName("Result")[0];var d=b.getAttribute("type");if(d!=="thumb-up"){return}var c=b.getAttribute("topicId");ISQ.Widget.ThumbUp.Rememberer.set(c)};ISQ.Widget.ThumbUp.Rememberer={};ISQ.Widget.ThumbUp.Rememberer.idArray=new Array();ISQ.Widget.ThumbUp.Rememberer.queryArray=new Array();ISQ.Widget.ThumbUp.Rememberer.currentQuery="";ISQ.Widget.ThumbUp.Rememberer.addIcon=function(b,c,d,e){if(typeof(ISQ.Widget.ThumbUp.Rememberer.queryArray[c])==="undefined"){ISQ.Widget.ThumbUp.Rememberer.queryArray[c]=new Array()}else{if(ISQ.Widget.ThumbUp.Rememberer.currentQuery!==c){delete ISQ.Widget.ThumbUp.Rememberer.queryArray[c];ISQ.Widget.ThumbUp.Rememberer.queryArray[c]=new Array()}}ISQ.Widget.ThumbUp.Rememberer.currentQuery=c;ISQ.Widget.ThumbUp.Rememberer.queryArray[c].push(d);var a=null;if(typeof(ISQ.Widget.ThumbUp.Rememberer.idArray[d])!=="undefined"&&ISQ.Widget.ThumbUp.Rememberer.idArray[d]==="1"){a=createLink({parent:b});a.className="thumbUpApplied"}else{a=createLink({parent:b,onclick:function(){ISQ.Widget.ThumbUp.send(d)
},title:ISQ.Widget.Localize.array.like});a.id=ISQ.Widget.ThumbUp.Rememberer.getIconElement(d,e);a.className="thumbUp"}};ISQ.Widget.ThumbUp.Rememberer.set=function(f){if(!ISQ.Widget.ThumbUp.Rememberer.queryArray[ISQ.Widget.ThumbUp.Rememberer.currentQuery]){return}var e=ISQ.Widget.ThumbUp.Rememberer.queryArray[ISQ.Widget.ThumbUp.Rememberer.currentQuery].length;for(var d=0;d<e;++d){var c=ISQ.Widget.ThumbUp.Rememberer.queryArray[ISQ.Widget.ThumbUp.Rememberer.currentQuery][d];var a=_(ISQ.Widget.ThumbUp.Rememberer.getIconElement(c,true),true);var b=_(ISQ.Widget.ThumbUp.Rememberer.getIconElement(c,false),true);if(c==f){if(a!==null){ISQ.Widget.ThumbUp.Rememberer.disableLikeIcon(a)}if(b!==null){ISQ.Widget.ThumbUp.Rememberer.disableLikeIcon(b)}ISQ.Widget.ThumbUp.Rememberer.idArray[f]="1"}else{if(a!==null){a.style.display="none"}if(b!==null){b.style.display="none"}}}ISQ.Widget.ThumbUp.Rememberer.currentQuery=""};ISQ.Widget.ThumbUp.Rememberer.isIdThumbed=function(a){return(typeof(ISQ.Widget.ThumbUp.Rememberer.idArray[a])!=="undefined"&&ISQ.Widget.ThumbUp.Rememberer.idArray[a]==="1")};ISQ.Widget.ThumbUp.Rememberer.disableLikeIcon=function(a){a.className="thumbUpApplied";a.onclick=null;a.title=""};ISQ.Widget.ThumbUp.Rememberer.getIconElement=function(a,b){return"thumbUpImage"+a+b};ISQ.Widget.Escalate={};ISQ.Widget.Escalate.enumType={email:0,customEmail:1,customChat:2,chat:3};ISQ.Widget.Escalate.send=function(e,a,c){if(typeof(a)==="undefined"){a=null}if(typeof(c)==="undefined"){c=false}if(a){c=true}var d=_query(true);if(!c&&!d){return}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.AutoQuestions.stop_()}if(e!==ISQ.Widget.Escalate.enumType.chat){ISQ.Widget.HTML.Mobile.hideAddressbar();if(e===ISQ.Widget.Escalate.enumType.customEmail){ISQ.Widget.state=ISQ.Widget.enumState.customLink}else{ISQ.Widget.state=ISQ.Widget.enumState.contactForm}ISQ.Widget.HTML.hideActionBar()}ISQ.Widget.Query.lastQuerySent="";_session().escalateQuestion(ISQ.Widget.Escalate.parseResponse,ISQ.Widget.Query.firstAnswerId,d,ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage),ISQ.Widget.Query.lastQueryTranslation,e,a);
if(e===ISQ.Widget.Escalate.enumType.customEmail||e===ISQ.Widget.Escalate.enumType.customChat){ISQ.Widget.ThumbUp.Rememberer.set();if(ISQ.Cnf.customEscalationLink_target===ISQ.Widget.enumCustomLinkTarget.Popup||(e===ISQ.Widget.Escalate.enumType.customChat&&a!=ISQ.Widget.enumChatEscalationActions.normal)){var f=800,b=600;if(ISQ.Cnf.customLinkPopupSize!=null){f=ISQ.Cnf.customLinkPopupSize[0];b=ISQ.Cnf.customLinkPopupSize[1]}window.open(ISQ.Widget.Query.buildCustomLink(ISQ.Cnf.customEscalationLink),"nr_escalationWindow","height="+b+",width="+f);return false}else{return true}}};ISQ.Widget.Escalate.parseResponse=function(d){ISQ.Widget.Log.add("post question response received");if(d.xml===null){ISQ.Widget.Log.add("Error parsing escalation response");return}if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){ISQ.Widget.HTML.contentWrapper.scrollTop=0}try{var f=d.xml.getElementsByTagName("Result")[0];var i=f.getAttribute("type");var g,h,c;var c=d.token.tag;switch(c.escType){case ISQ.Widget.Escalate.enumType.email:c.escType="email";break;case ISQ.Widget.Escalate.enumType.customEmail:c.escType="customEmail";break;case ISQ.Widget.Escalate.enumType.customChat:c.escType="customChat";break;case ISQ.Widget.Escalate.enumType.chat:c.escType="chat";break}switch(i){case"noAction":if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=escalation&query="+ISQ.Tools.Base64.encodeString(c.query)+"&esctype="+c.escType)}g=f.getElementsByTagName("Text");h="";if(g.length>0){h=g[0].firstChild.nodeValue}if(h){if(ISQ.Widget.ContactForm.toTranslateContactForm){ISQ.Translation.Infra.translate(h,null,ISQ.Widget.TranslationHelper.detectedLanguage,new ISQ.Handler(ISQ.Widget.Escalate.showThankYouMessage))}else{ISQ.Widget.Escalate.showThankYouMessage(h)}return}if(ISQ.Widget.state===ISQ.Widget.enumState.contactForm){ISQ.Widget.state=ISQ.Widget.enumState.questions}break;case"contactForm":ISQ.Widget.ContactForm.detectedLanguageKBExists=(f.getAttribute("detectedLanguageKBExists")==="True");if(ISQ.Cnf.limited){ISQ.Widget.HTML.queryField.style.display="";
ISQ.Widget.HTML.queryField.style.visibility="visible"}var a=f.firstChild.attributes.lang?f.firstChild.attributes.lang.value:"";ISQ.Widget.ContactForm.toTranslateContactForm=ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.initialUiLanguage)&&a!=ISQ.Widget.TranslationHelper.detectedLanguage;if(ISQ.Widget.ContactForm.toTranslateContactForm){new ISQ.Widget.TranslationHelper.ContactFormTranslator({xmlNode:f.firstChild,fromLanguage:a||ISQ.Cnf.initialUiLanguage,handler:new ISQ.Handler(ISQ.Widget.Escalate.buildContactForm)})}else{ISQ.Widget.Escalate.buildContactForm(f.firstChild)}ISQ.Widget.ContactForm.thankYouShown=false;ISQ.Widget.ContactForm.closed=false;ISQ.Widget.ContactForm.canceled=false;break;case"customLink":if(ISQ.Widget.reportEvents){ISQ.Widget.CDC.sendMessage("subject=event&type=escalation&query="+ISQ.Tools.Base64.encodeString(c.query)+"&esctype="+c.escType)}break}}catch(b){ISQ.Widget.Log.add("Escalate.parseResponse:"+b.message,ISQ.Widget.Log.statusEnum.RED)}};ISQ.Widget.Escalate.buildContactForm=function(a){ISQ.Forms.getHTML({formNode:a,outputContainer:"contactForm",question:_query(false),noCancelButton:ISQ.Cnf.limited,direction:ISQ.Widget.Localize.array.dir})};ISQ.Widget.Escalate.showThankYouMessage=function(a){ISQ.Widget.state=ISQ.Widget.enumState.questions;if(ISQ.Cnf.limited){ISQ.Widget.HTML.queryField.style.display="none";ISQ.Widget.HTML.queryField.style.visibility="hidden"}ISQ.Widget.Query.displayAnswers(true);ISQ.Widget.HTML.answerPane.style.display="block";ISQ.Widget.HTML.answerPane.innerHTML=a;ISQ.Widget.ContactForm.thankYouShown=true;ISQ.Widget.ContactForm.closeComplete()};ISQ.Widget.ContactForm={};ISQ.Widget.ContactForm.fader=null;ISQ.Widget.ContactForm.fader_submit=false;ISQ.Widget.ContactForm.blockedCreditCardReplacement="*";ISQ.Widget.ContactForm.toTranslateContactForm=false;ISQ.Widget.ContactForm.closed=false;ISQ.Widget.ContactForm.thankYouShown=false;ISQ.Widget.ContactForm.canceled=false;ISQ.Widget.ContactForm.detectedLanguageKBExists=null;ISQ.Widget.ContactForm.onload=function(){ISQ.Forms.listenToQueryChangeEvent(ISQ.Widget.Query.queryChangedEvent);
ISQ.Widget.HTML.answerPane.style.display="none";if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.contactForm)){if(ISQ.Widget.ContactForm.fader===null){ISQ.Widget.ContactForm.fader=new VisualEffects.Fade(ISQ.Widget.HTML.contactForm);ISQ.Widget.ContactForm.fader.fadeOutEvent.addHandler(ISQ.Widget.ContactForm.fadeOutHandler);ISQ.Widget.ContactForm.fader.fadeInEvent.addHandler(ISQ.Widget.ContactForm.fadeInHandler)}ISQ.Widget.ContactForm.fader.setOpacity(0);ISQ.Widget.HTML.contactForm.style.display="block";ISQ.Widget.ContactForm.fader.fadeIn(200,true)}else{ISQ.Widget.HTML.contactForm.style.display="block";ISQ.Widget.ContactForm.fadeInHandler()}};ISQ.Widget.ContactForm.close=function(a){ISQ.Widget.ContactForm.fader_submit=a===true;if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.HTML.contactForm)){ISQ.Widget.ContactForm.fader.fadeOut(100)}else{ISQ.Widget.ContactForm.fadeOutHandler()}};ISQ.Widget.ContactForm.fadeInHandler=function(){if(ISQ.Cnf.showFooterWithContactForm===false){ISQ.Widget.HTML.footerWrapper.style.display="none"}ISQ.Widget.HTML.dynamicSize_sendMessage();ISQ.Widget.HTML.resizeHandler()};ISQ.Widget.ContactForm.fadeOutHandler=function(){ISQ.Widget.HTML.contactForm.style.display="none";if(!ISQ.Widget.ContactForm.fader_submit){var a=ISQ.Widget.HTML.queryField.value.Trim().length==0;ISQ.Widget.Query.displayAnswers(a)}else{ISQ.Widget.HTML.queryField.value=""}ISQ.Forms.unlistenToQueryChangeEvent(ISQ.Widget.Query.queryChangedEvent);ISQ.Widget.state=ISQ.Widget.enumState.questions;ISQ.Widget.HTML.searchWrapper.style.display="block";if(ISQ.Cnf.showFooterWithContactForm===false){ISQ.Widget.HTML.footerWrapper.style.display="block"}ISQ.Widget.ContactForm.closed=true;ISQ.Widget.ContactForm.closeComplete()};ISQ.Widget.ContactForm.clickEventHandler=function(a){switch(a.result){case ISQ.Forms.clickEventEnum.SUBMIT:ISQ.Widget.Log.add("contactForm submit");ISQ.Widget.ContactForm.send(a.formElements);ISQ.Widget.ContactForm.close(true);break;case ISQ.Forms.clickEventEnum.CANCEL:if(ISQ.Cnf.limited){break}ISQ.Widget.Log.add("contactForm cancel");
if(a.query!==""){ISQ.Widget.HTML.queryField.value=a.query}ISQ.Widget.ContactForm.canceled=true;ISQ.Widget.ContactForm.close();break;case ISQ.Forms.clickEventEnum.ERROR:ISQ.Widget.Log.add("contactForm input error");break}};ISQ.Widget.ContactForm.tabChangedHandler=function(a){if(a.isSubjectFieldInTab){ISQ.Widget.HTML.searchWrapper.style.display="none"}else{ISQ.Widget.HTML.searchWrapper.style.display="block"}ISQ.Widget.HTML.resizeHandler();if(ISQ.Widget.HTML.queryField.value!==a.subject){ISQ.Widget.HTML.queryField.value=a.subject}};ISQ.Widget.ContactForm.send=function(a){if(ISQ.Widget.Query.toTranslateContent(ISQ.Cnf.initialUiLanguage)){if(!ISQ.Widget.ContactForm.detectedLanguageKBExists){new ISQ.Widget.TranslationHelper.SubmittedFormTranslator({fromLanguage:ISQ.Widget.TranslationHelper.detectedLanguage,toLanguage:ISQ.Widget.Query.kbLanguageCode,contactForm:a,question:_query(true),handler:new ISQ.Handler(ISQ.Widget.ContactForm.send_internal)})}else{ISQ.Widget.ContactForm.send_internal(a,true)}}else{ISQ.Widget.ContactForm.send_internal(a)}};ISQ.Widget.ContactForm.send_internal=function(a,b){ISQ.Widget.Query.previousAnswers=null;_session().sendContactForm(ISQ.Widget.Escalate.parseResponse,ISQ.Widget.Query.firstAnswerId,a,_query(true),b?ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage):"",ISQ.Cnf.blockCreditCardNumbers?ISQ.Widget.ContactForm.blockedCreditCardReplacement:null,ISQ.Widget.Escalate.enumType.email)};ISQ.Widget.ContactForm.closeComplete=function(){if(!ISQ.Widget.ContactForm.closed||(!ISQ.Widget.ContactForm.thankYouShown&&!ISQ.Widget.ContactForm.canceled)){return}ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage()};ISQ.Widget.CDC={};ISQ.Widget.CDC.lastMessage="load";ISQ.Widget.CDC.waitingForFrameToLoad=false;ISQ.Widget.CDC.nextMessage="";ISQ.Widget.CDC.user=null;ISQ.Widget.CDC.messageOrdinal_cdc2=0;ISQ.Widget.CDC.init=function(){var a;if(ISQ.Widget.isPreview){a=window.location.protocol+"//"+ISQ.Http.domain(true)}else{a=ISQ.Widget.referer.normal.substring(0,ISQ.Widget.referer.normal.indexOf("/",8))
}if(ISQ.Widget.sendingCDCMessages){if(ISQ.Widget.supportsPostMessage){ISQ.Widget.cdcVersion="3"}switch(ISQ.Widget.cdcVersion){case"1":case"2":break;case"3":ISQ.Widget.CDC.user=new ISQ.CDC.User({targetWindowName:"parent",proxyIFrameUrl:ISQ.Widget.cdcFrame,allowMessagesFrom:a,server:window.location.protocol+"//"+window.location.host});break}}if(!ISQ.Widget.CDC.user){ISQ.Widget.CDC.user=new ISQ.CDC.User({allowMessagesFrom:a})}ISQ.Widget.CDC.user.incomingMessageEvent.addHandler(ISQ.Widget.CDC.incomingMessage)};ISQ.Widget.CDC.incomingMessage=function(message){switch(message.subject){case"api":var formData=message.form;if(formData){if(ISQ.Http.browser.isMobile){ISQ.Widget.HTML.Mobile.formPredefinedData=formData}else{ISQ.Forms.incomingPreDefinedValuesFromMessage(formData)}}var context=message.context;if(context){if(ISQ.Http.browser.isMobile){ISQ.Widget.HTML.Mobile.context=context}else{_session().setContext(ISQ.Widget.CDC_getKeyValueArrayFromMessage(context))}}var custParams=message.customparams;if(custParams){ISQ.Widget.API.customParams=ISQ.Widget.CDC_getKeyValueArrayFromMessage(custParams)}break;case"cnf":var cmd=message.command;if(cmd==="finished"){setTimeout(function(){ISQ.Widget.Cnf.postDownload()},0)}else{var val=message.value;switch(message.type){case"number":if(val.contains(".")){val=parseFloat(val)}else{val=parseInt(val)}break;case"boolean":val=val==="true";break;case"array":val="["+val+"]";val=eval(val);break;case"object":val="({"+val+"})";val=eval(val);break;case"string":val=ISQ.Http.Cookies.decode64(val);break;default:break}ISQ.Cnf[cmd]=val}break;case"refreshSize":ISQ.Widget.HTML.resizeHandler(null,true);break;case"openContactForm":if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0){break}ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.email,null,true);break;case"startChat":if((ISQ.Widget.state&ISQ.Widget.enumState.allQuestions)===0){break}if(ISQ.Widget.state===ISQ.Widget.enumState.autoQuestions){ISQ.Widget.Query.clearTextboxOnInteraction=true;ISQ.Widget.AutoQuestions.stop_()}var countStatsOnly=message.countstatsonly;
if(countStatsOnly){ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.chat,ISQ.Widget.enumChatEscalationActions.normal);break}if(!ISQ.Widget.LP.isAvailable){break}ISQ.Widget.Chat.requestChat(false);break;case"ask":if((ISQ.Widget.state&ISQ.Widget.enumState.questions)===0){break}var q=message.question||"";if(q.length===0){break}ISQ.Widget.userActive=true;ISQ.Widget.Query.ask(q,true,true);break;case"mobileOpenNewWindow":ISQ.Widget.HTML.Mobile.beforeOpeningWidget();break;case"closesession":_session().closeSession();setTimeout(function(){ISQ.Widget.CDC.sendMessage("subject=sessionclosed")},0);break}};ISQ.Widget.CDC.sendMessage=function(d,c){if(!ISQ.Widget.sendingCDCMessages){return}if(!d){return}c=c===true;d+="&widget="+(ISQ.Widget.isFloat?"float":"embed");if(ISQ.Widget.CDC.lastMessage===d&&!c){return}var b,a;switch(ISQ.Widget.cdcVersion){case"1":if(ISQ.Widget.CDC.waitingForFrameToLoad){ISQ.Widget.CDC.nextMessage=d;return}ISQ.Widget.CDC.waitingForFrameToLoad=true;ISQ.Widget.CDC.nextMessage="";b=_("iframeContainer");a=ISQ.Widget.CDC.createIFrame(b);if(ISQ.Http.browser.app==="opera"){a.onload=ISQ.Widget.CDC.frameOnload}else{if(document.addEventListener){a.addEventListener("load",ISQ.Widget.CDC.cdc1_frameLoad,true)}else{if(document.attachEvent){a.attachEvent("onload",ISQ.Widget.CDC.cdc1_frameLoad)}}}a.src=ISQ.Widget.cdcFrame+"?"+d;b.appendChild(a);var e;while(b.childNodes.length!==1){e=b.firstChild;if(ISQ.Http.browser.app==="opera"){e.onload=null}else{if(document.addEventListener){e.removeEventListener("load",ISQ.Widget.CDC.cdc1_frameLoad,true)}else{if(document.attachEvent){e.detachEvent("onload",ISQ.Widget.CDC.cdc1_frameLoad)}}}b.removeChild(e)}b=null;ISQ.Widget.CDC.lastMessage=d;break;case"2":b=_("iframeContainer");a=ISQ.Widget.CDC.createIFrame(b);if(ISQ.Http.browser.app==="opera"){a.onload=ISQ.Widget.CDC.cdc2_frameLoad}else{if(document.addEventListener){a.addEventListener("load",ISQ.Widget.CDC.cdc2_frameLoad,true)}else{if(document.attachEvent){a.attachEvent("onload",ISQ.Widget.CDC.cdc2_frameLoad)}}}a.src=ISQ.Widget.cdcFrame+"#"+d+"&ord="+(++ISQ.Widget.CDC.messageOrdinal_cdc2);
b.appendChild(a);break;case"3":ISQ.Widget.CDC.user.sendMessage(d);break}};ISQ.Widget.CDC.cdc2_frameLoad=function(){var a=this;setTimeout(function(){if(a.parentNode){a.parentNode.removeChild(a)}},1000)};ISQ.Widget.CDC.cdc1_frameLoad=function(a){ISQ.Widget.CDC.waitingForFrameToLoad=false;if(ISQ.Widget.CDC.nextMessage!==""){ISQ.Widget.CDC.sendMessage(ISQ.Widget.CDC.nextMessage)}};ISQ.Widget.CDC.createIFrame=function(b){var a=createElement("iframe",null,"visibility:hidden;z-index:-1;border:0px;height:1px;width:1px;background:transparent;");a.id="cdcFrame"+new Date().getTime();a.setAttribute("allowTransparency",true);a.setAttribute("frameBorder",false);return a};ISQ.Widget.Chat={};ISQ.Widget.Chat.enumChatLineType={user:0,agent:1,quickAnswer:2};ISQ.Widget.Chat.intuitiveInput=null;ISQ.Widget.Chat.sessionKey="";ISQ.Widget.Chat.Info=null;ISQ.Widget.Chat.chatStarted=false;ISQ.Widget.Chat.resumingChat=false;ISQ.Widget.Chat.chatStartAction=null;ISQ.Widget.Chat.selectedLinksToAnswers=null;ISQ.Widget.Chat.linksToAnswersBaseId=new Date().getTime();ISQ.Widget.Chat.pendingResumeSessionId=null;ISQ.Widget.Chat.init=function(){ISQ.Widget.Chat.Info=eval("("+ISQ.Cnf.livePersonID+")");if(!ISQ.Widget.Chat.Info.lpNumber){return}if(!ISQ.Widget.Chat.Info.apiKey){ISQ.Widget.Chat.Info.apiKey="c774b56ff8a64cbba27743a8d4418b26"}if(!ISQ.Widget.Chat.Info.server){ISQ.Widget.Chat.Info.server="server.iad.liveperson.net"}if(ISQ.Cnf.chatAgentSkill){ISQ.Widget.Chat.Info.skill=ISQ.Cnf.chatAgentSkill}if(ISQ.Cnf.chatMaxWaitTime){ISQ.Widget.Chat.Info.maxWaitTime=ISQ.Cnf.chatMaxWaitTime}if(ISQ.Cnf.chatOpenInPopup){ISQ.Widget.Chat.Info.serverDetectionHandler=new ISQ.Handler(ISQ.Widget.Chat.serverDetectionHandler)}else{ISQ.Widget.Chat.Info.handler=new ISQ.Handler(function(){setTimeout(ISQ.Widget.Chat.providerAvailable,0)})}ISQ.Widget.LP.init(ISQ.Widget.Chat.Info);var chatResumed=false;if(ISQ.Widget.onloadQuestion||ISQ.Widget.onloadQuestionId||ISQ.Cnf.chatOpenInPopup){chatResumed=false}else{var obj=_session().restoreSessionFromCookie();if(!obj.result){chatResumed=false
}else{if(!obj.data||obj.data.length!=3){_session().logout();chatResumed=false}else{if(!obj.data[0]||obj.data[1]!==ISQ.Widget.LP.accountNumber()){_session().logout();chatResumed=false}else{ISQ.Widget.setUiLanguage(obj.data[2]);ISQ.Widget.Chat.requestChat(true);ISQ.Widget.Log.add("resuming chat");ISQ.Widget.Chat.pendingResumeSessionId=obj.data[0];chatResumed=true;if(ISQ.Cnf.chatPreChatSurvey&&typeof(ISQ.Widget.Survey)!="undefined"){ISQ.Widget.Survey.setReloadNextSubmission(true)}}}}}ISQ.Widget.LP.incomingLineHandler=new ISQ.Handler(ISQ.Widget.Chat.incomingLineHandler);ISQ.Widget.LP.chatStartedHandler=new ISQ.Handler(ISQ.Widget.Chat.chatStartedHandler);ISQ.Widget.LP.chatStoppedHandler=new ISQ.Handler(ISQ.Widget.Chat.chatStoppedHandler);ISQ.Widget.LP.agentTypingHandler=new ISQ.Handler(ISQ.Widget.Chat.agentTypingHandler);ISQ.Widget.Chat.intuitiveInput=new ISQ.GUI.IntuitiveInput({input:_("txtChatInput"),onTimeElapsedHandler:new ISQ.Handler(ISQ.Widget.Chat.chatInput_userTypes),enterKeyHandler:new ISQ.Handler(ISQ.Widget.Chat.chatInput_enterKeyup)});ISQ.Data.autoEllipseText(ISQ.Widget.getStaticText("closeChat"),69,_("closeChat"));_("btnSendChat").value=_("ancEmailChatSend").innerHTML=ISQ.Widget.getStaticText("sendChat");_("emailChatLink").innerHTML=ISQ.Widget.getStaticText("emailChat");_("ancEmailChatCancel").innerHTML=ISQ.Widget.getStaticText("cancel");return chatResumed};function repStateNotifyFunction(a){if(a==LPREPSTATEONLINE){ISQ.Widget.LP.isAvailable=true}}ISQ.Widget.Chat.providerAvailable=function(){if(ISQ.Widget.state===ISQ.Widget.enumState.chat&&ISQ.Widget.Chat.pendingResumeSessionId){ISQ.Widget.LP.resumeChat(ISQ.Widget.Chat.pendingResumeSessionId)}};ISQ.Widget.Chat.serverDetectionHandler=function(a){window.lpNumber=ISQ.Widget.Chat.Info.lpNumber;if(ISQ.Widget.Chat.Info.skill){window.lpSkill=ISQ.Widget.Chat.Info.skill}var b=(window.location.protocol==="https:"?"https:":"http:")+"//"+a+"/hcp/html/lpCheckRepState.js";ISQ.Tools.appendScript(b);window.lpServerName=a};ISQ.Widget.Chat.requestChat=function(d,b){if(typeof(b)==="undefined"){b=ISQ.Widget.enumChatEscalationActions.normal
}if((ISQ.Widget.state&ISQ.Widget.enumState.allChat)!==0){return false}ISQ.Widget.HTML.Mobile.hideAddressbar();ISQ.Widget.state=ISQ.Widget.enumState.chat;ISQ.Widget.Chat.resumingChat=d;ISQ.Widget.Chat.chatStartAction=b;if(ISQ.Cnf.chatOpenInPopup){var a="https://"+window.lpServerName+"/hc/"+ISQ.Widget.Chat.Info.lpNumber+"/?cmd=file&file=visitorWantsToChat&site="+ISQ.Widget.Chat.Info.lpNumber+"&byhref=1";if(ISQ.Widget.Chat.Info.skill){a+="&SV!skill="+ISQ.Widget.Chat.Info.skill}_("repByChat").href=a;var f,c;if(ISQ.Cnf.chatPopupSize){f=ISQ.Cnf.chatPopupSize[0];c=ISQ.Cnf.chatPopupSize[1]}else{f=800;c=600}var e=ISQ.Http.browser.app==="opera"?"yes":"no";ISQ.Tools.HTML.openPopup(a,"nanoRepLPChatWindow",f,c,e);ISQ.Widget.HTML.hideActionBar(function(){ISQ.Widget.state=ISQ.Widget.enumState.questions});ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.chat,ISQ.Widget.Chat.chatStartAction);return false}ISQ.Widget.HTML.searchWrapper.style.display="none";ISQ.Widget.HTML.answerPane.style.display="none";clearNode(ISQ.Widget.HTML.chatPane);ISQ.Widget.HTML.chatPane.style.display="block";ISQ.Widget.HTML.dynamicSize_sendMessage();if(!d&&ISQ.Cnf.chatPreChatSurvey){ISQ.Widget.state=ISQ.Widget.enumState.chatSurvey;ISQ.Widget.Survey.showLoadingAnim(ISQ.Widget.HTML.chatPane);ISQ.Widget.HTML.hideActionBar(function(){ISQ.Widget.HTML.actionBarQuery.style.display="none"});_session().requestPrechatSurvey(ISQ.Widget.Chat.Info.lpNumber,ISQ.Widget.Chat.Info.apiKey,ISQ.Widget.Survey.buildPreChatSurvey);ISQ.Widget.Log.add("Requesting pre-chat survey")}else{ISQ.Widget.HTML.actionBarQuery.style.display="none";ISQ.Widget.Chat.startChat(d?ISQ.Widget.enumChatStartStatus.resume:ISQ.Widget.enumChatStartStatus.normal)}};ISQ.Widget.Chat.startChat=function(a){ISQ.Widget.state=ISQ.Widget.enumState.chat;if(typeof(a)==="undefined"){a=ISQ.Widget.enumChatStartStatus.normal}if(a==ISQ.Widget.enumChatStartStatus.resume){ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("resumeChat")}else{ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("chatCalling")
}_("chatStatusWrapper").style.display="block";clearNode(_("chatPane"));if(!ISQ.Widget.Chat.resumingChat){ISQ.Widget.Chat.appendMyLine(_query(true))}ISQ.Widget.HTML.showActionBar();_("actionBarChat").style.display="block";_("footerChatLink").style.display="block";if(ISQ.Cnf.customerBrandingLogo){_("customerLogo").style.display="none"}if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.display="none"}ISQ.Widget.HTML.chatInputWrapper.style.display="block";if(ISQ.Http.browser.isIPhone){++document.body.scrollTop}ISQ.Widget.HTML.resizeHandler();switch(a){case ISQ.Widget.enumChatStartStatus.normal:ISQ.Widget.LP.requestChat();ISQ.Widget.LP.sendLine(_query(true));break;case ISQ.Widget.enumChatStartStatus.afterPreChatSurvey:ISQ.Widget.LP.sendLine(_query(true));break}_session().initOpenConnection();ISQ.Widget.HTML.dynamicSize_sendMessage();return true};ISQ.Widget.Chat.incomingLineHandler=function(c){var d=new Array();var a;switch(c.type){case"0":ISQ.Widget.Chat.appendMyLine(c.text);return;break;case"1":case"4":case"3":var b="chatLine_"+Math.floor(Math.random()*1000000);a=createDiv(null,".padded");a.id=b;d.push("<span class='chatAgentName'>");d.push(c.by);d.push(":</span> ");d.push(c.text);a.innerHTML=d.join("");ISQ.Widget.Chat.appendLine(a,b);if(!ISQ.Widget.Chat.chatStarted){break}_session().sendChatLine(ISQ.Widget.Chat.enumChatLineType.agent,c.text);break;case"2":var b="chatLine_"+Math.floor(Math.random()*1000000);a=createDiv(null,".padded chatSysMsg");a.id=b;a.innerHTML=c.text;ISQ.Widget.Chat.appendLine(a,b);break}};ISQ.Widget.Chat.saveCookie=function(){_session().saveSessionCookie([ISQ.Widget.Chat.sessionKey,ISQ.Widget.LP.accountNumber(),ISQ.Cnf.currentUiLanguage]);ISQ.Widget.Log.add("chat cookie saved")};ISQ.Widget.Chat.chatStartedHandler=function(a,b,c){if(!ISQ.Widget.Chat.resumingChat){ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.chat,ISQ.Widget.Chat.chatStartAction)}ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("chattingNow")+'<span class="chatStatusAgentName">'+b+"</span>";ISQ.Widget.Chat.sessionKey=c;
ISQ.Widget.Chat.chatStarted=true;if(ISQ.Http.browser.app==="opera"&&_session().state()===ISQ.Protocol.connectionStateEnum.CONNECTED){ISQ.Widget.Chat.saveCookie()}else{if(ISQ.Http.browser.isIE9){ISQ.Widget.HTML.contentWrapper.style.overflow="auto"}}if(ISQ.Widget.Chat.resumingChat){ISQ.Widget.HTML.scrollContentToBottom()}};ISQ.Widget.Chat.agentTypingHandler=function(a){if(!a){ISQ.Widget.HTML.chatStatus.className="agentTyping";ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("chattingNow")+'<span class="chatStatusAgentName">'+ISQ.Widget.LP.repName+"</span>"}else{ISQ.Widget.HTML.chatStatus.className="";ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.LP.repName+ISQ.Widget.getStaticText("chatTyping")}};ISQ.Widget.Chat.chatStoppedHandler=function(a){ISQ.Widget.HTML.chatStatus.innerHTML=ISQ.Widget.getStaticText("chatClosed");_("chatPane").innerHTML+=ISQ.Widget.getStaticText("chatClosed")+".<br/>";ISQ.Http.Cookies._delete(ISQ.Widget.Chat.cookieName,"/widget",ISQ.Http.domain(false),false)};ISQ.Widget.Chat.suggestionsDiv=null;ISQ.Widget.Chat.selectedSuggestedDivIndex=-1;ISQ.Widget.Chat.ignoreSendingLineOnEnter=false;ISQ.Widget.Chat.pendingSuggestions=null;ISQ.Widget.Chat.gotSuggestions=function(g){ISQ.Widget.Chat.hideSuggestionDiv();if(!g.xml){return}var l=g.xml.getElementsByTagName("Results");if(!l||l.length===0){return}l=l[0];var f=l.getAttribute("requestId");if(f!=ISQ.Widget.Query.activeRequestId){return}var o=l.getElementsByTagName("Topic");if(!o||o.length===0){return}var k=new Array();var n,a,m;for(var d=0;d<o.length;++d){n=o[d];m={};m.id=n.getAttribute("id");for(var e=0;e<n.childNodes.length;++e){a=n.childNodes[e];switch(a.nodeName){case"title":m.title=a.firstChild.nodeValue;break;case"Summary":m.summary=a.firstChild.nodeValue;break}}k.push(m)}ISQ.Widget.Chat.showSuggestionDiv();var b;for(var d=0;d<k.length;++d){b=createDiv(_("chatSuggestions"),".chatSuggestion");b.onmouseover=function(){this.innerHTML=this.innerHTML;this.className+=" chatSuggestionHover";ISQ.Widget.Chat.selectedSuggestedDivIndex=this.index
};b.onmouseout=function(){if(this.ignoreMouseout){return}this.className="chatSuggestion"};b.onclick=function(){ISQ.Widget.Chat.hideSuggestionDiv();ISQ.Widget.Chat.intuitiveInput.resetValue();ISQ.Widget.Chat.quickAnswerPicked(this.result.id,this.result.title,this.result.summary)};b.result=k[d];b.index=d;ISQ.Data.autoEllipseText(k[d].title,b.offsetWidth-20,b);ISQ.Widget.Chat.suggestionsDiv.push(b)}if(ISQ.Http.browser.isMobile){var c=ISQ.CSS.getElementHeight(_("chatSuggestions"),true);_("chatSuggestions").style.top=(-c)+"px"}};ISQ.Widget.Chat.showSuggestionDiv=function(){var a=_("chatSuggestions");a.style.display="block";ISQ.Widget.Chat.suggestionsDiv=new Array();document.onkeyup=function(d){var b=ISQ.Html.getDomEvent(d);if(b.domEvent.keyCode==40){var c;if(ISQ.Widget.Chat.selectedSuggestedDivIndex===ISQ.Widget.Chat.suggestionsDiv.length-1){return}if(ISQ.Widget.Chat.selectedSuggestedDivIndex!==-1){c=ISQ.Widget.Chat.suggestionsDiv[ISQ.Widget.Chat.selectedSuggestedDivIndex];c.ignoreMouseout=false;c.onmouseout()}++ISQ.Widget.Chat.selectedSuggestedDivIndex;ISQ.Widget.Chat.ignoreSendingLineOnEnter=true;c=ISQ.Widget.Chat.suggestionsDiv[ISQ.Widget.Chat.selectedSuggestedDivIndex];c.ignoreMouseout=true;c.onmouseover();return}else{if(b.domEvent.keyCode==38){var c;if(ISQ.Widget.Chat.selectedSuggestedDivIndex===-1){return}c=ISQ.Widget.Chat.suggestionsDiv[ISQ.Widget.Chat.selectedSuggestedDivIndex];c.ignoreMouseout=false;c.onmouseout();--ISQ.Widget.Chat.selectedSuggestedDivIndex;if(ISQ.Widget.Chat.selectedSuggestedDivIndex===-1){ISQ.Widget.Chat.ignoreSendingLineOnEnter=false;return}c=ISQ.Widget.Chat.suggestionsDiv[ISQ.Widget.Chat.selectedSuggestedDivIndex];c.ignoreMouseout=true;c.onmouseover();return}else{if(b.domEvent.keyCode==13){if(ISQ.Widget.Chat.selectedSuggestedDivIndex===-1){return}ISQ.Widget.Chat.suggestionsDiv[ISQ.Widget.Chat.selectedSuggestedDivIndex].onclick();return}}}};if(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6){ISQ.Widget.HTML.footerWrapper.style.display="none"}};ISQ.Widget.Chat.hideSuggestionDiv=function(){var a=_("chatSuggestions");
a.style.display="none";a.innerHTML="";ISQ.Widget.Chat.suggestionsDiv=null;ISQ.Widget.Chat.selectedSuggestedDivIndex=-1;ISQ.Widget.Chat.ignoreSendingLineOnEnter=false;document.onkeyup=null;if(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6){ISQ.Widget.HTML.footerWrapper.style.display="block"}};ISQ.Widget.Chat.chatInput_userTypes=function(b,a){ISQ.Widget.LP.userTyping(true);if(!a){return}_session().requestChatSuggestions(new ISQ.Handler(ISQ.Widget.Chat.gotSuggestions),b,++ISQ.Widget.Query.activeRequestId)};ISQ.Widget.Chat.chatInput_enterKeyup=function(){if(ISQ.Widget.Chat.ignoreSendingLineOnEnter){return false}ISQ.Widget.Chat.sendLine()};ISQ.Widget.Chat.quickAnswerPicked=function(b,d,c){ISQ.Widget.Chat.appendSuggestionsToGUI(d,c);var a=new Array();if(ISQ.Cnf.chatSendQuickAnswerBody===false){a.push("["+ISQ.Widget.getStaticText("quickAnswer")+"] ")}a.push(ISQ.Data.htmlDecode(d));ISQ.Widget.Chat.sendQuickAnswersToRep(a.join(""));if(ISQ.Cnf.chatSendQuickAnswerBody!==false){a=new Array();a.push("["+ISQ.Widget.getStaticText("quickAnswer")+"] ");a.push(ISQ.Data.htmlDecode(ISQ.Data.stripHtml(c)));ISQ.Widget.Chat.sendQuickAnswersToRep(a.join(""))}_session().sendChatLine(ISQ.Widget.Chat.enumChatLineType.quickAnswer,b)};ISQ.Widget.Chat.sendQuickAnswersToRep=function(c,b){if(c){if(ISQ.Cnf.chatShareQuickAnswersImmediatly!==false){ISQ.Widget.LP.sendLine(c)}else{if(!ISQ.Widget.Chat.pendingSuggestions){ISQ.Widget.Chat.pendingSuggestions=new Array()}ISQ.Widget.Chat.pendingSuggestions.push(c)}}else{if(b){if(ISQ.Widget.Chat.pendingSuggestions){for(var a=0;a<ISQ.Widget.Chat.pendingSuggestions.length;++a){ISQ.Widget.LP.sendLine(ISQ.Widget.Chat.pendingSuggestions[a])}ISQ.Widget.Chat.pendingSuggestions=null}}}};ISQ.Widget.Chat.sendLine=function(){ISQ.Widget.Chat.hideSuggestionDiv();var a=_("txtChatInput").value.Trim();if(!a){return}ISQ.Widget.Chat.intuitiveInput.resetValue();ISQ.Widget.Chat.sendQuickAnswersToRep(null,true);if(ISQ.Cnf.blockCreditCardNumbers){a=ISQ.Data.blockCreditCardNumbers(a,ISQ.Widget.ContactForm.blockedCreditCardReplacement)
}ISQ.Widget.LP.sendLine(a);ISQ.Widget.Chat.appendMyLine(a)};ISQ.Widget.Chat.appendSuggestionsToGUI=function(c,d){if(!d){return}d=ISQ.Data.getDBAnswerAsHtml(d,false,ISQ.Widget.Chat.appendLinksToNanoRepQuestions).text;var a="chatSDiv_"+ISQ.Widget.Query.activeRequestId;div=createDiv(null,".quickAnswer");div.id=a;var b=new Array();b.push("<div class='quickAnswerHeading'>");b.push(ISQ.Widget.getStaticText("quickAnswer"));b.push("</div> ");b.push("<table cellpadding='0' cellspacing='0'>");b.push("<tr valign='top' onclick='ISQ.Widget.Chat.toggleQuickAnswer(\""+ISQ.Widget.Query.activeRequestId+"\")' style='cursor:pointer'>");b.push("<td><div class='quickAnswerExpand' id='quickAnswerExpand_"+ISQ.Widget.Query.activeRequestId+"'></div></td>");b.push("<td class='quickAnswerTitle'>");b.push(c);b.push("<td></tr></table>");b.push("<div class='quickAnswerBody' id='quickAnswerBody_"+ISQ.Widget.Query.activeRequestId+"'>");b.push(d);b.push("</div>");div.innerHTML=b.join("");ISQ.Widget.Chat.appendLine(div,a)};ISQ.Widget.Chat.appendLinksToNanoRepQuestions=function(c,a,d){var b="linkToAnswer_"+(ISQ.Widget.Chat.linksToAnswersBaseId++);c.push("<a id='");c.push(b);c.push("' href='javascript:void(0)' onclick='ISQ.Widget.Chat.questionLinkClicked(this, \"");c.push(a);c.push("\")'>");c.push(d);c.push("</a>")};ISQ.Widget.Chat.questionLinkClicked=function(b,a){if(!ISQ.Widget.Chat.selectedLinksToAnswers){ISQ.Widget.Chat.selectedLinksToAnswers=new Array()}if(ISQ.Widget.Chat.selectedLinksToAnswers[b.id]===true){return}ISQ.Widget.Chat.selectedLinksToAnswers[b.id]=true;++ISQ.Widget.Query.activeRequestId;_session().getAnswerById(ISQ.Widget.Chat.questionLinkResponse,a,ISQ.Widget.Query.activeRequestId)};ISQ.Widget.Chat.questionLinkResponse=function(c){if((ISQ.Widget.state&ISQ.Widget.enumState.chat)===0){return}ISQ.Widget.Log.add("Chat question link response: Parsing answers");if(c.xml===null){ISQ.Widget.Log.add("Chat question link response: Illegal xml");return}var d=c.xml.getElementsByTagName("Results");if(d.length===0){ISQ.Widget.Log.add("Chat question link response: Illegal xml");
return}var e=d[0];var b=e.getAttribute("requestId");if(ISQ.Widget.Query.activeRequestId!=b){ISQ.Widget.Log.add("Chat question link response: Request Id doesn't match. sent: "+ISQ.Widget.Query.activeRequestId+", received: "+b);return}var h=e.getElementsByTagName("Topic");if(h.length===0){ISQ.Widget.Log.add("Chat question link response: no results");return}var g=h[0].getElementsByTagName("title")[0].firstChild.nodeValue;var f=h[0].getElementsByTagName("Summary")[0].firstChild.nodeValue;var a=h[0].getAttribute("id");ISQ.Widget.Chat.quickAnswerPicked(a,g,f)};ISQ.Widget.Chat.appendMyLine=function(d){if(!d){return}var c=new Array();var b="chatLine_"+Math.floor(Math.random()*1000000);var a=createDiv(null,".padded");a.id=b;c.push("<b>");c.push(ISQ.Widget.Localize.array.me);c.push(":</b> ");c.push(d);a.innerHTML=c.join("");ISQ.Widget.Chat.appendLine(a,b);if(ISQ.Widget.Chat.chatStarted){_session().sendChatLine(ISQ.Widget.Chat.enumChatLineType.user,d)}};ISQ.Widget.Chat.appendLine=function(d,c){var b=_("chatPane");var k=ISQ.Widget.HTML.contentWrapper;b.appendChild(d);ISQ.Widget.HTML.fixContentWidths();if(c){if(ISQ.Http.browser.isMobile){var e=ISQ.Html.position(c);var f=ISQ.Html.screenSize();f.h-=(ISQ.Widget.HTML.Mobile.incrementedBottom+50);var h=document.body.scrollTop;var a=h+f.h;var i=false;if(e.y<h||e.y>a){i=true}if(i){window.scrollTo(0,e.y)}}else{var g=b.scrollHeight;var j=k.offsetHeight;if(g>j){k.scrollTop=_(c).offsetTop-b.offsetTop}}}};ISQ.Widget.Chat.toggleQuickAnswer=function(c){var b=_("quickAnswerExpand_"+c);var a=_("quickAnswerBody_"+c);if(a.style.display==="none"){a.style.display="block";b.className="quickAnswerExpand"}else{a.style.display="none";b.className="quickAnswerExpand quickAnswerCollapsed"}};ISQ.Widget.Chat.endChat=function(b){if(!b&&!confirm(ISQ.Widget.Localize.array.confirmEndChat)){return}ISQ.Widget.LP.endChat();var a=!b&&(!_query(true)||!ISQ.Widget.userActive);ISQ.Widget.Chat.pendingSuggestions=null;ISQ.Widget.HTML.searchWrapper.style.display="block";_("chatStatusWrapper").style.display="none";if(!a){ISQ.Widget.HTML.answerPane.style.display="block"
}_("chatPane").style.display="none";ISQ.Widget.HTML.contentWrapper.scrollTop=0;if(!a){ISQ.Widget.HTML.showActionBar()}else{ISQ.Widget.HTML.hideActionBar(null,true)}_("actionBarChat").style.display="none";ISQ.Widget.HTML.actionBarQuery.style.display="block";_("footerChatLink").style.display="none";if(ISQ.Cnf.customerBrandingLogo){_("customerLogo").style.display="block"}if(ISQ.Cnf.customerBrandingText){_("customerBrandingText").style.display="block"}ISQ.Widget.HTML.chatInputWrapper.style.display="none";ISQ.Widget.HTML.resizeHandler();ISQ.Widget.HTML.dynamicSize_sendMessage();ISQ.Widget.state=ISQ.Widget.enumState.questions;_session().stopOpenConnection();ISQ.Widget.Chat.chatStarted=false;ISQ.Widget.Chat.emailChat_txtToggle(false);_session().chatEnded();if(!b){ISQ.Widget.Chat.openPostChatSurvey()}ISQ.Widget.Chat.sessionKey=""};ISQ.Widget.Chat.openPostChatSurvey=function(){if(ISQ.Cnf.chatPostChatSurveyPopup!==true||!ISQ.Widget.Chat.sessionKey){return}var a=typeof(lpChatConfig)!=="undefined"?lpChatConfig.lpServer:null;if(!a){return}var b=new Array();b.push("https://");b.push(a);b.push("/hc/");b.push(ISQ.Widget.Chat.Info.lpNumber);b.push("/?cmd=file&file=postChatSurveyContent&site=");b.push(ISQ.Widget.Chat.Info.lpNumber);b.push("&sessionkey=");b.push(ISQ.Widget.Chat.sessionKey);b=b.join("");_("closeChat").href=b;ISQ.Tools.HTML.openPopup(b,"nanoRepLPChatWindow",475,400,"yes")};ISQ.Widget.Chat.pageUnload=function(){if(!ISQ.Widget.LP.inChat){return}if(!_session().connected()){return}ISQ.Widget.Chat.saveCookie()};ISQ.Widget.Chat.emailChat_Show=function(){ISQ.Widget.HTML.txtEmailChat.defaultValue=ISQ.Widget.HTML.txtEmailChat.value=ISQ.Widget.Localize.array.enterEmail;ISQ.Widget.Chat.emailChat_txtToggle(true)};ISQ.Widget.Chat.emailChat_Hide=function(){ISQ.Widget.Chat.emailChat_txtToggle(false)};ISQ.Widget.Chat.emailChat_txtFocus=function(){if(ISQ.Widget.HTML.txtEmailChat.value==ISQ.Widget.HTML.txtEmailChat.defaultValue){ISQ.Widget.HTML.txtEmailChat.value=""}};ISQ.Widget.Chat.emailChat_txtBlur=function(){if(ISQ.Widget.HTML.txtEmailChat.value==""){ISQ.Widget.HTML.txtEmailChat.value=ISQ.Widget.HTML.txtEmailChat.defaultValue
}};ISQ.Widget.Chat.emailChat_txtToggle=function(a){if(ISQ.Cnf.chatHideSendToMail){_("emailChatLink").style.display="none";_("emailChatContainer").style.display="none";return}if(a){_("emailChatLink").style.display="none";_("emailChatContainer").style.display="block"}else{_("emailChatLink").style.display="block";_("emailChatContainer").style.display="none"}};ISQ.Widget.Chat.emailChat_Send=function(){if(ISQ.Cnf.chatHideSendToMail){return}var a=ISQ.Widget.HTML.txtEmailChat.value;if(!a){return}if(!ISQ.Data.checkString(a,"email")){alert(ISQ.Widget.Localize.array.emailValidation);return}ISQ.Widget.LP.emailChat(a);alert("Your chat transcript will be sent to your email address at the end of your chat.");ISQ.Widget.Chat.emailChat_txtToggle(false)};ISQ.Widget.enumCustomLinkTarget={CurrentPage:0,NewTab:1,Popup:2,Widget:3};ISQ.Widget.enumShowChatConfiguration={always:0,selectedAnswers:1,selectedAnswers_and_noAnswers:2};ISQ.Widget.enumChatEscalationActions={hide:0,normal:1,showChatOption:2,inviteChat:3,pushChat:4};ISQ.Widget.enumChatStartStatus={normal:0,resume:1,afterPreChatSurvey:2};ISQ.Widget.enumCustomLinkStats={none:0,countTicketEscalation:1,countChatEscalation:2};ISQ.Widget.enumKBCategoriesFlags={none:0,visibleInWidget:1,autoLearn:2,all:3};ISQ.Widget.API={};ISQ.Widget.API.customParams=null;ISQ.Widget.API.getCurrentURL=function(){return ISQ.Widget.referer.normal};ISQ.Widget.API.getCustomParams=function(){return ISQ.Widget.API.customParams||[]};ISQ.Widget.API.openContactForm=function(){ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.email)};ISQ.Widget.API.updateContext=function(d,b){var c=null;if(!b){c=_session().mContexts}if(!c||b===true){c=d}else{for(var a in d){c[a]=d[a]}}_session().setContext(c||[])};ISQ.Widget.API.reAsk=function(){ISQ.Widget.Query.timerElapsedHandler(_query(true),true)};</script>
    <script type="text/javascript">ISQ.Widget=initializeNS("ISQ.Widget");ISQ.API=initializeNS("ISQ.API");ISQ.Widget.supportsPostMessage=(typeof(window.postMessage)==="function"||typeof(window.postMessage)==="object");ISQ.Widget.getInnerFrameUrl=function(g,l,d){g=g||"CDCframe.html";var a=l.indexOf("://")+3;var f;var b;var e="";if(a!==2){f=l.indexOf("/",a);e=l.substring(0,a);b=l.substring(a,f)}else{f=l.indexOf("/");b=l.substring(0,f)}var h=g.indexOf("://")+3;var k;var i;var j="";if(h!==2){k=g.indexOf("/",h);j=g.substring(0,h);i=g.substring(h,k)}else{k=g.indexOf("/");i=g.substring(0,k)}if(e&&i===b){if(j!==e){return g.replace(j,e)}return g}else{if(d){if(i===ISQ.Http.domain()){return g}return""}}var c="";if(g.charAt(0)==="/"){c=e+b+g}else{if(h!==2){c=e+b+g.substring(k)}else{c=e+b+"/"+g}}return c};ISQ.Widget.extractDataFromScript=function(f){var e={};var g=document.getElementsByTagName("script");var h,a;for(var b=0;b<g.length;++b){h=g[b].getAttribute("src");if(!h){continue}if(!h.contains(f)){continue}if(!h.contains("nanorep.com")&&h.startsWith("http")){continue}var c=-1;if(h.startsWith("/")){c=window.location.href.indexOf("/",8);if(c===-1){e.serverUrl=window.location.href}else{e.serverUrl=window.location.href.substr(0,c)}}else{c=h.indexOf("/",8);if(c!==-1){e.serverUrl=h.substr(0,c)}}h=h.substring(h.indexOf("?")+1);a=ISQ.Tools.stringToPairArray(h,"=","&",true,false);e.cdcFrame=a.innerframeurl;if(!e.cdcFrame){e.cdcFrame=a.cdcframe}if(e.cdcFrame){e.cdcVersion=a.cdcversion;if(!e.cdcVersion){e.cdcVersion=1}e.cdcVersion=parseInt(e.cdcVersion)}e.account=a.account;var d=a.preview;if(d==="true"){e.preview=true;e.referer=a.referer}e.debug=a.debug||false;break}return e};ISQ.Widget.appendConfigurationsToIframeSource=function(a,b){a.push("?account=");a.push(b.account);if(b.preview){a.push("&preview=true")}if(b.conversionTag){a.push("&conversionTag=");a.push(b.conversionTag)}if(b.kb){a.push("&kb=");a.push(b.kb)}a.push("#doctype=");a.push(ISQ.Widget.doctype);a.push("&referer=");a.push(ISQ.Http.Cookies.encode64(b.referer));if(!ISQ.Widget.supportsPostMessage&&b.cdcFrame){a.push("&cdcFrame=");
a.push(ISQ.Widget.getInnerFrameUrl(b.cdcFrame,window.location.href));a.push("&cdcversion=");a.push(b.cdcVersion)}if(b.pageId){a.push("&pageId=");a.push(b.pageId)}if(b.searchDelay){a.push("&searchDelay=");a.push(b.searchDelay)}if(typeof(b.events)==="object"){a.push("&reportEvents=true")}if(b.debug){a.push("&debug=isq")}ISQ.Widget.appendCustomValuesToStringBuilder(a,b.customValues)};ISQ.Widget.appendCustomValuesToStringBuilder=function(c,a){if(!a){return}var d;for(var b in a){d=typeof(a[b]);if(d==="function"||d==="object"){continue}c.push("&");c.push(b);c.push("=");if(d==="string"){if(b==="onloadQuestionId"||b==="languageCode"){c.push(a[b])}else{c.push(ISQ.Http.Cookies.encode64(a[b]))}}else{c.push(a[b])}}};ISQ.Widget.downloadAndSendCNF=function(c,a){if(!ISQ.Widget.CNFStatus){ISQ.Widget.CNFStatus=[]}var b=ISQ.Widget.CNFStatus[c.id]={downloaded:false,waitingForDownload:false};if(c.useExistingCNF&&((c.id==="float"&&typeof(ISQ.Cnf_Float)==="object")||(c.id==="embed"&&typeof(ISQ.Cnf_Embed)==="object"))){if(!ISQ.Widget.supportsPostMessage){return false}c.useExistingCNF=false;b.downloaded=true;return true}ISQ.Widget.downloadCnf(c,function(){if(a){a()}if(!ISQ.Widget.supportsPostMessage){return}b.downloaded=true;if(!b.waitingForDownload){return}if(c.type==="float"){ISQ.Widget.sendCNFData(ISQ.Cnf_Float,c)}else{ISQ.Widget.sendCNFData(ISQ.Cnf_Embed,c)}});return ISQ.Widget.supportsPostMessage};ISQ.Widget.downloadCnf=function(e,a){var c=document.getElementsByTagName("head")[0];var b=createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src",ISQ.Widget.buildCNFSource(e.serverUrl,e.account,e.type==="float",e.kb,e.preview?escape(e.referer):null));b.async=true;b.defer=true;if(a){var d=function(){if(ISQ.Referer.handlerObjects[b.src].pendingLoad===true){return}a()};ISQ.Referer=initializeNS("ISQ.Referer");ISQ.Referer.handlerObjects=ISQ.Referer.handlerObjects||[];ISQ.Referer.handlerObjects[b.src]={callback:a};if(ISQ.Http.browser.app!=="ie"){b.onload=d}else{b.onreadystatechange=function(){if(this.readyState!=="complete"&&this.readyState!=="loaded"){return
}d();d=null}}}c.appendChild(b);return true};ISQ.Widget.buildCNFSource=function(f,a,b,c,e){var d=[];if(f){d.push(f)}d.push("/widget/scripts/cnf.js?account=");d.push(a);d.push("&key=");d.push(ISQ.Http.Cookies.encode64(ISQ.Http.domain(true,e?e:null)));if(e){d.push("&referer=");d.push(e)}if(b){d.push("&isFloat=true")}if(c){d.push("&kb=");d.push(c)}return d.join("")};ISQ.Widget.sendCNFData=function(b,f){var c=ISQ.Widget.CNFStatus[f.id];c.waitingForDownload=true;if(!c.downloaded){return}var d;for(var a in b){d=[];d.push("subject=cnf&command=");d.push(a);var e=typeof(b[a]);d.push("&value=");if(e==="string"){d.push(ISQ.Http.Cookies.encode64(b[a]))}else{d.push(b[a])}d.push("&type=");if(b[a] instanceof Array){d.push("array")}else{d.push(e)}f.cdcUser.sendMessage(d.join(""))}d=[];d.push("subject=cnf&command=finished");f.cdcUser.sendMessage(d.join(""))};ISQ.Widget.sendingMessagesToWidget=function(a){return ISQ.Widget.supportsPostMessage||a.formValues instanceof Array||typeof(a.context)==="object"||typeof(a.customParams)==="object"};ISQ.Widget.initCDC=function(d,b){if(ISQ.Widget.supportsPostMessage){d.cdcVersion=3}else{if(!d.cdcVersion){d.cdcVersion=0}}var c=ISQ.Widget.sendingMessagesToWidget(d);d.cdcUser=null;switch(d.cdcVersion){case 0:case 1:case 2:if(d.cdcVersion!==0){ISQ.Widget.cdcMessageEvent.addHandler(b,d)}if(c){d.cdcUser=new ISQ.CDC.User({targetWindowName:d.iframe.id,proxyIFrameUrl:d.serverUrl+"/common/cdc/cdc.html",server:d.serverUrl})}break;case 3:var a={allowMessagesFrom:d.serverUrl,widget:d.type};if(c){a.server=d.serverUrl;a.targetWindowName=d.iframe.id;a.proxyIFrameUrl=d.serverUrl+"/common/cdc/cdc.html"}d.cdcUser=new ISQ.CDC.User(a);d.cdcUser.incomingMessageEvent.addHandler(b,d);break}};ISQ.Widget.APIKeyEndDelimiter="<";ISQ.Widget.APIValueEndDelimiter="(";ISQ.Widget.sendAPItoWidget=function(l){var g=ISQ.Widget.sendingMessagesToWidget(l);if(!l.cdcUser||!g){return}var h=[];h.push("subject=api");var d=l.formValues;if((d instanceof Array)&&d.length!==0){h.push("&form=");var f,k,j;for(var e=0;e<d.length;++e){var c=d[e];
if(!(c instanceof Array)||c.length<2){continue}if(c.length===2){f=c[0];k=c[1];j=null}else{f=c[1];j=c[0];k=c[2]}if(e!==0){h.push(ISQ.Widget.APIKeyEndDelimiter)}h.push(ISQ.Http.Cookies.encode64(f));h.push(ISQ.Widget.APIValueEndDelimiter);h.push(ISQ.Http.Cookies.encode64(k));if(j){h.push(ISQ.Widget.APIValueEndDelimiter);h.push(ISQ.Http.Cookies.encode64(j))}}}var a=l.context;if(typeof(a)==="object"){h.push("&context=");ISQ.Widget.CDC_appendKeyValueToMessage(a,h)}var b=l.customParams;if(typeof(b)==="object"){h.push("&customparams=");ISQ.Widget.CDC_appendKeyValueToMessage(b,h)}l.cdcUser.sendMessage(h.join(""))};ISQ.Widget.CDC_getKeyValueArrayFromMessage=function(c){var b=[];var g=c.split(ISQ.Widget.APIKeyEndDelimiter);var f,a,e;for(var d=0;d<g.length;++d){f=g[d].split(ISQ.Widget.APIValueEndDelimiter);a=ISQ.Http.Cookies.decode64(f[0]);e=ISQ.Http.Cookies.decode64(f[1]);b[a]=e}return b};ISQ.Widget.CDC_appendKeyValueToMessage=function(a,d){var b=true;for(var c in a){if(!b){d.push(ISQ.Widget.APIKeyEndDelimiter)}b=false;d.push(ISQ.Http.Cookies.encode64(c));d.push(ISQ.Widget.APIValueEndDelimiter);d.push(ISQ.Http.Cookies.encode64(a[c]))}};ISQ.Widget.fixStealFocus=function(c){if(!c.iframe){return}var b=c.setFocus;if(!b){return}b=ISQ.Html._(b);if(!b){return}var a=function(){try{b.focus()}catch(d){}};if(window.attachEvent){c.iframe.attachEvent("onload",a)}else{if(window.addEventListener){c.iframe.addEventListener("load",a,true)}}};ISQ.Widget.resizeIframeOnLoad_IE=function(c,d,a,b){if(ISQ.Http.browser.app!=="ie"||document.readyState==="complete"){return false}if(ISQ.Http.browser.isIE6||ISQ.Http.browser.isIE7){if(!c.registeredOnload){c.registeredOnload=true;window.attachEvent("onload",function(){b(c,parseInt(d),parseInt(a)+1)})}}else{b(c,parseInt(d),parseInt(a)+1);c.cdcUser.sendMessage("subject=refreshSize")}return true};ISQ.Widget.incomingCDCMessageOrginizer=null;ISQ.Widget.incomingCDCMessage=function(f){if(f.charAt(0)==="?"){f=f.substr(1)}var g=ISQ.Tools.stringToPairArray(f,"=","&",true,false);if(!ISQ.Widget.incomingCDCMessageOrginizer){ISQ.Widget.incomingCDCMessageOrginizer=[]
}var a=ISQ.Widget.incomingCDCMessageOrginizer[g.widget];if(!a){a=ISQ.Widget.incomingCDCMessageOrginizer[g.widget]={};a.lastHandledOrdinal=0;a.pendingMessages=null}if(g.subject&&g.subject=="reset"){a.lastHandledOrdinal=0;a.pendingMessages=null}var k=parseInt(g.ord);var b=k-a.lastHandledOrdinal;if(b<=0){return}if(b>1){if(a.pendingMessages===null){a.pendingMessages=[];a.pendingMessagesCount=0}a.pendingMessages[k]=g;++a.pendingMessagesCount}else{try{ISQ.Widget.cdcMessageEvent.dispatch(g)}catch(c){}if(a.pendingMessages!==null){var j=a.pendingMessagesCount;var h=k+1;for(var d=0;d<j;++d,++h){if(!a.pendingMessages[h]){break}ISQ.Widget.cdcMessageEvent.dispatch(a.pendingMessages[h]);k=h;--a.pendingMessagesCount}if(a.pendingMessagesCount===0){a.pendingMessages=null}}a.lastHandledOrdinal=k}};if(!ISQ.Widget.cdcMessageEvent){ISQ.Widget.cdcMessageEvent=new ISQ.Event()}ISQ.Widget.handleCommonCDCMessage=function(a,b){switch(a.subject){case"cnf":if(b.id==="float"){ISQ.Widget.sendCNFData(ISQ.Cnf_Float,b)}else{ISQ.Widget.sendCNFData(ISQ.Cnf_Embed,b)}break;case"event":ISQ.Widget.handleEventMessage(a,b);break}};ISQ.Widget.detectDoctype=function(){var a="loose";try{var b=null;if(window.document.doctype){b=window.document.doctype.systemId;if(!b){b=window.document.doctype.publicId}if(!b&&window.document.doctype.name.toLowerCase()==="html"){b="doctype html"}}else{b=window.document.firstChild;if(b.innerHTML.length!==0){b=null}else{b=b.nodeValue}}if(b===null){a="nodoctype"}else{b=b.toLowerCase();if(b==="doctype html"||b==="ctype ht"){a="html5"}else{if(b.indexOf("xhtml")!==-1){a="xhtml"}else{if(b.indexOf("strict")!==-1){a="strict"}else{if(b.indexOf("loose")!==-1){a="loose"}else{if(b.indexOf("transitional")!==-1){if(b.indexOf("4.01")!==-1){a="transitional401"}else{if(b.indexOf("4.0")!==-1){a="transitional4"}else{a="transitional"}}}else{if(b.indexOf("frameset")!==-1){a="frameset"}else{a="nodoctype"}}}}}}}}catch(c){a="nodoctype"}return a};ISQ.Widget.doctype=ISQ.Widget.detectDoctype();ISQ.Widget.createMobileBlockerLink=function(e,c,f,d){if(!ISQ.Http.browser.isMobile){return
}var b=e.mobileBlockerLink=document.createElement("a");b.style.cssText="display:block;width: "+f+";height:"+e.height+"px;position:relative;left:0px;top:-"+e.height+"px;z-index:1001";c.appendChild(b);b.href=e.iframe.src;b.target="_blank";b.onclick=function(){e.cdcUser.sendMessage("subject=mobileOpenNewWindow")}};ISQ.API.init=function(a){ISQ.API.defaultCdcUser=a.cdcUser};ISQ.API.getCDCUser=function(a){var b=null;if(a){b=_nRepData[a]}if(b){return b.cdcUser}else{return ISQ.API.defaultCdcUser}};ISQ.API.openContactForm=function(b){var a=ISQ.API.getCDCUser(b);if(!a){return}a.sendMessage("subject=openContactForm")};ISQ.API.startChat=function(b,c){var a=ISQ.API.getCDCUser(c);if(!a){return}var d="subject=startChat";if(b){d+="&countStatsOnly=true"}a.sendMessage(d)};ISQ.API.ask=function(c,b){if(!c){return}var a=ISQ.API.getCDCUser(b);if(!a){return}a.sendMessage("subject=ask&question="+c)};ISQ.Widget.handleEventMessage=function(j,q){var o=j.type;var e,l;var n=3000;switch(o){case"query":if(!q.events){break}e=q.events[o];l=ISQ.Tools.Base64.decodeString(j.data);var h=j.isautoquestion=="true";if(e){if(h){e(l,true)}else{this.queryTimer=setTimeout(function(){e(l,false)},n)}if(false){if(typeof(lpMTagConfig)==="undefined"){return}if(typeof(lpMTagConfig.pageVar)==="undefined"){lpMTagConfig.pageVar=[]}lpMTagConfig.pageVar[lpMTagConfig.pageVar.length]="nanoRep_question="+l}}var k=q.events.query_noWait;if(k){k(l,h)}break;case"load":if(j.integrate_ga==="true"){var d=q.events;if(!d){d=q.events={}}var p=d.userActive;d.userActive=function(){if(typeof(_gaq)!=="undefined"){_gaq.push(["_trackEvent","nanoRep","nanoRep User Active"])}if(p){try{p()}catch(r){}}};var m=d.query;d.query=function(t,s){if(!s&&typeof(_gaq)!=="undefined"){_gaq.push(["_trackEvent","nanoRep","nanoRep Query",t])}if(m){try{m(t,s)}catch(r){}}};var g=d.incomingSearchResults;d.incomingSearchResults=function(s,t){if(s&&!t&&typeof(_gaq)!=="undefined"){_gaq.push(["_trackEvent","nanoRep","nanoRep Results Shown"])}if(g){try{g(s,t)}catch(r){}}};var b=d.escalation;d.escalation=function(t,s){if(typeof(_gaq)!=="undefined"){_gaq.push(["_trackEvent","nanoRep","nanoRep Escalation",s])
}if(b){try{b(t,s)}catch(r){}}};var i=d.like;d.like=function(t,r){if(typeof(_gaq)!=="undefined"){_gaq.push(["_trackEvent","nanoRep","nanoRep Like",r])}if(i){try{i(t,r)}catch(s){}}}}if(!q.events){break}e=q.events[o];if(e){e()}break;case"userstartedtyping":if(this.queryTimer){clearTimeout(this.queryTimer)}if(this.incomingSearchResultsTimer){clearTimeout(this.incomingSearchResultsTimer)}break;case"incomingsearchresults":if(!q.events){break}h=j.isautoquestion=="true";var f=j.hasresults==="true";e=q.events.incomingSearchResults;if(e){if(h){e(f,true)}else{this.incomingSearchResultsTimer=setTimeout(function(){e(f,false)},n)}}k=q.events.incomingSearchResults_noWait;if(k){k(f,h)}break;case"escalation":if(!q.events){break}e=q.events[o];if(!e){break}l=ISQ.Tools.Base64.decodeString(j.query);var c=j.esctype;e(c,l);break;case"like":if(!q.events){break}e=q.events[o];if(!e){break}l=ISQ.Tools.Base64.decodeString(j.query);var a=ISQ.Tools.Base64.decodeString(j.answer);e(l,a);break;case"useractive":if(!q.events){break}e=q.events.userActive;if(e){e()}break;case"directionchanged":if(!q.events){break}e=q.events.directionChanged;if(e){e(j.rtl==="true")}break}};ISQ.API.defaultCdcUser=null;</script>
    <script type="text/javascript">ISQ.Widget.Texts={en:{dir:"ltr",textAlign:"left",negativeTextAlign:"right",titleTeaserText:"Get Instant Answers:",titleNormalText:"Get Instant Answers:",loginError:"Oops... something went wrong. Please try again later",askNowLink:"Ask an Agent",chatNow:"Chat with an Agent",askBy:"Ask an Agent by:",email:"Email",chat:"Chat",newSearch:"New Search",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:" or ",searchMsgNOResults:"No results...  try a different phrasing or ask an agent.",wrongLogin:"Oops... something went wrong. Please try again",closeChat:"Close chat",sendBtn:"Send",like:"Like!",chatCalling:"An agent will be with you shortly...",chatTyping:" is typing...",chattingNow:"You are now chatting with ",chatJoined:" has joined the chat.",chatClosed:"Chat closed",resumeChat:"Chat resumed",quickAnswer:"Quick Answer:",sendChat:"Send",confirmEndChat:"This will end your chat session. Are you sure?",me:"Me",emailChat:"Email this chat transcript",enterEmail:"Enter Email",emailValidation:"Please enter a valid email address",cancel:"Cancel",back:"&lt; Back",translating:"Translating"},de:{dir:"ltr",textAlign:"left",negativeTextAlign:"right",titleTeaserText:"Bekommen Sie sofort Antworten:",titleNormalText:"Bekommen Sie sofort Antworten:",loginError:"Oops ... etwas schief gelaufen. Bitte versuchen Sie es spater erneut",askNowLink:"Stellen Sie eine Vertreterin",chatNow:"Diskutieren Sie mit einem Vertreter ",askBy:"Stellen Sie eine Vertreter von:",email:"Email",chat:"Chat",newSearch:"Neue Suche",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:" oder ",searchMsgNOResults:"Keine Ergebnisse...",wrongLogin:"Oops ... etwas schief gelaufen. Bitte versuchen Sie es erneut",closeChat:"Schlieen Sie Chat",sendBtn:"Senden",like:"Like!",chatCalling:"Ein Agent wird mit Ihnen in Krze ...",chatTyping:" ist die Eingabe ...",chattingNow:"Sie befinden sich jetzt im Chat mit ",chatJoined:" hat am Chat teil.",chatClosed:"Chat geschlossen",resumeChat:"Chat wieder aufgenommen",quickAnswer:"Quick Answer:",sendChat:"Senden",confirmEndChat:"Dies wird Ende Ihrer Sitzung chatten. Sind Sie sicher?",me:"Mir",emailChat:"Email this chat transcript",enterEmail:"Enter Email",emailValidation:"Please enter a valid email address",cancel:"Cancel",back:"&lt; Back",translating:"bersetzen"},fr:{dir:"ltr",textAlign:"left",negativeTextAlign:"right",titleTeaserText:"Obtenez des rponses instantanes:",titleNormalText:"Obtenez des rponses instantanes:",loginError:"Oups...  Il y a eu une erreur. Merci de bien vouloir essayer de nouveau.",askNowLink:"Demandez un Representant",chatNow:"Clavardez avec un reprsentant",askBy:"Demandez  un reprsentant par:",email:"Email",chat:"Chat",newSearch:"Nouvelle recherche",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:" ou ",searchMsgNOResults:"Pas de resultats...",wrongLogin:"Oups ... quelque chose n'allait pas. S'il vous plat essayer de nouveau",closeChat:"Fermer le Chat",sendBtn:"Envoyer",like:"Like!",chatCalling:"Un agent sera avec vous sous peu ...",chatTyping:" est saisissant ...",chattingNow:"Vous tes maintenant  discuter avec ",chatJoined:" a rejoint le chat.",chatClosed:"Chat ferm",resumeChat:"Chat reprise",quickAnswer:"Quick Answer:",sendChat:"Envoyer",confirmEndChat:"Cela mettra fin  votre session de chat. Etes-vous sr?",me:"Moi",emailChat:"Email this chat transcript",enterEmail:"Enter Email",emailValidation:"Please enter a valid email address",cancel:"Cancel",back:"&lt; Back",translating:"Traduire"},iw:{dir:"rtl",textAlign:"right",negativeTextAlign:"left",titleTeaserText:"  ?",titleNormalText:"  ?",loginError:"...  ,   ",askNowLink:" ",chatNow:"'  ",askBy:"  :",email:'"',chat:"'",newSearch:" ",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:"  ",searchMsgNOResults:" ...      ",wrongLogin:"...  ,   ",closeChat:" ",sendBtn:"",like:"",chatCalling:"   ..",chatTyping:" ...",chattingNow:"'  ",chatJoined:" / ",chatClosed:"' ",resumeChat:"' ",quickAnswer:" :",sendChat:"",confirmEndChat:(ISQ.Http.browser.app==="chrome"?"  /       ?":"?  /     "),me:"",emailChat:'  "',enterEmail:' "',emailValidation:'   " ',cancel:"",back:"&lt; ",translating:""},it:{dir:"ltr",textAlign:"left",negativeTextAlign:"right",titleTeaserText:"Avere risposte immediate:",titleNormalText:"Avere risposte immediate:",loginError:"Oops ... qualcosa a andato storto. Si prega di riprovare pi? tardi",askNowLink:"Chiedi ad un operatore",chatNow:"Chatta con un rappresentante",askBy:"Chiedere a un rappresentante da:",email:"Email",chat:"Chat",newSearch:"Nuova ricerca",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:" o ",searchMsgNOResults:"Nessun risultato...",wrongLogin:"Oops ... qualcosa a andato storto. Si prega di riprovare",closeChat:"Chiudi Chat",sendBtn:"Invia",like:"Like!",chatCalling:"Un agente sar con voi presto ...",chatTyping:" sta scrivendo ...",chattingNow:"Si  ora in chat con ",chatJoined:" si  unito alla chat.",chatClosed:"Chat chiuse",resumeChat:"Chat ripresa",quickAnswer:"Quick Answer:",sendChat:"Invia",confirmEndChat:"Questo porr fine alla sessione di chat. Sei sicuro?",me:"Io",emailChat:"Email this chat transcript",enterEmail:"Enter Email",emailValidation:"Please enter a valid email address",cancel:"Cancel",back:"&lt; Back",translating:"Tradurre"},nl:{dir:"ltr",textAlign:"left",negativeTextAlign:"right",titleTeaserText:"Krijg direct antwoord:",titleNormalText:"Krijg direct antwoord:",loginError:"Oeps ... ging er iets mis. Probeer het later opnieuw",askNowLink:"Vraagt een agent",chatNow:"Chat met een vertegenwoordiger",askBy:"Vraagt een agent:",email:"Email",chat:"Chat",newSearch:"nieuwe zoekopdracht",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:" of ",searchMsgNOResults:"Geen resultaten ...",wrongLogin:"Oeps ... ging er iets mis. Probeer het opnieuw",closeChat:"Sluiten Chat",sendBtn:"Stuur",like:"Like!",chatCalling:"Een agent zal met u binnenkort ...",chatTyping:" is aan het typen ...",chattingNow:"U bent nu chatten met ",chatJoined:" heeft zich aangesloten bij de chat.",chatClosed:"Chat gesloten",resumeChat:"Chat hervat",quickAnswer:"Quick Answer:",sendChat:"Stuur",confirmEndChat:"Dit zal uw chat-sessie. Ben je zeker?",me:"Ik",emailChat:"Email this chat transcript",enterEmail:"Enter Email",emailValidation:"Please enter a valid email address",cancel:"Cancel",back:"&lt; Back",translating:"Het vertalen van"},pt:{dir:"ltr",textAlign:"left",negativeTextAlign:"right",titleTeaserText:"Obter respostas instantneas:",titleNormalText:"Obter respostas instantneas:",loginError:"Oops... Deu erro. Tente novamente",askNowLink:"Pergunte a um Representante",chatNow:"Converse com um representante",askBy:"Pea a um representante por:",email:"Email",chat:"Chat",newSearch:"Nova Busca",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:" ou",searchMsgNOResults:"Sem resultado...",wrongLogin:"Oops... Deu erro. Tente novamente",closeChat:"Fechar Chat",sendBtn:"Enviar",like:"Like!",chatCalling:"Um agente estar com voc em breve ...",chatTyping:" est digitando ...",chattingNow:"Agora voc est conversando com ",chatJoined:" juntou-se ao bate-papo.",chatClosed:"Chat encerrada",resumeChat:"Chat retomada",quickAnswer:"Quick Answer:",sendChat:"Enviar",confirmEndChat:"Isso vai terminar a sua sesso de chat. Voc tem certeza?",me:"Eu",emailChat:"Email this chat transcript",enterEmail:"Enter Email",emailValidation:"Please enter a valid email address",cancel:"Cancel",back:"&lt; Back",translating:"Traduzindo"},es:{dir:"ltr",textAlign:"left",negativeTextAlign:"right",titleTeaserText:"Obtener inmediatamente respuestas:",titleNormalText:"Obtener inmediatamente respuestas:",loginError:"Uy ... algo salio mal. Por favor, intentalo de nuevo",askNowLink:"Preguntale a un representante",chatNow:"Habla con un representante",askBy:"Pida a un representante por:",email:"Email",chat:"Chat",newSearch:"Nueva busqueda",xmlObjectError:"Error parsing xml. unable to continue.",searchMsgResults:" o ",searchMsgNOResults:"No hay resultados...",wrongLogin:"Uy ... algo salio mal. Por favor, intentalo de nuevo",closeChat:"Cerrar Chat",sendBtn:"Enviar",like:"Like!",chatCalling:"Un agente estar con usted en breve ...",chatTyping:" est escribiendo ...",chattingNow:"Ahora est hablando con ",chatJoined:" se ha unido al chat.",chatClosed:"Chat cerrado",resumeChat:"Chat se reanuda",quickAnswer:"Quick Answer:",sendChat:"Enviar",confirmEndChat:"Esto terminar su sesin de chat. Est seguro?",me:"Yo",emailChat:"Email this chat transcript",enterEmail:"Enter Email",emailValidation:"Please enter a valid email address",cancel:"Cancelar",back:"&lt; Back",translating:"Traduccin"}};</script>
    <script type="text/javascript">ISQ.Widget=initializeNS("ISQ.Widget");ISQ.Widget.LP=initializeNS("ISQ.Widget.LP");ISQ.Widget.LP.apiKey="c774b56ff8a64cbba27743a8d4418b26";ISQ.Widget.LP.LINE_MAX_LENGTH=600;ISQ.Widget.LP.END_SENTENCE_MARKS=[".","!","?","\n"," "];ISQ.Widget.LP.reset=function(){if(ISQ.Widget.LP.inChat===true){ISQ.Widget.LP.mInstance.endChat()}ISQ.Widget.LP.isLoading=false;ISQ.Widget.LP.isAvailable=false;ISQ.Widget.LP.inChat=false;ISQ.Widget.LP.mInstance=null;ISQ.Widget.LP.waitingContent=new Array();ISQ.Widget.LP.repName="";ISQ.Widget.LP.resumingChat=false;ISQ.Widget.LP.agentFilter={};if(ISQ.Widget.LP.incomingLineHandler){ISQ.Widget.LP.incomingLineHandler.dispose()}ISQ.Widget.LP.incomingLineHandler=null;if(ISQ.Widget.LP.chatStartedHandler){ISQ.Widget.LP.chatStartedHandler.dispose()}ISQ.Widget.LP.chatStartedHandler=null;if(ISQ.Widget.LP.chatStoppedHandler){ISQ.Widget.LP.chatStoppedHandler.dispose()}ISQ.Widget.LP.chatStoppedHandler=null;if(ISQ.Widget.LP.agentTypingHandler){ISQ.Widget.LP.agentTypingHandler.dispose()}ISQ.Widget.LP.agentTypingHandler=null;if(ISQ.Widget.LP.chatAvailabilityHandler){ISQ.Widget.LP.chatAvailabilityHandler.dispose()}ISQ.Widget.LP.chatAvailabilityHandler=null};ISQ.Widget.LP.reset();ISQ.Widget.LP.init=function(a){if(ISQ.Widget.LP.mInstance||ISQ.Widget.LP.isLoading){if(typeof(ISQ.Widget.Log)!=="undefined"){ISQ.Widget.Log.add("LP was already initiated or during initiation")}return}ISQ.Widget.LP.isLoading=true;a.server=a.server||"server.iad.liveperson.net";window.lpChatConfig={apiKey:a.apiKey||ISQ.Widget.LP.apiKey,lpServer:a.server,lpNumber:a.lpNumber,skill:a.skill||null,onLoad:function(){if(typeof(ISQ.Widget.Log)!=="undefined"){ISQ.Widget.Log.add("Live Person loaded")}ISQ.Widget.LP.isLoading=false;ISQ.Widget.LP.mInstance=new lpChat();if(a.handler){a.handler.handle();a.handler.dispose();a.handler=null}if(!ISQ.Widget.LP.resumingChat){if(a.skill){ISQ.Widget.LP.agentFilter.skill=a.skill}if(typeof(a.maxWaitTime)==="string"&&!isNaN(parseInt(a.maxWaitTime))){ISQ.Widget.LP.agentFilter.maxWaitTime=a.maxWaitTime}else{if(typeof(a.maxWaitTime)==="number"){ISQ.Widget.LP.agentFilter.maxWaitTime=a.maxWaitTime+""
}}ISQ.Widget.LP.checkAvailability()}if(a.robustErrorHandler||a.serverDetectionHandler){var c=LPChatAPINS.lpConnLib.Process;var d=top;var b=true;LPChatAPINS.lpConnLib.Process=function(g){if(!b){return}if(top!==d){return}if(a.serverDetectionHandler){try{var h=g.ResultSet.lpData[0].lpServer;if(h){ISQ.Widget.Chat.Info.serverDetectionHandler.handle(h);ISQ.Widget.Chat.Info.serverDetectionHandler.dispose();ISQ.Widget.Chat.Info.serverDetectionHandler=null}}catch(f){}}else{if(a.robustErrorHandler){if(g.ResultSet.lpErrorDetail||g.ResultSet.lpCallError||g.ResultSet.lpErrorCode){b=a.robustErrorHandler.handle(g.ResultSet);if(!b){a.robustErrorHandler.dispose();a.robustErrorHandler=null}}}}if(!a.serverDetectionHandler&&!a.robustErrorHandler){LPChatAPINS.lpConnLib.Process=c}if(b){c.apply(LPChatAPINS.lpConnLib,[g])}}}},onInit:ISQ.Widget.LP.dummyMethod,onStart:ISQ.Widget.LP.onChatStarted,onStop:ISQ.Widget.LP.onChatStopped,onState:ISQ.Widget.LP.dummyMethod,onAgentTyping:ISQ.Widget.LP.onAgentTyping,onUrlPush:ISQ.Widget.LP.dummyMethod,onLine:ISQ.Widget.LP.onLine,onError:ISQ.Widget.LP.dummyMethod,onAvailability:ISQ.Widget.LP.onCheckAvailability,onResume:ISQ.Widget.LP.onResumeChat};(function(f,d){var b=lpChatConfig;if(typeof(b.lpProtocol)=="undefined"){b.lpProtocol=(document.location.toString().indexOf("https:")==0)?"https":"http"}if(typeof(f)=="undefined"||typeof(f)=="object"){f=b.lpChatSrc?b.lpChatSrc:"/hcp/html/lpChatAPI.js"}if(f.indexOf("http")!=0){f=b.lpProtocol+"://"+b.lpServer+f+"?site="+b.lpNumber}else{if(f.indexOf("site=")<0){if(f.indexOf("?")<0){f=f+"?"}else{f=f+"&"}f=f+"site="+b.lpNumber}}var e=document.createElement("script");e.setAttribute("type","text/javascript");e.setAttribute("charset","iso-8859-1");e.setAttribute("src",f);document.getElementsByTagName("head").item(0).appendChild(e)})()};ISQ.Widget.LP.dummyMethod=function(){};ISQ.Widget.LP.checkAvailability=function(){if(typeof(ISQ.Widget.Log)!=="undefined"){ISQ.Widget.Log.add("Checking availability")}window.lpChatConfig.onError=ISQ.Widget.LP.checkAvailabilityError;ISQ.Widget.LP.mInstance.chatAvailability(ISQ.Widget.LP.agentFilter)
};ISQ.Widget.LP.onCheckAvailability=function(a){if(typeof(ISQ.Widget.Log)!=="undefined"){ISQ.Widget.Log.add("Live Person availability="+a.availability)}if(ISQ.Widget.LP.chatAvailabilityHandler){ISQ.Widget.LP.chatAvailabilityHandler.handle(a);ISQ.Widget.LP.chatAvailabilityHandler.dispose();ISQ.Widget.LP.chatAvailabilityHandler=null}ISQ.Widget.LP.isAvailable=a.availability};ISQ.Widget.LP.checkAvailabilityError=function(){if(typeof(ISQ.Widget.Log)!=="undefined"){ISQ.Widget.Log.add("Live Person availability=ERROR")}if(ISQ.Widget.LP.apiValidityHandler){ISQ.Widget.LP.apiValidityHandler(false,arguments[0])}if(ISQ.Widget.LP.chatAvailabilityHandler){ISQ.Widget.LP.chatAvailabilityHandler.handle(availObj);ISQ.Widget.LP.chatAvailabilityHandler.dispose();ISQ.Widget.LP.chatAvailabilityHandler=null}ISQ.Widget.LP.isAvailable=false};ISQ.Widget.LP.sendingQueue=null;ISQ.Widget.LP.sendLine=function(c){if(!ISQ.Widget.LP.isAvailable){throw ("LP is not available")}if(!ISQ.Widget.LP.inChat){ISQ.Widget.LP.waitingContent.push(c);return}ISQ.Widget.LP.userTyping(false);var d=false;if(ISQ.Widget.LP.sendingQueue===null){d=true;ISQ.Widget.LP.sendingQueue=new Array()}ISQ.Widget.LP.addSegmentsToQueue(c);if(d){var b=0;var a=function(e){setTimeout(function(){ISQ.Widget.LP.mInstance.addLine(ISQ.Widget.LP.sendingQueue[e++]);ISQ.Widget.Log.add("sent");if(e!==ISQ.Widget.LP.sendingQueue.length){a(e)}else{ISQ.Widget.LP.sendingQueue=null}},20)};a(b)}};ISQ.Widget.LP.addSegmentsToQueue=function(l){var c=ISQ.Data.getURLencodedString(l);if(c.length<=ISQ.Widget.LP.LINE_MAX_LENGTH){ISQ.Widget.LP.sendingQueue.push(l);return}var k=0,d=ISQ.Widget.LP.LINE_MAX_LENGTH;var f=-1;while(d<c.length){d=Math.min(c.length,k+ISQ.Widget.LP.LINE_MAX_LENGTH);if(d!==c.length){var g=-1;var b=0;for(var e=0;e<ISQ.Widget.LP.END_SENTENCE_MARKS.length;e++){var a=ISQ.Data.getURLencodedString(ISQ.Widget.LP.END_SENTENCE_MARKS[e]);f=c.LastIndexOf(a,d);if(f<k){continue}if(f>g){g=f;b=a.length}}d=g+b}var j=c.substring(k,d);if(j.length>0){var h=ISQ.Data.getURLdecodedString(j);ISQ.Widget.LP.sendingQueue.push(h)
}k=d}};ISQ.Widget.LP.requestChat=function(){if(!ISQ.Widget.LP.isAvailable){handler.handle(false);return}window.lpChatConfig.onError=ISQ.Widget.LP.onChatError;window.lpChatConfig.onState=ISQ.Widget.LP.onChatStateChanged;ISQ.Widget.LP.mInstance.requestChat()};ISQ.Widget.LP.onChatStateChanged=function(a){switch(a){case 3:case 5:case 6:case 15:ISQ.Widget.LP.onChatStopped();break}};ISQ.Widget.LP.onChatError=function(a){ISQ.Widget.LP.inChat=false;ISQ.Widget.LP.waitingContent=new Array();if(ISQ.Widget.LP.resumingChat){ISQ.Widget.LP.isAvailable=false;ISQ.Widget.LP.resumingChat=false;ISQ.Widget.LP.checkAvailability()}ISQ.Widget.LP.chatStoppedHandler.handle(a);window.lpChatConfig.onError=null};ISQ.Widget.LP.onChatStarted=function(a,b){ISQ.Widget.LP.inChat=true;ISQ.Widget.LP.repName=b;ISQ.Widget.LP.chatStartedHandler.handle(a,b,ISQ.Widget.LP.mInstance.sessionkey);for(var c=0;c<ISQ.Widget.LP.waitingContent.length;++c){ISQ.Widget.LP.sendLine(ISQ.Widget.LP.waitingContent[c])}ISQ.Widget.LP.waitingContent=new Array()};ISQ.Widget.LP.onChatStopped=function(){if(!ISQ.Widget.LP.inChat){return}ISQ.Widget.LP.inChat=false;ISQ.Widget.LP.waitingContent=new Array();if(ISQ.Widget.LP.resumingChat){ISQ.Widget.LP.isAvailable=false;ISQ.Widget.LP.resumingChat=false;ISQ.Widget.LP.checkAvailability()}ISQ.Widget.LP.chatStoppedHandler.handle();window.lpChatConfig.onError=ISQ.Widget.LP.dummyMethod;window.lpChatConfig.onState=ISQ.Widget.LP.dummyMethod};ISQ.Widget.LP.onLine=function(a){ISQ.Widget.LP.incomingLineHandler.handle(a)};ISQ.Widget.LP.onResumeChat=function(){ISQ.Widget.LP.inChat=true;ISQ.Widget.LP.repName=ISQ.Widget.LP.mInstance.getAgentName();ISQ.Widget.LP.chatStartedHandler.handle(-1,ISQ.Widget.LP.repName,ISQ.Widget.LP.mInstance.sessionkey);for(var a=0;a<ISQ.Widget.LP.waitingContent.length;++a){ISQ.Widget.LP.sendLine(ISQ.Widget.LP.waitingContent[a])}};ISQ.Widget.LP.onAgentTyping=function(a){if(!ISQ.Widget.LP.inChat){return}ISQ.Widget.LP.agentTypingHandler.handle(a)};ISQ.Widget.LP.userTyping=function(a){if(!ISQ.Widget.LP.inChat){return}ISQ.Widget.LP.mInstance.setVisitorTyping(a)
};ISQ.Widget.LP.resumeChat=function(a){window.lpChatConfig.onError=ISQ.Widget.LP.onChatError;ISQ.Widget.LP.isAvailable=true;ISQ.Widget.LP.resumingChat=true;ISQ.Widget.LP.resumeChat_ready(a)};ISQ.Widget.LP.resumeRetries=0;ISQ.Widget.LP.resumeChat_ready=function(a){if(!ISQ.Widget.LP.resumingChat){return}if(typeof(lpChatConfig.useKeyParam)==="undefined"){if(++ISQ.Widget.LP.resumeRetries>=20){ISQ.Widget.LP.onChatError();return}setTimeout(function(){ISQ.Widget.LP.resumeChat_ready(a)},100);return}ISQ.Widget.LP.resumeRetries=0;ISQ.Widget.LP.mInstance.resumeChat(a)};ISQ.Widget.LP.endChat=function(){ISQ.Widget.LP.mInstance.endChat();ISQ.Widget.LP.inChat=false;ISQ.Widget.LP.waitingContent=new Array();window.lpChatConfig.onError=ISQ.Widget.LP.dummyMethod};ISQ.Widget.LP.emailChat=function(a){return ISQ.Widget.LP.mInstance.requestTranscriptEmail(a)};ISQ.Widget.LP.accountNumber=function(){return window.lpChatConfig.lpNumber};</script>
    <script type="text/javascript">ISQ.Widget=initializeNS("ISQ.Widget");ISQ.Widget.Survey=initializeNS("ISQ.Widget.Survey");ISQ.Widget.Survey.buildPreChatSurvey=function(response){ISQ.Widget.Survey.loadingAnim.dispose();if(!response||!response.xml){throw ("ISQ.Widget.Survey.buildPreChatSurvey: Invalid response received")}var node=response.xml.getElementsByTagName("result")[0];if(!node.getAttribute("chatRequestUrlBase")||node.getAttribute("success")!=="True"||!node.firstChild){ISQ.Widget.Log.add("Pre-chat survey unavailable. Starting chat normally");ISQ.Widget.Survey.destroy();ISQ.Widget.Chat.startChat();return}ISQ.Widget.Survey.chatRequestUrlBase=node.getAttribute("chatRequestUrlBase");ISQ.Widget.Survey.userIpAddress=node.getAttribute("userIpAddress");var survey=ISQ.Widget.Survey.survey=eval("("+node.firstChild.data+")").survey;var chatPane=clearNode(ISQ.Widget.HTML.chatPane);var container=ISQ.Widget.Survey.surveyContainer=createDiv(chatPane,".surveyContainer");ISQ.Widget.Survey.questions=[];ISQ.Widget.Survey.logicQuestions=[];var header=createDiv(container,".surveryHeading");header.innerHTML=survey.header;for(var i=0;i<survey.questions["question"].length;i++){var question=survey.questions["question"][i];ISQ.Widget.Survey.appendQuestion(question,container)}container.style.direction=ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage]["dir"];_("chatSurveySubmitButton").innerHTML=ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage]["sendBtn"];_("chatSurveyCloseButton").innerHTML=ISQ.Widget.Texts[ISQ.Cnf.initialUiLanguage]["cancel"];ISQ.Widget.HTML.fixContentWidths();if(ISQ.Widget.HTML.canPerformFade(container)){if(ISQ.Widget.Survey.fader===null){ISQ.Widget.Survey.fader=new VisualEffects.Fade(container);ISQ.Widget.Survey.fader.fadeOutEvent.addHandler(ISQ.Widget.Survey.fadeOutHandler);ISQ.Widget.Survey.fader.fadeInEvent.addHandler(ISQ.Widget.Survey.fadeInHandler)}ISQ.Widget.Survey.fader.setOpacity(0);ISQ.Widget.Survey.fader.fadeIn(200,true)}else{ISQ.Widget.Survey.fadeInHandler()}};ISQ.Widget.Survey.destroy=function(){_("actionBarChatSurvey").style.display="none";ISQ.Widget.Survey.surveyContainer=null;
ISQ.Widget.Survey.fader=null;ISQ.Widget.Survey.questions=null;ISQ.Widget.Survey.logicQuestions=null;ISQ.Widget.Survey.loadingAnim.dispose()};ISQ.Widget.Survey.fadeInHandler=function(){_("actionBarChatSurvey").style.display="block";ISQ.Widget.HTML.showActionBar();ISQ.Widget.HTML.dynamicSize_sendMessage()};ISQ.Widget.Survey.fadeOutHandler=function(){ISQ.Widget.Survey.destroy();ISQ.Widget.Chat.endChat(true)};ISQ.Widget.Survey.fadeOutReumeChatHandler=function(){ISQ.Widget.Survey.destroy();ISQ.Widget.Chat.startChat(ISQ.Widget.enumChatStartStatus.afterPreChatSurvey)};ISQ.Widget.Survey.appendQuestion=function(g,a){var j=createTable(a);var i=j.parentNode;i.setAttribute("cellPadding","3");var k,l;var f=g.mandatory;var c=g.label;var e=g.logicId;var d=ISQ.Widget.Survey.logicQuestions[e.toString()];var h={question:g,visible:true};h.row=i;if(d){var m=d.type;var b=d.element;i.style.display="none";h.visible=false;switch(m){case"Dropdown Box":b.parentNode.onchange=function(){var n=b.parentNode.value==b.value;ISQ.Widget.Survey.toggleLogicQuestion(i,n,h)};break;default:b.onclick=function(){ISQ.Widget.Survey.toggleLogicQuestion(i,this.checked,h)};break}}l=createRow(j,"","top");k=createTd(l,"","",".question");k.innerHTML=c+(f?'<span class="mandatory"> *</span>':"");k=createTd(l);ISQ.Widget.Survey.buildInput(g,k,h);if(c.toLowerCase().indexOf("name")>-1){h.labelHasName=true}ISQ.Widget.Survey.questions.push(h)};ISQ.Widget.Survey.buildInput=function(h,k,j){var l=h.type;var c=h.id;var e=h.lastKnownValue;var g=h.entry;var d;switch(l){case"Text Field":d=createInput("text","",k,e,".inputTxtError",".inputTxt");d.setAttribute("maxLength","40");j.input=d;break;case"Text Area":d=createElement("textarea",k,".inputTxt");d.value=e;j.input=d;break;case"Dropdown Box":d=createElement("select",k,".surveySelect");if(!g){break}for(var b=0;b<g.length;b++){var f=createElement("option",d);f.value=g[b]["value"];f.innerHTML=g[b]["value"];f.selected=g[b]["checked"];ISQ.Widget.Survey.addLogicQuestion(g[b],f,l)}j.input=d;break;case"Checkbox":if(!g){break}j.inputs=[];
for(var b=0;b<g.length;b++){var f=createCheckbox("","",k,g[b]["value"],"",g[b]["checked"]);f.value=g[b]["value"];j.inputs.push(f);ISQ.Widget.Survey.addLogicQuestion(g[b],f,l)}break;case"Radio Button (side by side)":case"Radio Button":if(!g){break}j.inputs=[];var a=(l==="Radio Button (side by side)"?"left":"");for(var b=0;b<g.length;b++){var f=createRadio("q_"+c,"",k,g[b]["value"],g[b]["value"],"",g[b]["checked"],a);j.inputs.push(f);ISQ.Widget.Survey.addLogicQuestion(g[b],f,l)}break}};ISQ.Widget.Survey.addLogicQuestion=function(c,a,e){if(c.logic&&c.logic["showLogicId"]){var d=c.logic["showLogicId"];var b={element:a,type:e};ISQ.Widget.Survey.logicQuestions[d]=b}};ISQ.Widget.Survey.toggleLogicQuestion=function(b,c,a){b.style.display=c?"block":"none";a.visible=c;if(c){ISQ.Widget.HTML.contentWrapper.scrollTop=b.offsetTop-ISQ.Widget.HTML.contentWrapper.offsetTop}};ISQ.Widget.Survey.showLoadingAnim=function(c){var a=createDiv(c,".surveyLoading");var b=createDiv(a,"float:left;").innerHTML="Please wait...";ISQ.Widget.Survey.loadingAnim=new ISQ.GUI.ProgressAnimation({container:createDiv(a,".searchAnim &float:left;")});ISQ.Widget.Survey.loadingAnim.show()};ISQ.Widget.Survey.validateSurvey=function(){var o=ISQ.Widget.Survey.questions;var b=false;var q=false;var m=false;var g;for(var d=0;d<o.length;d++){if(!o[d].visible){continue}var n=o[d].question;var e=o[d].input;var f=o[d].inputs;var p=o[d].row;var k=o[d].labelHasName;var r=n.type;var s=n.validationType;var l=n.mandatory;var a=false;if(e){g=e.value.Trim()}else{g=null}if(l){if(g===""){a=true}else{if(f){var c=false;for(var h=0;h<f.length;h++){if(f[h].checked){c=true;break}}a=!c}}}if((r==="Text Field"||r==="Text Area")&&g){switch(s){case"alpha_numeric":if(k&&!m){a|=g.indexOf('"')>-1|g.indexOf("'")>-1|g.indexOf("<")>-1|g.indexOf(">")>-1|g.indexOf(";")>-1;m=true}break;case"numeric":a|=!ISQ.Data.checkString(g,"number");break;case"email":a|=!ISQ.Data.checkString(g,"email");break}}if(a){p.className="validationError";b=true;if(!q){q=true;ISQ.Widget.HTML.contentWrapper.scrollTop=p.offsetTop-ISQ.Widget.HTML.contentWrapper.offsetTop
}}else{p.className=""}}return !b};ISQ.Widget.Survey.submitSurvey=function(){if(!ISQ.Widget.Survey.validateSurvey()){return}var k={survey:{id:ISQ.Widget.Survey.survey.id,question:[]}};for(var b in ISQ.Widget.Survey.questions){if(!ISQ.Widget.Survey.questions[b].visible){continue}var g=ISQ.Widget.Survey.questions[b].question;var c=ISQ.Widget.Survey.questions[b].input;var d=ISQ.Widget.Survey.questions[b].inputs;var h={id:g.id};if(c&&c.value){h.answer=c.value.Trim().replace(/\"/g,'\\"')}else{if(d){var a=[];for(var e in d){if(d[e].checked){a.push(d[e].value)}}if(a.length){h.answer=a}}}if(h.answer){k.survey.question.push(h)}}var f={};f.request={survey:k.survey,visitorIp:ISQ.Widget.Survey.userIpAddress};if(ISQ.Widget.Chat.Info.skill){f.request.skill=ISQ.Widget.Chat.Info.skill+""}_session().chatRequest(ISQ.Widget.Survey.chatRequestUrlBase,ISQ.Widget.Chat.Info.lpNumber,ISQ.Widget.Chat.Info.apiKey,ISQ.Widget.Survey.jsonToLPString(f),ISQ.Widget.Survey.submitSurvey_callback);ISQ.Widget.Survey.showLoadingAnim(clearNode(_("blockerContent")));_("widgetBlocker").style.display="block";if(ISQ.Http.browser.isIE7||ISQ.Http.browser.isIE6){_("widgetBlocker").style.height=ISQ.Widget.HTML.contentWrapper.offsetHeight}};ISQ.Widget.Survey.submitSurvey_callback=function(c){ISQ.Widget.Survey.loadingAnim.dispose();_("widgetBlocker").style.display="none";var b=ISQ.Data.Xml.getFirstElementByName(c.xml,"result");var e=b.getAttribute("success")==="True";var a=b.firstChild.nodeValue;if(!e){ISQ.Widget.Log.add("submitSurvey_callback error: "+a);ISQ.Widget.Survey.destroy();ISQ.Widget.Chat.startChat();ISQ.Widget.Survey.reloadNextSubmission=true;return}var d=a.substring(a.indexOf("chat/")+5).toUpperCase();ISQ.Widget.LP.resumeChat(d);ISQ.Widget.Survey.closeSurvey(true);if(ISQ.Widget.Survey.reloadNextSubmission){ISQ.Widget.Chat.sessionKey=d;ISQ.Widget.Chat.saveCookie();ISQ.Http.Cookies._write("resetcdc",1,"/widget",ISQ.Http.domain());setTimeout(function(){window.location.reload()},100)}ISQ.Widget.Survey.reloadNextSubmission=true};ISQ.Widget.Survey.closeSurvey=function(a){if(ISQ.Widget.HTML.canPerformFade(ISQ.Widget.Survey.surveyContainer)){if(a){ISQ.Widget.Survey.fader.fadeOutEvent.removeHandler(ISQ.Widget.Survey.fadeOutHandler);
ISQ.Widget.Survey.fader.fadeOutEvent.addHandler(ISQ.Widget.Survey.fadeOutReumeChatHandler)}ISQ.Widget.Survey.fader.fadeOut(100)}else{if(a){ISQ.Widget.Survey.fadeOutReumeChatHandler()}else{ISQ.Widget.Survey.fadeOutHandler()}}};ISQ.Widget.Survey.setReloadNextSubmission=function(a){ISQ.Widget.Survey.reloadNextSubmission=a};ISQ.Widget.Survey.jsonToLPString=function(d,e,c){if(!e){e=new Array()}if(d instanceof Array){e.push("[");for(var b=0;b<d.length;++b){if(b!==0){e.push(",")}ISQ.Widget.Survey.jsonToLPString(d[b],e,true)}e.push("]")}else{if(d===null){e.push("null")}else{if(typeof(d)==="object"){e.push("{");var a=true;for(var b in d){if(!a){e.push(",")}a=false;e.push('"');e.push(b);e.push('"');e.push(": ");ISQ.Widget.Survey.jsonToLPString(d[b],e,true)}e.push("}")}else{if(typeof(d)==="string"){e.push('"');e.push(d);e.push('"')}else{e.push(d)}}}}if(!c){return e.join("")}};ISQ.Widget.Survey.survey=null;ISQ.Widget.Survey.chatRequestUrlBase=null;ISQ.Widget.Survey.userIpAddress=null;ISQ.Widget.Survey.questions=null;ISQ.Widget.Survey.logicQuestions=null;ISQ.Widget.Survey.surveyContainer=null;ISQ.Widget.Survey.fader=null;ISQ.Widget.Survey.loadingAnim=null;ISQ.Widget.Survey.reloadNextSubmission=false;</script>
    <script type="text/javascript">ISQ.Translation=initializeNS("ISQ.Translation");ISQ.Translation.Infra={};ISQ.Translation.Infra.htmlDelimiter="<br/>";ISQ.Translation.Infra.arrayDelimiter=["<hr/>","<nanorep>",'<span class="notranslate"></span>'];ISQ.Translation.Infra.jobIdMarkerTag="idmarker";ISQ.Translation.Infra.contentTypeEnum={TEXT:0,HTML:1};ISQ.Translation.Infra.jobActionEnum={API_TRANSLATE:0};ISQ.Translation.Infra.workQueue;ISQ.Translation.Infra.slots;ISQ.Translation.Infra.enabled=true;ISQ.Translation.Infra.currentLanguageDetector=null;ISQ.Translation.Infra.detectorCounts=0;ISQ.Translation.Infra.lastJobId=0;ISQ.Translation.Infra.requestRetries=0;ISQ.Translation.Infra.canceledBatches=new Array();ISQ.Translation.Infra.providerEnum={GoogleV1:0,Microsoft:1,GoogleV2:2};ISQ.Translation.Infra.maxRequestCharacters=[1300,1300,1800];ISQ.Translation.Infra.provider=ISQ.Translation.Infra.providerEnum.GoogleV2;ISQ.Translation.Infra.googleApiLoaded=false;ISQ.Translation.Infra.apiKeys=null;ISQ.Translation.Infra.API_KEY_DELIMITER=";";ISQ.Translation.Infra.failureEvent=new ISQ.Event();ISQ.Translation.Infra.failureEnum={TranslationTimeout:0,TranslationApiFallback:1,DetectionTimeout:2,DetectionApiFallback:3,TranslationDead:4};ISQ.Translation.Infra.END_SENTENCE_MARKS=[".","!","?"," ",""];ISQ.Translation.Infra.CONCURRENT_JOBS=3;ISQ.Translation.Infra.MAX_REQUEST_ATTEMPTS=2;ISQ.Translation.Infra.REQUEST_TIMEOUT_MS=5000;ISQ.Translation.Infra.rtlLanguages={iw:true,ar:true,ur:true,yi:true,he:true};ISQ.Translation.Infra.jobStatusEnum={Created:0,Running:1,Canceled:2,Failed:3,TimedOut:4};ISQ.Translation.Infra.Job=ISQ.Base.extend({name:"ISQ.Translation.Infra.Job"});ISQ.Translation.Infra.Job.prototype.ctor=function(a){this.text=a.text;this.htmlTags=a.htmlTags||null;this.handler=a.handler;this.finalHandler=a.finalHandler||null;this.fromLanguage=a.fromLanguage||null;this.toLanguage=a.toLanguage||null;this.contentType=a.contentType||ISQ.Translation.Infra.contentTypeEnum.TEXT;this.tag=isNaN(a.tag)?null:a.tag;this.action=a.action||ISQ.Translation.Infra.jobActionEnum.API_TRANSLATE;
this.provider=a.provider||null;this.batchId=a.batchId;this.id=++ISQ.Translation.Infra.lastJobId;this.status=ISQ.Translation.Infra.jobStatusEnum.Created};ISQ.Translation.Infra.Job.prototype.dtor=function(){};ISQ.Translation.Infra.Job.prototype.clone=function(){var c=ISQ.Translation.Infra.extractJobIdFromText(this.text);var a=c.text;var b={text:a,htmlTags:this.htmlTags,handler:this.handler?new ISQ.Handler(this.handler.func,this.handler.context):null,finalHandler:this.finalHandler?new ISQ.Handler(this.finalHandler.func,this.finalHandler.context):null,fromLanguage:this.fromLanguage,toLanguage:this.toLanguage,contentType:this.contentType,tag:this.tag,action:this.action,provider:this.provider,batchId:this.batchId,status:this.status};return new ISQ.Translation.Infra.Job(b)};ISQ.Translation.Infra.Job.prototype.text=null;ISQ.Translation.Infra.Job.prototype.htmlTags=null;ISQ.Translation.Infra.Job.prototype.handler=null;ISQ.Translation.Infra.Job.prototype.finalHandler=null;ISQ.Translation.Infra.Job.prototype.fromLanguage=null;ISQ.Translation.Infra.Job.prototype.toLanguage=null;ISQ.Translation.Infra.Job.prototype.contentType=null;ISQ.Translation.Infra.Job.prototype.tag=null;ISQ.Translation.Infra.Job.prototype.action=null;ISQ.Translation.Infra.Job.prototype.id=null;ISQ.Translation.Infra.Job.prototype.status=null;ISQ.Translation.Infra.Job.prototype.provider=null;ISQ.Translation.Infra.Job.prototype.timer=null;ISQ.Translation.Infra.Job.prototype.batchId=null;ISQ.Translation.Infra.Slot=ISQ.Base.extend({name:"ISQ.Translation.Infra.Slot"});ISQ.Translation.Infra.Slot.prototype.ctor=function(a){this.id=a};ISQ.Translation.Infra.Slot.prototype.dtor=function(){};ISQ.Translation.Infra.Slot.prototype.getJob=function(){return this.mJob};ISQ.Translation.Infra.Slot.prototype.setJob=function(a){this.mJob=a};ISQ.Translation.Infra.Slot.prototype.id=null;ISQ.Translation.Infra.Slot.prototype.mJob=null;ISQ.Translation.Infra.Splitter=ISQ.Base.extend({name:"ISQ.Translation.Infra.Splitter"});ISQ.Translation.Infra.Splitter.prototype.ctor=function(a){this.segments=a.segments;
this.htmlTags=a.htmlTags;this.handler=a.handler;this.fromLanguage=a.fromLanguage||null;this.toLanguage=a.toLanguage||null;this.contentType=a.contentType||ISQ.Translation.Infra.contentTypeEnum.TEXT;this.translatedTexts=new Array();this.batchId=a.batchId};ISQ.Translation.Infra.Splitter.prototype.dtor=function(){};ISQ.Translation.Infra.Splitter.prototype.translateSegments=function(){for(var b=0;b<this.segments.length;b++){var a=new ISQ.Handler(this.translateSegmentsCallback,this);var c=new ISQ.Translation.Infra.Job({text:this.segments[b],contentType:ISQ.Translation.Infra.contentTypeEnum.TEXT,fromLanguage:this.fromLanguage,toLanguage:this.toLanguage,handler:a,tag:b,batchId:this.batchId});ISQ.Translation.Infra.enqueueAndProcess(c)}};ISQ.Translation.Infra.Splitter.prototype.translateSegmentsCallback=function(f,c){var b=c.tag;this.translatedTexts[b]=f;if(++this.mCounter<this.segments.length){return}var e=this.translatedTexts.join(" ");if(this.contentType==ISQ.Translation.Infra.contentTypeEnum.HTML){if(e.indexOf(ISQ.Translation.Infra.htmlDelimiter)===-1){var d;var a=ISQ.Translation.Infra.htmlDelimiter.replace(/\//g,"");d=new RegExp(a,"g");e=e.replace(d,ISQ.Translation.Infra.htmlDelimiter)}e=ISQ.Translation.Infra.unifyTagsAndText(this.htmlTags,e)}this.handler.handle(e)};ISQ.Translation.Infra.Splitter.prototype.segments=null;ISQ.Translation.Infra.Splitter.prototype.htmlTags=null;ISQ.Translation.Infra.Splitter.prototype.translatedTexts=null;ISQ.Translation.Infra.Splitter.prototype.handler=null;ISQ.Translation.Infra.Splitter.prototype.fromLanguage=null;ISQ.Translation.Infra.Splitter.prototype.toLanguage=null;ISQ.Translation.Infra.Splitter.prototype.contentType=null;ISQ.Translation.Infra.Splitter.prototype.mCounter=0;ISQ.Translation.Infra.Splitter.prototype.batchId=null;ISQ.Translation.Infra.Detector=ISQ.Base.extend({name:"ISQ.Translation.Infra.Detector"});ISQ.Translation.Infra.Detector.prototype.ctor=function(a){if(!a.string||a.string.length==0||a.string.length>ISQ.Translation.Infra.getMaxRequestCharacters()){throw ("ISQ.Translation.Infra.Detector.ctor: the string must not be empty and its length must be less than "+ISQ.Translation.Infra.getMaxRequestCharacters())
}if(ISQ.Translation.Infra.currentLanguageDetector){ISQ.Translation.Infra.currentLanguageDetector.dispose()}ISQ.Translation.Infra.currentLanguageDetector=this;this.handler=a.handler;this.requestId=ISQ.Translation.Infra.detectorCounts++;this.string=a.string;this.provider=ISQ.Translation.Infra.provider;this.detect()};ISQ.Translation.Infra.Detector.prototype.dtor=function(){clearTimeout(this.timer);if(!this.keepWindowFunction&&window["detectFunc"+this.requestId]){window["detectFunc"+this.requestId]=null}if(ISQ.Translation.Infra.currentLanguageDetector===this){ISQ.Translation.Infra.currentLanguageDetector=null}};ISQ.Translation.Infra.Detector.prototype.clone=function(){return{handler:this.handler?new ISQ.Handler(this.handler.func,this.handler.context):null,string:this.string,provider:this.provider}};ISQ.Translation.Infra.Detector.prototype.handler=null;ISQ.Translation.Infra.Detector.prototype.requestId=null;ISQ.Translation.Infra.Detector.prototype.provider=null;ISQ.Translation.Infra.Detector.prototype.timer=null;ISQ.Translation.Infra.Detector.prototype.keepWindowFunction=false;ISQ.Translation.Infra.Detector.prototype.detect=function(){var a=this;var b=a.requestId;this.timer=setTimeout(function(){ISQ.Translation.Infra.Detector.timedOut(a)},ISQ.Translation.Infra.REQUEST_TIMEOUT_MS);window["detectFunc"+a.requestId]=function(f){clearTimeout(a.timer);if(a!==ISQ.Translation.Infra.currentLanguageDetector){return}var e;if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV2){if(f.data){e=f.data["detections"][0][0]["language"]}else{if(f.error){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.Detector.detect error: "+f.error["errors"][0].domain+" "+f.error["errors"][0].reason+" "+f.error["errors"][0].message,ISQ.Widget.Log.statusEnum.RED)}ISQ.Translation.Infra.Detector.fallbackApiProvider(a);return}}}else{e=f}if(a.handler){a.handler.handle(e)}if(!a.isDisposed()){a.keepWindowFunction=false;a.dispose()}else{window["detectFunc"+b]=null}};if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV1&&!ISQ.Translation.Infra.googleApiLoaded){ISQ.Translation.Infra.Detector.fallbackApiProvider(this);
return}this.keepWindowFunction=true;if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV2){var d=new Array();d.push("https://www.googleapis.com/language/translate/v2/detect?callback=detectFunc");d.push(this.requestId);d.push("&key=");d.push(ISQ.Translation.Infra.apiKeys.GoogleV2);d.push("&q=");var c;if(this.string.contains("&")){c=this.string.replace(/&/g,"%26")}else{c=this.string}d.push(c);ISQ.Tools.appendScript(d)}else{if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV1){google.language.detect(this.string,function(e){if(e.error){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.Detector.detect error: "+e.error.message)}if(a.handler){a.handler.handle(null)}return}if(window["detectFunc"+a.requestId]){window["detectFunc"+a.requestId](e.language)}})}else{var d=new Array();d.push(location.protocol=="https:"?"https":"http");d.push("://api.microsofttranslator.com/V2/Ajax.svc/Detect?oncomplete=detectFunc");d.push(this.requestId);d.push("&appId=");d.push(ISQ.Translation.Infra.apiKeys.Microsoft);d.push("&text=");var c;if(this.string.contains("&")){c=this.string.replace(/&/g,"%26")}else{c=this.string}d.push(c);ISQ.Tools.appendScript(d)}}};ISQ.Translation.Infra.Detector.timedOut=function(b){if(b.provider!==ISQ.Translation.Infra.provider){return}if(++ISQ.Translation.Infra.requestRetries<=ISQ.Translation.Infra.MAX_REQUEST_ATTEMPTS){if(ISQ.Translation.Infra.requestRetries==1){ISQ.Translation.Infra.failureEvent.dispatch(ISQ.Translation.Infra.failureEnum.DetectionTimeout,ISQ.Translation.Infra.provider)}var a=b.clone();b.dispose();new ISQ.Translation.Infra.Detector(a);return}ISQ.Translation.Infra.Detector.fallbackApiProvider(b)};ISQ.Translation.Infra.Detector.fallbackApiProvider=function(b){if(!ISQ.Translation.Infra.enabled){return}if(ISQ.Translation.Infra.provider>0){ISQ.Translation.Infra.provider--;ISQ.Translation.Infra.requestRetries=0;ISQ.Translation.Infra.failureEvent.dispatch(ISQ.Translation.Infra.failureEnum.DetectionApiFallback,ISQ.Translation.Infra.provider);
if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("falling back API provider",ISQ.Widget.Log.statusEnum.RED)}var a=b.clone();b.dispose(true);new ISQ.Translation.Infra.Detector(a);return}ISQ.Translation.Infra.enabled=false;ISQ.Translation.Infra.failureEvent.dispatch(ISQ.Translation.Infra.failureEnum.TranslationDead);if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.Detector: Translation is completely dead",ISQ.Widget.Log.statusEnum.RED)}if(b.handler){b.handler.handle(null)}};ISQ.Translation.Infra.init=function(a){if(!a||!a.Microsoft||!a.GoogleV1){throw ("init: Invalid API keys provided.")}ISQ.Translation.Infra.apiKeys=a;ISQ.Translation.Infra.workQueue=new ISQ.Infra.Queue();ISQ.Translation.Infra.slots=new Array();for(var b=0;b<ISQ.Translation.Infra.CONCURRENT_JOBS;b++){var c=new ISQ.Translation.Infra.Slot(b);ISQ.Translation.Infra.slots.push(c)}if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV1){var d=new Array();d.push("https://www.google.com/jsapi?key=");d.push(ISQ.Translation.Infra.apiKeys.GoogleV1);d.push("&callback=ISQ.Translation.Infra.googleApiLoadedCallback");ISQ.Tools.appendScript(d)}};ISQ.Translation.Infra.translate=function(i,c,k,d,b,a){if(!ISQ.Base.isDerivedOf(d,ISQ.Handler)){throw ("ISQ.Translation.Infra.translate: invalid handler")}if(!k||k.length==0){throw ("ISQ.Translation.Infra.translate: toLanguage cannot be empty")}if(!i||i.length==0){return}if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.translate: adding to translation: "+i.substring(0,20),ISQ.Widget.Log.statusEnum.GREEN)}var e=new Array();if(b==ISQ.Translation.Infra.contentTypeEnum.HTML){var j=new Array();ISQ.Translation.Infra.stripHtmlIntoTagsAndText(i,e,j);i=j.join("")}if(ISQ.Data.getURLencodedString(i).length>ISQ.Translation.Infra.getMaxRequestCharacters()){var g=ISQ.Translation.Infra.splitTextToSegments(i);var h=new ISQ.Translation.Infra.Splitter({segments:g,htmlTags:e,contentType:b,fromLanguage:c,toLanguage:k,handler:d,batchId:a||null});h.translateSegments();return
}var f=new ISQ.Translation.Infra.Job({text:i,htmlTags:e,contentType:b,fromLanguage:c,toLanguage:k,handler:d,batchId:a||null});ISQ.Translation.Infra.enqueueAndProcess(f)};ISQ.Translation.Infra.translationCallback=function(i){var f;if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV2){f=i.data["translations"][0]["translatedText"];if(i.error){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.performTranslation error: "+i.error["errors"][0].message,ISQ.Widget.Log.statusEnum.RED)}ISQ.Translation.Infra.fallbackApiProvider();return}}else{f=i}var j=ISQ.Translation.Infra.extractJobIdFromText(f);var c=j.id;var l=j.text;var e=ISQ.Translation.Infra.getJobAndSlotById(c);if(e===null){return}var d=e.job;var k=e.slot;clearTimeout(d.timer);if(d.action==ISQ.Translation.Infra.jobActionEnum.API_TRANSLATE&&d.contentType==ISQ.Translation.Infra.contentTypeEnum.HTML){l=ISQ.Translation.Infra.unifyTagsAndText(d.htmlTags,l)}else{var g=l;l=ISQ.Data.htmlDecode(l);var a=ISQ.Translation.Infra.arrayDelimiter[this.provider];if(g.indexOf(a)>-1&&l.indexOf(a)==-1){var b=ISQ.Data.htmlDecode(a);var h=new RegExp(b,"g");l=l.replace(h,a)}}k.setJob(null);if(d.status==ISQ.Translation.Infra.jobStatusEnum.Running){d.handler.handle(l,d)}d.dispose();setTimeout(ISQ.Translation.Infra.proccessQueue,0)};ISQ.Translation.Infra.translateArray=function(a,g,j,h,e,b){if(!ISQ.Base.isDerivedOf(h,ISQ.Handler)){throw ("ISQ.Translation.Infra.translate: invalid handler")}if(!j||j.length==0){throw ("ISQ.Translation.Infra.translate: toLanguage cannot be empty")}if(!a||a.length==0){return}var f=ISQ.Translation.Infra.arrayDelimiter[ISQ.Translation.Infra.provider];var c=a.join(f);var i={handler:h,provider:ISQ.Translation.Infra.provider};var d=new ISQ.Handler(ISQ.Translation.Infra.translateArrayCallback,i);ISQ.Translation.Infra.translate(c,g,j,d,e,b)};ISQ.Translation.Infra.translateArrayCallback=function(h,d){var c=this.handler;var f=this.provider;var a=ISQ.Translation.Infra.arrayDelimiter[f];var b=ISQ.Data.unHTML(a);var g=new RegExp(b,"g");
h=h.replace(g,a);var e=h.split(a);c.handle(e)};ISQ.Translation.Infra.performTranslation=function(b){if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV2){var c=new Array();c.push("https://www.googleapis.com/language/translate/v2?callback=ISQ.Translation.Infra.translationCallback");c.push("&key=");c.push(ISQ.Translation.Infra.apiKeys.GoogleV2);if(b.fromLanguage){c.push("&source=");c.push(b.fromLanguage)}c.push("&target=");c.push(b.toLanguage);c.push("&q=");c.push(escape(b.text));ISQ.Tools.appendScript(c)}else{if(ISQ.Translation.Infra.provider===ISQ.Translation.Infra.providerEnum.GoogleV1){var a=b.fromLanguage||"";google.language.translate(b.text,a,b.toLanguage,function(d){if(d.error){if(d.error.message.toLowerCase().indexOf("detect source language")>-1){ISQ.Translation.Infra.translationCallback(b.text);return}if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.performTranslation error: "+d.error.message,ISQ.Widget.Log.statusEnum.RED)}ISQ.Translation.Infra.fallbackApiProvider();return}ISQ.Translation.Infra.translationCallback(d.translation)})}else{var c=new Array();c.push(location.protocol=="https:"?"https":"http");c.push("://api.microsofttranslator.com/V2/Ajax.svc/Translate?oncomplete=ISQ.Translation.Infra.translationCallback&appId=");c.push(ISQ.Translation.Infra.apiKeys.Microsoft);if(b.fromLanguage){c.push("&from=");c.push(ISQ.Translation.Infra.setMicrosoftLangCode(b.fromLanguage))}c.push("&to=");c.push(ISQ.Translation.Infra.setMicrosoftLangCode(b.toLanguage));c.push("&text=");c.push(ISQ.Data.getURLencodedString(b.text));ISQ.Tools.appendScript(c)}}};ISQ.Translation.Infra.proccessQueue=function(){var b=ISQ.Translation.Infra.getFreeSlot();if(!b){return}var a=null;while(true){a=ISQ.Translation.Infra.workQueue.dequeue();if(!a){return}if(ISQ.Translation.Infra.disposeJobIfBatchIsCanceled(a)){continue}break}if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.proccessQueue: found job!",ISQ.Widget.Log.statusEnum.GREEN)}ISQ.Translation.Infra.addJobIdMarker(a);
b.setJob(a);a.timer=setTimeout(function(){ISQ.Translation.Infra.jobTimedOut(a)},ISQ.Translation.Infra.REQUEST_TIMEOUT_MS);a.status=ISQ.Translation.Infra.jobStatusEnum.Running;a.provider=ISQ.Translation.Infra.provider;ISQ.Translation.Infra.performTranslation(a)};ISQ.Translation.Infra.jobTimedOut=function(a){a.status=ISQ.Translation.Infra.jobStatusEnum.TimedOut;if(a.provider!==ISQ.Translation.Infra.provider){return}if(++ISQ.Translation.Infra.requestRetries<=ISQ.Translation.Infra.MAX_REQUEST_ATTEMPTS){var b=ISQ.Translation.Infra.getJobAndSlotById(a.id);var d=b.slot;d.setJob(null);var c=a.clone();a.dispose();if(ISQ.Translation.Infra.requestRetries==1){ISQ.Translation.Infra.failureEvent.dispatch(ISQ.Translation.Infra.failureEnum.TranslationTimeout,ISQ.Translation.Infra.provider)}ISQ.Translation.Infra.enqueueAndProcess(c);return}ISQ.Translation.Infra.fallbackApiProvider()};ISQ.Translation.Infra.fallbackApiProvider=function(){if(!ISQ.Translation.Infra.enabled){return}if(ISQ.Translation.Infra.provider>0){ISQ.Translation.Infra.provider--;ISQ.Translation.Infra.requestRetries=0;if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("falling back API provider",ISQ.Widget.Log.statusEnum.RED)}for(var a=0;a<ISQ.Translation.Infra.CONCURRENT_JOBS;a++){var d=ISQ.Translation.Infra.slots[a];var b=d.getJob();if(!b){continue}var c=b.clone();b.dispose();d.setJob(c);ISQ.Translation.Infra.workQueue.priorityEnqueue(c)}ISQ.Translation.Infra.failureEvent.dispatch(ISQ.Translation.Infra.failureEnum.TranslationApiFallback,ISQ.Translation.Infra.provider);setTimeout(ISQ.Translation.Infra.proccessQueue,0);return}ISQ.Translation.Infra.enabled=false;ISQ.Translation.Infra.failureEvent.dispatch(ISQ.Translation.Infra.failureEnum.TranslationDead);if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra: Translation is completely dead",ISQ.Widget.Log.statusEnum.RED)}};ISQ.Translation.Infra.enqueueAndProcess=function(a){ISQ.Translation.Infra.workQueue.enqueue(a);setTimeout(ISQ.Translation.Infra.proccessQueue,0)};ISQ.Translation.Infra.addJobIdMarker=function(a){var b=new Array();
b.push("<");b.push(ISQ.Translation.Infra.jobIdMarkerTag);b.push(a.id);b.push(">");b.push(a.text);a.text=b.join("")};ISQ.Translation.Infra.extractJobIdFromText=function(k){var d;var g=k.toLowerCase();var j=g.indexOf("<"+ISQ.Translation.Infra.jobIdMarkerTag);if(j===-1){j=g.indexOf("< "+ISQ.Translation.Infra.jobIdMarkerTag)}if(j===-1){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.extractJobIdFromText: Couldnt parse jobIdMarker from text! "+k,ISQ.Widget.Log.statusEnum.RED)}return{id:-1,text:k}}var b=k.indexOf(">",j);if(b===-1){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.extractJobIdFromText: jobIdMarker tag is invalid!",ISQ.Widget.Log.statusEnum.RED)}return{id:-1,text:k}}b+=1;var h=g.substring(j,b);var e=h.indexOf(ISQ.Translation.Infra.jobIdMarkerTag);if(e===-1){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.extractJobIdFromText: jobIdMarker tag is invalid!",ISQ.Widget.Log.statusEnum.RED)}return{id:-1,text:k}}e+=ISQ.Translation.Infra.jobIdMarkerTag.length;var f="";var a;do{if(e>h.length){break}a=h.charAt(e++);if(a.charCodeAt(0)<48||a.charCodeAt(0)>57){break}f+=a}while(true);d=parseInt(f);if(isNaN(d)){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("ISQ.Translation.Infra.extractJobIdFromText: jobIdMarker tag is invalid: could not parse id#",ISQ.Widget.Log.statusEnum.RED)}return{id:-1,text:k}}var i;if(j===0){i=k.substring(b)}else{i=k.substring(0,j);if(b<k.length){i+=k.substring(b)}}return{id:d,text:i}};ISQ.Translation.Infra.getJobAndSlotById=function(b){for(var a=0;a<ISQ.Translation.Infra.CONCURRENT_JOBS;a++){var d=ISQ.Translation.Infra.slots[a];var c=d.getJob();if(c&&c.id===b){return{job:c,slot:d}}}return null};ISQ.Translation.Infra.getFreeSlot=function(){for(var a=0;a<ISQ.Translation.Infra.CONCURRENT_JOBS;a++){var b=ISQ.Translation.Infra.slots[a];if(b.getJob()==null){return b}}return null};ISQ.Translation.Infra.disposeJobIfBatchIsCanceled=function(a){if(!a||!a.batchId||isNaN(a.batchId)){return false}var b=a.batchId+"";var c=ISQ.Translation.Infra.canceledBatches[b];
if(!c){return false}ISQ.Translation.Infra.canceledBatches[b]=null;delete ISQ.Translation.Infra.canceledBatches[b];if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("translations infra: disposing job that was canceled: "+a.text,ISQ.Widget.Log.statusEnum.GREEN)}a.dispose();return true};ISQ.Translation.Infra.addBatchToCancelList=function(a){if(!a||isNaN(a)){return}ISQ.Translation.Infra.canceledBatches[a+""]=true};ISQ.Translation.Infra.splitTextToSegments=function(m){var j=new Array();var b=ISQ.Data.getURLencodedString(m);var g=ISQ.Translation.Infra.getMaxRequestCharacters();if(b.length<=g){j.push(m);return j}var l=0,c=g;var e=-1;while(c<b.length){c=Math.min(b.length,l+g);var f=e;for(var d=0;d<ISQ.Translation.Infra.END_SENTENCE_MARKS.length;d++){var a=ISQ.Data.getURLencodedString(ISQ.Translation.Infra.END_SENTENCE_MARKS[d]);e=b.LastIndexOf(a,c);if(e>f){c=e+a.length;break}}var k=b.substring(l,c);if(k.length>0){var h=ISQ.Data.getURLdecodedString(k);j.push(h)}l=c}return j};ISQ.Translation.Infra.stripHtmlIntoTagsAndText=function(d,j,k){var i=0;var g=d.indexOf("<");if(g===-1){k.push(ISQ.Data.htmlDecode(d));return}var c=-1;var e=0;var f=-1;while(true){if(e!==g){var h=g==-1?d.length:g;if(k.length!==0){k.push(ISQ.Translation.Infra.htmlDelimiter)}k.push(ISQ.Data.htmlDecode(d.substring(e,h)));j.push("{");j.push(i++);j.push("}")}if(g==-1){break}f=g;if(d.substr(g+1,4).toLowerCase()==="code"){var a=g-1;var c=d.indexOf("</code>",a)+7;if(c===-1){e=c=d.length;g=-1}else{e=c;g=d.indexOf("<",e)}var b=d.substring(a+1,c);j.push(b)}else{var c=d.indexOf(">",g+1);if(c===-1){break}j.push(d.substring(g,++c));e=c;g=d.indexOf("<",e)}}};ISQ.Translation.Infra.unifyTagsAndText=function(d,e){if(!d||d.length==0){return e}var b=d.join("");var c=e.split(ISQ.Translation.Infra.htmlDelimiter);for(var a=0;a<c.length;a++){b=b.replace("{"+a+"}",ISQ.Data.htmlDecode(c[a]))}return b};ISQ.Translation.Infra.getLanguageDirection=function(a){return ISQ.Translation.Infra.rtlLanguages[a]==null?"ltr":"rtl"};ISQ.Translation.Infra.googleApiLoadedCallback=function(){google.load("language","1",{callback:ISQ.Translation.Infra.googleLanguageLoaded})
};ISQ.Translation.Infra.googleLanguageLoaded=function(){ISQ.Translation.Infra.googleApiLoaded=true};ISQ.Translation.Infra.getProviderName=function(a){return ISQ.Tools.getEnumValue(ISQ.Translation.Infra.providerEnum,a)};ISQ.Translation.Infra.getMaxRequestCharacters=function(){return ISQ.Translation.Infra.maxRequestCharacters[ISQ.Translation.Infra.provider]};ISQ.Translation.Infra.MicrosoftLanguageCodes={iw:"he",zh:"zh-CHS"};ISQ.Translation.Infra.setMicrosoftLangCode=function(a){return ISQ.Translation.Infra.MicrosoftLanguageCodes[a]||a};</script>
    <script type="text/javascript">ISQ.Translation=initializeNS("ISQ.Translation");ISQ.Translation.Service={};ISQ.Translation.Service.CachedTranslator=ISQ.Base.extend({name:"ISQ.Translation.Service.CachedTranslator"});ISQ.Translation.Service.CachedTranslator.prototype.ctor=function(a){if(!a.textsArray||a.textsArray.length==0){return}if(!ISQ.Base.isDerivedOf(a.handler,ISQ.Handler)){throw ("ISQ.Translation.Service.CachedTranslator.ctor: invalid handler")}this.textsArray=a.textsArray;this.handler=a.handler;this.fromLanguage=a.fromLanguage||null;this.toLanguage=a.toLanguage;this.translate()};ISQ.Translation.Service.CachedTranslator.prototype.dtor=function(){};ISQ.Translation.Service.CachedTranslator.prototype.textsArray=null;ISQ.Translation.Service.CachedTranslator.prototype.handler=null;ISQ.Translation.Service.CachedTranslator.prototype.fromLanguage=null;ISQ.Translation.Service.CachedTranslator.prototype.toLanguage=null;ISQ.Translation.Service.CachedTranslator.prototype.translationsArray=null;ISQ.Translation.Service.CachedTranslator.prototype.failuresArray=null;ISQ.Translation.Service.CachedTranslator.prototype.translate=function(){new ISQ.Translation.Service.ServerDictionary({language:this.toLanguage,handler:new ISQ.Handler(this.serverDictionaryLookupComplete,this),textsArray:this.textsArray})};ISQ.Translation.Service.CachedTranslator.prototype.serverDictionaryLookupComplete=function(f,c){if(c.length==0){var a=new Array();for(var d=0;d<f.length;d++){a.push(f[d].text)}this.handler.handle(a);a=null;this.dispose();return}this.translationsArray=f;this.failuresArray=c;try{return ISQ.Translation.Infra.translateArray(c,this.fromLanguage,this.toLanguage,new ISQ.Handler(this.translationsApiCallback,this),null,this.queryId)}catch(b){if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("serverDictionaryLookupComplete ERROR: "+b,ISQ.Component.Log.statusEnum.RED)}}};ISQ.Translation.Service.CachedTranslator.prototype.translationsApiCallback=function(f){var b=new Array();var a=new Array();var d=0;for(var c=0;c<this.translationsArray.length;c++){var e=this.translationsArray[c];
if(e.isTranslated){b.push(e.text)}else{a.push({key:this.failuresArray[d],translation:f[d],isKeyNumeric:false,provider:ISQ.Translation.Infra.provider});b.push(f[d++])}}ISQ.Translation.Service.ServerDictionary.addTranslations(a,this.toLanguage);this.handler.handle(b);this.dispose()};ISQ.Translation.Service.ServerDictionary=ISQ.Base.extend({name:"ISQ.Translation.Service.ServerDictionary"});ISQ.Translation.Service.ServerDictionary.prototype.ctor=function(a){if(a.textsArray==0||!a.language){throw"ISQ.Translation.Service.ServerDictionary.ctor: invalid arguments"}this.textsArray=a.textsArray;this.handler=a.handler;this.language=ISQ.Tools.getUniformLanguageCode(a.language);this.lookup()};ISQ.Translation.Service.ServerDictionary.prototype.dtor=function(){};ISQ.Translation.Service.ServerDictionary.prototype.textsArray;ISQ.Translation.Service.ServerDictionary.prototype.handler;ISQ.Translation.Service.ServerDictionary.prototype.lookup=function(){var c=new Array();c.push("<translationCache language='");c.push(ISQ.Tools.getUniformLanguageCode(this.language));c.push("'>");for(var a=0;a<this.textsArray.length;a++){if(typeof(this.textsArray[a])!=="string"){continue}if(this.textsArray[a]==null){continue}var b=this.textsArray[a].Trim();if(b.length==0){continue}c.push("<get><![CDATA[");c.push(b);c.push("]]></get>")}c.push("</translationCache>");if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("TranslationHelper: performing server dictionary lookup")}_session().sendData(c.join(""),new Ajax.Token({callback:new ISQ.Handler(this.lookupCallback,this)}))};ISQ.Translation.Service.ServerDictionary.prototype.lookupCallback=function(f){if(f.type!==Ajax.responseTypeEnum.OK){return}var k=f.xml.getElementsByTagName("translations")[0];var h=new Array();var a=new Array();var d=0;for(var b=0;b<this.textsArray.length;b++){var e=this.textsArray[b];if(typeof(e)!=="string"||e===null||e.Trim().length==0){h.push({text:"",isTranslated:true});continue}e=e.Trim();var g=k.childNodes[d++].childNodes[0].nodeValue;var c=g.length>0;h.push({text:g,isTranslated:c});
if(!c){a.push(this.textsArray[b])}}this.handler.handle(h,a)};ISQ.Translation.Service.ServerDictionary.addTranslations=function(a,e){if(!a||a.length==0||!e){return}var h=new Array();h.push("<translationCache language='");h.push(ISQ.Tools.getUniformLanguageCode(e));h.push("'>");for(var b=0;b<a.length;b++){var d=a[b].key.Trim();var g=a[b].translation;var f=a[b].provider;if(!g){continue}g=g.Trim();var c=a[b].isKeyNumeric;if(d.length==0||g.length==0){continue}h.push("<add>");h.push("<key");if(c){h.push(" isNumeric='True'")}h.push("><![CDATA[");h.push(d);h.push("]]></key>");h.push("<translation><![CDATA[");h.push(g);h.push("]]></translation>");h.push("<provider>");h.push(f);h.push("</provider>");h.push("</add>")}h.push("</translationCache>");if(ISQ.Widget&&ISQ.Widget.Log){ISQ.Widget.Log.add("TranslationHelper: sending server translations to add")}_session().sendData(h.join(""))};</script>
    <script type="text/javascript">ISQ.Widget.TranslationHelper={};ISQ.Widget.TranslationHelper.staticTexts;ISQ.Widget.TranslationHelper.staticTranslations=new Array();ISQ.Widget.TranslationHelper.staticTranslationsEnum={footer:[0,"footer"],searchMsgNOResults:[1,"searchMsgNOResults"],searchMsgResults:[2,"searchMsgResults"],newSearch:[3,"newSearch"],askBy:[4,"askBy"],email:[5,"email"],chat:[6,"chat"],translating:[7,"translating"],translatedFrom:[8,"translatedFrom"]};ISQ.Widget.TranslationHelper.defaultLanguage=null;ISQ.Widget.TranslationHelper.languageEnabled=null;ISQ.Widget.TranslationHelper.detectedLanguage=null;ISQ.Widget.TranslationHelper.enabledLanguages;ISQ.Widget.TranslationHelper.detectionOnlyMode=false;ISQ.Widget.TranslationHelper.allLanguagesEnabled=false;ISQ.Widget.TranslationHelper.lastQueryText=null;ISQ.Widget.TranslationHelper.currentQueryTranslator=null;ISQ.Widget.TranslationHelper.currentAnswersTranslator=null;ISQ.Widget.TranslationHelper.StaticTranslation=ISQ.Base.extend({name:"ISQ.Widget.TranslationHelper.StaticTranslation"});ISQ.Widget.TranslationHelper.StaticTranslation.prototype.ctor=function(a){this.language=a;this.dictionary=new Array();this.pending=true;this.handler=null};ISQ.Widget.TranslationHelper.StaticTranslation.prototype.dtor=function(){};ISQ.Widget.TranslationHelper.StaticTranslation.prototype.language;ISQ.Widget.TranslationHelper.StaticTranslation.prototype.dictionary;ISQ.Widget.TranslationHelper.StaticTranslation.prototype.pending;ISQ.Widget.TranslationHelper.StaticTranslation.prototype.handler;ISQ.Widget.TranslationHelper.Answer=ISQ.Base.extend({name:"ISQ.Widget.TranslationHelper.Answer"});ISQ.Widget.TranslationHelper.Answer.prototype.ctor=function(a){this.id=a.id;this.title=a.title;this.summary=a.summary;this.extraInfo=a.extraInfo||null;this.sourceLanguage=a.sourceLanguage||null;this.provider=typeof(a.provider)!=="undefined"&&a.provider!==null?a.provider:null;this.skipSummary=a.skipSummary||false;this.failed=false;this.context=a.context||null;this.isCachedTranslation=a.isCachedTranslation||false;this.translatedTitle=a.translatedTitle;
this.translatedSummary=a.translatedSummary};ISQ.Widget.TranslationHelper.Answer.prototype.dtor=function(){};ISQ.Widget.TranslationHelper.Answer.prototype.id;ISQ.Widget.TranslationHelper.Answer.prototype.title;ISQ.Widget.TranslationHelper.Answer.prototype.summary;ISQ.Widget.TranslationHelper.Answer.prototype.extraInfo;ISQ.Widget.TranslationHelper.Answer.prototype.handler;ISQ.Widget.TranslationHelper.Answer.prototype.sourceLanguage;ISQ.Widget.TranslationHelper.Answer.prototype.skipSummary;ISQ.Widget.TranslationHelper.Answer.prototype.queryId;ISQ.Widget.TranslationHelper.Answer.prototype.translatedSummary;ISQ.Widget.TranslationHelper.Answer.prototype.translatedTitle;ISQ.Widget.TranslationHelper.Answer.prototype.isCachedTranslation;ISQ.Widget.TranslationHelper.Answer.prototype.failed;ISQ.Widget.TranslationHelper.Answer.prototype.provider;ISQ.Widget.TranslationHelper.Answer.prototype.context;ISQ.Widget.TranslationHelper.Answer.prototype.setHandler=function(a,b){if(!ISQ.Base.isDerivedOf(a,ISQ.Handler)){throw ("ISQ.Widget.TranslationHelper.Answer.setHandler: invalid handler")}this.handler=a;this.queryId=b};ISQ.Widget.TranslationHelper.Answer.prototype.translate=function(){if(!ISQ.Widget.TranslationHelper.detectedLanguage){this.handler.handle();return}if(this.title){ISQ.Translation.Infra.translate(this.title,this.sourceLanguage,ISQ.Widget.TranslationHelper.detectedLanguage,new ISQ.Handler(this.titleTranslateComplete,this),ISQ.Translation.Infra.contentTypeEnum.HTML,this.queryId)}if(this.summary&&!this.skipSummary){ISQ.Translation.Infra.translate(this.summary,this.sourceLanguage,ISQ.Widget.TranslationHelper.detectedLanguage,new ISQ.Handler(this.summaryTranslateComplete,this),ISQ.Translation.Infra.contentTypeEnum.HTML,this.queryId)}};ISQ.Widget.TranslationHelper.Answer.prototype.titleTranslateComplete=function(a){if(this.mIsDisposed){return}this.translatedTitle=a;this.provider=ISQ.Translation.Infra.provider;this.translateDone()};ISQ.Widget.TranslationHelper.Answer.prototype.summaryTranslateComplete=function(a){if(this.mIsDisposed){return
}this.translatedSummary=a;this.provider=ISQ.Translation.Infra.provider;this.translateDone()};ISQ.Widget.TranslationHelper.Answer.prototype.translateDone=function(){if((this.translatedTitle||!this.title)&&(this.translatedSummary||!this.summary||this.skipSummary)){this.handler.handle()}};ISQ.Widget.TranslationHelper.AnswersTranslator=ISQ.Base.extend({name:"ISQ.Widget.TranslationHelper.AnswersTranslator"});ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.ctor=function(a){if(!a.answers||a.answers.length==0){return}if(!ISQ.Base.isDerivedOf(a.handler,ISQ.Handler)){throw ("ISQ.Widget.TranslationHelper.AnswersTranslator.ctor: invalid handler")}if(typeof(a.queryId)!=="number"){throw ("ISQ.Widget.TranslationHelper.AnswersTranslator.ctor: invalid queryId")}this.answers=a.answers;this.handler=a.handler;this.queryId=a.queryId;this.completedAnswers=0;if(ISQ.Widget.TranslationHelper.currentAnswersTranslator){ISQ.Translation.Infra.addBatchToCancelList(ISQ.Widget.TranslationHelper.currentAnswersTranslator.queryId);ISQ.Widget.TranslationHelper.currentAnswersTranslator.dispose()}ISQ.Widget.TranslationHelper.currentAnswersTranslator=this;this.translate()};ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.dtor=function(){for(var a=0;a<this.answers.length;a++){this.answers[a].dispose()}};ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.answers;ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.handler;ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.queryId;ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.completedAnswers;ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.translate=function(){ISQ.Widget.Log.add("TranslationHelper: translating answers");for(var b=0;!this.mIsDisposed&&b<this.answers.length;b++){var a=this.answers[b];if(a.isCachedTranslation){this.answerTranslateComplete()}else{a.setHandler(new ISQ.Handler(this.answerTranslateComplete,this),this.queryId);a.translate()}}};ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.answerTranslateComplete=function(){if(this!==ISQ.Widget.TranslationHelper.currentAnswersTranslator){return
}if(++this.completedAnswers<this.answers.length){return}this.handler.handle(this.answers,this.queryId);this.dispose();ISQ.Widget.TranslationHelper.currentAnswersTranslator=null};ISQ.Widget.TranslationHelper.AnswersTranslator.prototype.translationFailed=function(){for(var b=0;!this.mIsDisposed&&b<this.answers.length;b++){var a=this.answers[b];a.failed=true}if(this.handler){this.handler.handle(this.answers)}this.dispose();ISQ.Widget.TranslationHelper.currentAnswersTranslator=null};ISQ.Widget.TranslationHelper.QueryTranslator=ISQ.Base.extend({name:"ISQ.Widget.TranslationHelper.QueryTranslator"});ISQ.Widget.TranslationHelper.QueryTranslator.prototype.ctor=function(a){if(typeof(a.queryId)!=="number"){throw ("ISQ.Widget.TranslationHelper.QueryTranslator.ctor: invalid queryId")}this.query=a.query;this.handler=a.handler;this.queryId=a.queryId;if(ISQ.Widget.TranslationHelper.currentQueryTranslator){ISQ.Translation.Infra.addBatchToCancelList(ISQ.Widget.TranslationHelper.currentQueryTranslator.queryId);if(!ISQ.Widget.TranslationHelper.currentQueryTranslator.translatingStaticTexts){ISQ.Widget.TranslationHelper.currentQueryTranslator.dispose()}}ISQ.Widget.TranslationHelper.currentQueryTranslator=this;this.translate()};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.dtor=function(){};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.language=null;ISQ.Widget.TranslationHelper.QueryTranslator.prototype.handler=null;ISQ.Widget.TranslationHelper.QueryTranslator.prototype.query=null;ISQ.Widget.TranslationHelper.QueryTranslator.prototype.queryId=null;ISQ.Widget.TranslationHelper.QueryTranslator.prototype.translatedQuery=null;ISQ.Widget.TranslationHelper.QueryTranslator.prototype.translatingStaticTexts=false;ISQ.Widget.TranslationHelper.QueryTranslator.prototype.queryAltered=false;ISQ.Widget.TranslationHelper.QueryTranslator.prototype.translate=function(){var a=ISQ.Widget.TranslationHelper.lastQueryText;ISQ.Widget.TranslationHelper.lastQueryText=this.query;if(!ISQ.Widget.TranslationHelper.detectedLanguage||(a!=null&&(!this.query.startsWith(a)||ISQ.Widget.TranslationHelper.countWords(a)<3))){ISQ.Widget.Log.add("QueryTranslator: detecting language");
new ISQ.Translation.Infra.Detector({string:this.query,handler:new ISQ.Handler(this.languageDetectionComplete,this)});return}else{this.language=ISQ.Widget.TranslationHelper.detectedLanguage}this.afterlanguageDetection()};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.languageDetectionComplete=function(a){if(this!==ISQ.Widget.TranslationHelper.currentQueryTranslator){return}if(!a){this.handler.handle(this.query,this.queryId);return}ISQ.Widget.Log.add("QueryTranslator: language detected: "+a);ISQ.Widget.TranslationHelper.detectedLanguage=this.language=a;this.afterlanguageDetection()};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.afterlanguageDetection=function(){if(ISQ.Tools.getUniformLanguageCode(this.language)==ISQ.Widget.TranslationHelper.defaultLanguage){this.handler.handle(this.query,this.queryId,null,ISQ.Widget.TranslationHelper.defaultLanguage);return}if(!ISQ.Widget.TranslationHelper.isLanguageEnabled(this.language)){ISQ.Widget.TranslationHelper.languageEnabled=false;this.handler.handle(this.query,this.queryId,null,ISQ.Widget.TranslationHelper.defaultLanguage);return}ISQ.Widget.TranslationHelper.languageEnabled=true;if(ISQ.Widget.TranslationHelper.detectionOnlyMode){this.handler.handle(this.query,this.queryId,"",this.language);return}var a=ISQ.Tools.getUniformLanguageCode(this.language);if(ISQ.Widget.TranslationHelper.staticTranslations[a]!=null){var b=ISQ.Widget.TranslationHelper.staticTranslations[a];if(b.pending){b.handler=new ISQ.Handler(this.loadHandler,this);this.translateQuery();return}this.translateQuery();return}ISQ.Widget.Log.add("QueryTranslator: translating static texts and query");this.translatingStaticTexts=true;this.translateStaticTexts();this.translateQuery()};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.translateStaticTexts=function(){var e=ISQ.Tools.getUniformLanguageCode(this.language);var f=new ISQ.Widget.TranslationHelper.StaticTranslation(e);ISQ.Widget.TranslationHelper.staticTranslations[e]=f;var a=new Array();for(var b in ISQ.Widget.TranslationHelper.staticTexts){a.push(ISQ.Widget.TranslationHelper.staticTexts[b])
}if(ISQ.Widget.Texts[e]){for(var b in ISQ.Widget.TranslationHelper.staticTranslationsEnum){var c=ISQ.Widget.TranslationHelper.staticTranslationsEnum[b][0];var d=ISQ.Widget.TranslationHelper.staticTranslationsEnum[b][1];var g=ISQ.Widget.Texts[e][d];if(g){f.dictionary[d]=g;a[c]=null}}}new ISQ.Translation.Service.CachedTranslator({fromLanguage:ISQ.Widget.TranslationHelper.defaultLanguage,toLanguage:this.language,handler:new ISQ.Handler(this.staticTranslationsComplete,this),textsArray:a})};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.staticTranslationsComplete=function(e){ISQ.Widget.Log.add("QueryTranslator: static texts response received: ("+this.language+")");var c=ISQ.Tools.getUniformLanguageCode(this.language);var d=ISQ.Widget.TranslationHelper.staticTranslations[c];for(var a=0;a<e.length;a++){if(!e[a]){continue}for(var b in ISQ.Widget.TranslationHelper.staticTranslationsEnum){if(ISQ.Widget.TranslationHelper.staticTranslationsEnum[b][0]==a){d.dictionary[ISQ.Widget.TranslationHelper.staticTranslationsEnum[b][1]]=e[a];break}}}d.pending=false;if(this!==ISQ.Widget.TranslationHelper.currentQueryTranslator){if(d.handler){d.handler.handle();d.handler.dispose();d.handler=null}this.dispose();return}ISQ.Widget.Log.add("QueryTranslator: static texts firing load handler");this.loadHandler()};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.translateQuery=function(){ISQ.Widget.Log.add("QueryTranslator: translating query");if(this.query.contains("&")){var a=this.query.replace(/&/g,"&amp;");this.queryAltered=true;return ISQ.Translation.Infra.translate(a,this.language,ISQ.Widget.TranslationHelper.defaultLanguage,new ISQ.Handler(this.queryTranslationComplete,this),ISQ.Translation.Infra.contentTypeEnum.HTML,this.queryId)}else{return ISQ.Translation.Infra.translate(this.query,this.language,ISQ.Widget.TranslationHelper.defaultLanguage,new ISQ.Handler(this.queryTranslationComplete,this),null,this.queryId)}};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.queryTranslationComplete=function(a){this.translatedQuery=a;
if(this.queryAltered){this.translatedQuery=this.translatedQuery.replace(/&amp;/g,"&")}this.loadHandler()};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.loadHandler=function(){if(this!==ISQ.Widget.TranslationHelper.currentQueryTranslator){return}var a=ISQ.Widget.TranslationHelper.staticTranslations[ISQ.Tools.getUniformLanguageCode(this.language)];if(!a||a.pending){return}if(this.translatedQuery===null){return}this.handler.handle(this.query,this.queryId,this.translatedQuery,this.language);this.dispose();ISQ.Widget.TranslationHelper.currentQueryTranslator=null};ISQ.Widget.TranslationHelper.QueryTranslator.prototype.translationFailed=function(){if(this.handler){this.handler.handle(this.query,this.queryId)}this.dispose();ISQ.Widget.TranslationHelper.currentQueryTranslator=null};ISQ.Widget.TranslationHelper.ContactFormTranslator=ISQ.Base.extend({name:"ISQ.Widget.TranslationHelper.ContactFormTranslator"});ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.ctor=function(a){if(!ISQ.Base.isDerivedOf(a.handler,ISQ.Handler)){throw ("ISQ.Widget.TranslationHelper.ContactFormTranslator.ctor: invalid handler")}if(!a.xmlNode){throw ("ISQ.Widget.TranslationHelper.ContactFormTranslator.ctor: xmlNode object must be specified")}this.handler=a.handler;this.xmlNode=a.xmlNode;this.fromLanguage=a.fromLanguage||null;this.toLanguage=ISQ.Widget.TranslationHelper.detectedLanguage;this.translate()};ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.dtor=function(){};ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.contactForm;ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.handler;ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.fromLanguage;ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.toLanguage;ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.translate=function(){var a=new Array();this.getNodeValues(this.xmlNode,a);if(a.length>0){new ISQ.Translation.Service.CachedTranslator({fromLanguage:this.fromLanguage,toLanguage:this.toLanguage,handler:new ISQ.Handler(this.translateCallback,this),textsArray:a})
}else{this.handler.handle(this.xmlNode)}};ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.translateCallback=function(a){try{this.setNodeValues(this.xmlNode,a,0)}catch(b){ISQ.Widget.Log.add("ContactFormTranslator exception in setNodeValues: "+b,ISQ.Widget.Log.statusEnum.RED)}this.handler.handle(this.xmlNode)};ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.getNodeValues=function(d,a){for(var c=0;c<d.childNodes.length;c++){var b=d.childNodes[c];if(b.nodeValue!==null&&b.nodeValue.length!==0){if(c===0&&d.nodeName==="item"&&d.getAttribute("type")==="field"){continue}a.push(b.nodeValue)}this.getNodeValues(b,a)}};ISQ.Widget.TranslationHelper.ContactFormTranslator.prototype.setNodeValues=function(e,a,d){for(var c=0;c<e.childNodes.length;c++){var b=e.childNodes[c];if(b.nodeValue!==null&&b.nodeValue.length!==0){if(c===0&&e.nodeName==="item"&&e.getAttribute("type")==="field"){continue}b.nodeValue=a[d++].Trim()}d=this.setNodeValues(b,a,d)}return d};ISQ.Widget.TranslationHelper.SubmittedFormTranslator=ISQ.Base.extend({name:"ISQ.Widget.TranslationHelper.SubmittedFormTranslator"});ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.ctor=function(b){if(!ISQ.Base.isDerivedOf(b.handler,ISQ.Handler)){throw ("ISQ.Widget.TranslationHelper.SubmittedFormTranslator.ctor: invalid handler")}if(!b.toLanguage){throw ("ISQ.Widget.TranslationHelper.SubmittedFormTranslator.ctor: toLanguage must be specified")}if(!b.contactForm){throw ("ISQ.Widget.TranslationHelper.SubmittedFormTranslator.ctor: contactForm object must be specified")}this.handler=b.handler;this.contactForm=b.contactForm;this.toLanguage=b.toLanguage;this.fromLanguage=b.fromLanguage||null;for(var a in this.contactForm.values){if(this.contactForm.values[a].name.toLowerCase()=="subject"){this.subject=this.contactForm.values[a].value}else{if(this.contactForm.values[a].name.toLowerCase()=="messagebody"){this.messageBody=this.contactForm.values[a].value}}}if(!this.subject){this.subject=b.question;this.contactForm.values.push({name:"subject",type:"subject",value:this.subject})
}this.translate()};ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.dtor=function(){};ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.contactForm;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.subject;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.messageBody;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.handler;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.fromLanguage;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.toLanguage;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.translatedSubject;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.translatedMessageBody;ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.translate=function(){ISQ.Widget.Log.add("TranslationHelper: translating contact form");ISQ.Translation.Infra.translate(this.subject,this.fromLanguage,this.toLanguage,new ISQ.Handler(this.subjectTranslateComplete,this));if(this.messageBody){ISQ.Translation.Infra.translate(this.messageBody,this.fromLanguage,this.toLanguage,new ISQ.Handler(this.messageBodyTranslateComplete,this))}};ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.subjectTranslateComplete=function(a){if(this.mIsDisposed){return}this.translatedSubject=a;this.translateDone()};ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.messageBodyTranslateComplete=function(a){if(this.mIsDisposed){return}this.translatedMessageBody=a;this.translateDone()};ISQ.Widget.TranslationHelper.SubmittedFormTranslator.prototype.translateDone=function(){if((this.subject&&!this.translatedSubject)||(this.messageBody&&!this.translatedMessageBody)){return}this.contactForm.translated=true;for(var a in this.contactForm.values){if(this.contactForm.values[a].name.toLowerCase()=="subject"){this.contactForm.values[a].type="originalSubject"}else{if(this.contactForm.values[a].name.toLowerCase()=="messagebody"){this.contactForm.values[a].type="originalTextArea"}}}this.contactForm.values.push({name:"subject",value:(this.translatedSubject||""),type:"subject"});
this.contactForm.values.push({name:"messageBody",value:(this.translatedMessageBody||""),type:"textArea"});this.handler.handle(this.contactForm,true);this.dispose()};ISQ.Widget.TranslationHelper.init=function(e,b,a,d,c){ISQ.Widget.TranslationHelper.staticTexts=e;ISQ.Widget.TranslationHelper.defaultLanguage=b;ISQ.Widget.TranslationHelper.setEnabledLanguages(d);ISQ.Widget.TranslationHelper.detectionOnlyMode=c;ISQ.Translation.Infra.init(a)};ISQ.Widget.TranslationHelper.getStaticTranslation=function(c,a){a=a||ISQ.Tools.getUniformLanguageCode(ISQ.Widget.TranslationHelper.detectedLanguage);var b=ISQ.Widget.TranslationHelper.staticTranslations[a];if(!b){return null}return b.dictionary[c[1]]};ISQ.Widget.TranslationHelper.setEnabledLanguages=function(a){if(!a){throw ("ISQ.Widget.TranslationHelper.init: no languages enabled.")}if(a.toLowerCase()==="all"){ISQ.Widget.TranslationHelper.allLanguagesEnabled=true}else{var c=a.split(",");ISQ.Widget.TranslationHelper.enabledLanguages=new Array();for(var b=0;b<c.length;++b){var d=ISQ.Tools.getUniformLanguageCode(c[b]);ISQ.Widget.TranslationHelper.enabledLanguages[d]=true}}};ISQ.Widget.TranslationHelper.isLanguageEnabled=function(b){var a=ISQ.Tools.getUniformLanguageCode(b);if(!ISQ.Tools.Languages[a]){return false}if(ISQ.Widget.TranslationHelper.allLanguagesEnabled){return true}var c=a;return ISQ.Widget.TranslationHelper.enabledLanguages[c]===true};ISQ.Widget.TranslationHelper.countWords=function(a){if(!a||a.length===0){return 0}return a.split(" ").length};</script>
    <style type="text/css">html,body{height:100%;margin:0;padding:0;direction:ltr;overflow:hidden}body,table,td,input,textarea{font-size:12px;font-family:Arial}
input,textarea{outline:0;resize:none}img{border:0}h1,h2,h3,h4,h5,h6,tbody,div{margin:0;padding:0}
a,a:hover,a:focus,a:active{outline:0}#iframeContainer{position:absolute;top:0;left:0;z-index:-10;width:1px;height:1px}
.normal{font-size:12px}.large{font-size:13px}.bold{font-weight:bold}#widgetContainer{display:none;width:100%}
#widgetLoading{margin:15px 0 0 15px;direction:ltr}#widgetTitleWrapper{position:relative;width:100%;height:25px;line-height:25px}
#widgetTitleDecoration{position:absolute;width:100%;height:2px;top:0;left:0;background:#fff;opacity:.15;filter:alpha(opacity=15);-ms-filter:"alpha(opacity=15)";line-height:1px;font-size:0}
#widgetTitleLeft{display:none;float:left;width:0;height:100%}#widgetTitleRight{display:none;float:right;width:0;height:100%}
#widgetTitleText{float:left;width:85%;padding:0 5px;font-size:17px;font-weight:bold;overflow:hidden;white-space:nowrap}
#minimizeButton{float:right;width:13px;height:14px;line-height:0;cursor:pointer;margin:0;border-bottom:4px solid #FFF;font-size:0}
#minimizeButtonWrapper{float:right;margin:0;padding:0 5px 0 8px;width:15px}
#searchContainerWrapper{position:relative;text-align:center;height:28px}#searchContainerLeft{display:none;position:absolute;left:0;width:0;height:100%}
#searchContainerRight{display:none;position:absolute;right:0;width:0;height:100%}
#searchContainer{position:absolute;top:2px;bottom:2px;left:2px;right:2px;text-align:left;background-color:#FFF}
*html #searchContainer{width:expression(document.getElementById('searchContainerWrapper').clientWidth-5);height:expression(document.getElementById('searchContainerWrapper').clientHeight-5)}
#searchTextboxContainer{position:absolute;top:2px;bottom:2px;left:2px;right:25px}
*html #searchTextboxContainer{width:expression(document.getElementById('searchContainerWrapper').clientWidth-28);height:expression(document.getElementById('searchContainerWrapper').clientHeight-4)}
#txtSearch{margin-top:2px;padding-left:5px;width:98%;height:17px;border:0;font-size:14px;vertical-align:middle}
input,input:focus,textarea,textarea:focus{outline:0 none;outline-width:0;-webkit-tap-highlight-color:rgba(255,255,255,0)}
#txtSearch.apple{margin-top:1px;height:15px;border:0}#txtSearch.initialText{font-size:13px;font-style:italic;color:#ccc}
DIV.searchAnim{float:right;margin:2px 0 0 5px;width:20px;height:18px;display:block;border:0;background:transparent}
DIV.searchAnim DIV{float:left;height:4px;width:4px;margin:7px 2px 0 0;background:#000;line-height:1px;font-size:1px}
DIV.searchAnimTranslating{padding:0 0 0 1px;height:19px;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -68px}
#contentAreaWrapper{overflow:auto;overflow-x:hidden;overflow-y:auto;background-color:#FFF;width:100%}
#contentAreaWrapper.empty{padding:0}#contentArea{width:100%}#resultsHint{padding:2px 5px 0 5px;font-style:italic;display:none;overflow:hidden}
#answerPane{padding-top:10px;padding-bottom:10px;padding-left:7px;padding-right:7px;display:none}
.answerTable{width:100%;margin:0 0 20px 0;table-layout:fixed}.answerTable TR{vertical-align:top}
.answerTable TD A,.answerBackLinkContainer A{color:#e9682d}.answerIcon{text-align:right;width:16px}
.answerTitle{font-size:13px;font-weight:bold}.answerContextContainer{margin-top:2px}
.answerContext{font-size:11px;font-weight:normal;color:#aaa;margin-right:5px}
.answerBody{padding:5px 0 0 0}A.thumbUp{float:right;display:block;width:16px;height:19px;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 0;text-decoration:none}
A.thumbUpApplied{float:right;display:block;width:16px;height:19px;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -23px;text-decoration:none}
A.translationIcon{float:right;display:block;width:19px;height:19px;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -45px;text-decoration:none}
A.translationIconOff{float:right;display:block;width:19px;height:19px;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -68px;text-decoration:none}
.answerFooter{padding:15px 0 0 0}.answerBackLinkContainer{padding:0 0 4px 0}
.chatInviteDiv{width:100%;text-align:center;cursor:pointer}#contactForm{display:none}
#actionBarWrapper{width:100%;display:none;height:27px;font-weight:bold;font-size:13px;background-color:#FFF}
#actionBarContainer{height:100%;background-color:inherit}.actionBar{padding-top:5px;padding-right:5px;padding-left:5px}
.actionBar A,.actionBar A:visited{text-decoration:none}.actionBarText{float:left;margin-right:15px}
.actionBarSep{width:26px;text-align:center;float:left}#actionBarContainer{direction:ltr}
#actionBarQuery A,#actionBarChat A{display:block;float:left}.repByEmail{text-align:right;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -111px;padding:0 0 0 24px}
.noActionBarIcon{background:0}.repByChat,.customChat{text-align:right;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -128px;padding:0 0 0 24px}
#widgetFooterWrapper{position:relative;width:100%}.widgetFooterDecoration{background:#fff;height:2px;opacity:.25;filter:alpha(opacity=25);-ms-filter:"alpha(opacity=25)";width:100%;position:absolute;bottom:0;left:0;font-size:0;line-height:1px}
#widgetFooter{height:20px;padding:0 5px;line-height:19px;font-size:11px;vertical-align:middle}
#widgetMinimizedFooter{display:none;height:4px;font-size:0;position:relative}
#widgetFooter A,#widgetFooter A:visited{text-decoration:none}#customerLogo,#customerBrandingText{display:none;float:left}
#footerChatLink{display:none;float:left;cursor:default}#footerNanoRepLink{float:right}
#chatStatusWrapper{display:none;width:100%}#chatStatusContainer{height:37px;font-size:12px;padding:0 0 0 10px;line-height:37px}
#chatStatus{float:left;width:70%;white-space:nowrap;overflow:hidden}#chatStatusIcon{float:left;height:18px;width:22px;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat right -128px;margin:11px 3px 0 0}
#chatStatusContainer.chatStatusContainerMinimized{height:28px;line-height:28px}
#chatStatusContainer.chatStatusContainerMinimized #chatStatusIcon{margin-top:6px}
#chatStatusContainer.chatStatusContainerMinimized #chatStatus{width:80%}.chatStatusAgentName{font-weight:bold}
#closeChat{float:right;width:69px;white-space:nowrap;overflow:hidden;font-size:12px}
#chatPane{display:none;line-height:150%;font-size:13px;padding:5px 10px 10px}
#actionBarChat,#actionBarChatSurvey{display:none}#chatInputWrapper{position:relative;display:none;height:52px;padding-top:3px}
#chatInputContainer{height:46px;padding:3px 0 0 0;margin:0 3px 0;background-color:#FFF}
#txtChatInput{width:77%;height:40px;float:left;border:0;resize:none;overflow:auto;font-size:13px;margin:0 0 0 5px;border:0}
#btnSendChat{height:30px;float:right;margin:6px 3px 0 0}#chatPane .padded{padding:0 0 5px 0}
#chatPane .chatSysMsg{font-style:italic;color:#aaa}#chatPane .chatAgentName{font-weight:bold;color:#13469F}
#emailChatContainer{width:100%;margin-top:-2px;display:none}#txtEmailChat{float:left;width:130px;height:15px}
#ancEmailChatSend,#ancEmailChatCancel{display:block;float:left;margin:2px 0 0 7px}
#chatSuggestions{display:none;position:absolute;width:98%;top:54px;left:3px;overflow:hidden;z-index:10;opacity:.95;filter:alpha(opacity=95);-ms-filter:"alpha(opacity=95)"}
.chatSuggestion{overflow:hidden;padding:3px 5px 2px;cursor:pointer}.quickAnswerHeading{font-style:italic;padding:2px 0 4px 0}
.quickAnswerTitle{font-weight:bold;padding:0 0 2px 5px;font-size:13px}.quickAnswerExpand{width:12px;height:12px;margin:4px 0 0 0;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -183px}
.quickAnswerCollapsed{background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -149px}
.quickAnswerBody{padding:0 0 0 15px;margin:0 0 0 6px;border-left:solid 1px}
.translationTooltip{position:absolute;top:0;left:0;padding:3px;font-size:11px;visibility:hidden}
.translationTooltip P{margin:0}.answerSourceIcon{display:block;width:21px;height:15px;background-repeat:no-repeat}
.twitterSourceIcon{background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -92px}
#customLink{display:none}ul.attachments{margin:0;padding:10px 0 0 10px}ul.attachments li{list-style:none;min-height:18px;margin:4px 0 0 0;padding:0 0 0 23px;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -222px}
#logoInCollapsedMode{display:none}.link_nano{color:#346a7a}.link_rep{color:#315552}
#widgetBlocker{display:none;position:absolute;top:0;left:0;width:100%;height:100%}
#blockerOverlay{position:absolute;top:0;left:0;width:100%;height:100%;background:#fff;opacity:.4;filter:alpha(opacity=40);-ms-filter:"alpha(opacity=40)"}
#blockerContent{position:absolute;left:50%;top:50%;width:121px;height:20px;padding:10px;margin:-59px 0 0 -60px;color:#000;background-color:#c0c0c0;text-align:center;direction:ltr;z-index:1;border-radius:5px 5px 5px 5px;-moz-border-radius:5px 5px 5px 5px}
.surveyLoading{position:absolute;left:50%;top:50%;width:142px;height:20px;margin:-11px 0 0 -58px;font-size:16px}
.surveyLoading .searchAnim{float:left;margin:-1px 0 0 5px}.surveyLoading .searchAnim DIV{float:left;height:13px;width:4px;margin:5px 2px 0 0;background:#000;line-height:1px;font-size:1px}
#actionBarChatSurvey{width:100%;padding-top:7px}INPUT.inputTxt,TEXTAREA.inputTxt{border:solid 1px #c0c0c0;width:155px}
SELECT.surveySelect{width:155px}.mandatory{color:#A00;font-size:15px}.surveryHeading{font-size:13px;font-weight:bold;margin:0 0 10px 0}
TD.question{width:155px;font-weight:bold;vertical-align:top}#chatSurveySubmitButton{border-radius:5px;-moz-border-radius:5px;padding:3px 22px 3px 20px;margin:0;background:#1A85D5;color:white}
#chatSurveyCloseButton{border-radius:5px;-moz-border-radius:5px;padding:3px 15px;margin:0;background:#777;color:white;margin-right:15px}
.validationError TR TD{background-color:#a00;color:#fff}.validationError .mandatory{color:#fff}
A#mobileBackBtn{background:none repeat scroll 0 0 #FFF;border:1px solid #BBB;border-radius:4px;color:#000;font-size:12px;opacity:.6;padding:3px 3px 1px 3px;text-decoration:none}
A#mobileLink{display:none;text-decoration:none;position:absolute;top:0;left:0;z-index:1}
#mobileScrollPadding{width:100%;display:none}#debugPopup{position:absolute;top:0;left:0;width:130px;border:1px solid #aaa;background:#f8f8f8;display:none;padding:2px;direction:ltr;text-align:left;z-index:5}
#debugPopup A{color:#07c;padding:1px;text-decoration:none;font-size:10px;display:block}</style>
    <style type="text/css">html.rtl_css_file{direction:rtl}html,body{direction:rtl}#widgetTitleText{float:right}
#minimizeButtonWrapper,#minimizeButton{float:left}#searchContainer{text-align:right}
#searchTextboxContainer{right:2px;left:25px}#txtSearch{padding-left:0;padding-right:5px}
DIV.searchAnim{float:left;margin:2px 5px 0 0}DIV.searchAnim DIV{margin:7px 0 0 2px}
DIV.searchAnimTranslating{padding:0 4px 0 0}#contentAreaWrapper{direction:rtl}
#answerPane{padding-left:7px;padding-right:7px}.answerIcon{text-align:left}
A.thumbUp{float:left}#chatStatusContainer{padding:0 10px 0 0}#chatStatus{float:right}
#chatStatusIcon{float:right;margin:11px 0 0 3px}#closeChat{float:left}#actionBarChat{text-align:left}
#txtChatInput{margin:0 5px 0 0;float:right}#btnSendChat{float:left;margin:6px 0 0 3px}
.quickAnswerTitle{padding:0 5px 0 0}.quickAnswerCollapsed{background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat 0 -164px}
.quickAnswerBody{border-left:none;border-right:solid 1px;padding:0 15px 0 0;margin:0 7px 0 0}
ul.attachments li{padding:0 23px 0 0;background:url(/widget/skins/sprites.gif?cv=8cf227528551579) no-repeat right -222px}</style>
    <style type="text/css">html.dynamic_rtl_css_file{direction:rtl}.actionBarText{float:right;margin-right:0;margin-left:15px}
.actionBarSep{float:right}#actionBarQuery{direction:rtl}#actionBarQuery A,#actionBarChat A{float:right}
.actionBar A,.actionBar A:visited{text-align:left}.repByEmail{background-position:right -111px;padding:0 26px 0 0}
.repByChat,.customChat{background-position:right -128px;padding:0 27px 0 0;margin-right:-6px}
#txtEmailChat{float:right}#ancEmailChatSend,#ancEmailChatCancel{float:right;margin:2px 7px 0 0}</style>
<style type="text/css">/* widget title */
#widgetTitleWrapper {
    background-color:#e9682d;
	-moz-border-radius: 5px 5px 0 0;
	-webkit-border-radius: 5px 5px 0 0;
	border-radius: 5px 5px 0 0;
}
#widgetTitleText {
    color:#FFF;      
}

/* search box */
#searchContainerWrapper {
    background-color: #ededed;    
}
#searchContainer {
    border:1px solid #dddddd;
}
#txtSearch {
    color:#666;
}

/* content area */
#contentAreaWrapper {
    color: #5F6061;
    border-right: 1px solid #F0F0F0;
    border-left: 1px solid #F0F0F0;
}

/* results hint */
#resultsHint {
    color:#b5b5b5;
}

/* answers */
.answerTitle {
    color:#00005a;    
}


/* action bar */
#actionBarWrapper {
    color:#5F6061;
    background-color: #F0F0F0;
}

.actionBar A,
.actionBar A:visited {
    color:#727070;
}

/* widget footer */
#widgetFooterWrapper {
    color:#FFF;    
    background-color:#e9682d;
	-moz-border-radius: 0 0 3px 3px;
	-webkit-border-radius: 0 0 3px 3px;
	border-radius: 0 0 3px 3px;
}
#widgetMinimizedFooter {
    background-color:#e9682d;
	-moz-border-radius: 0 0 3px 3px;
	-webkit-border-radius: 0 0 3px 3px;
	border-radius: 0 0 3px 3px;
}

#widgetFooter A,
#widgetFooter A:visited,
#widgetFooter A .link_nano,
#widgetFooter A .link_rep
{
    color:#FFF;
}

/* chat */
#chatStatusContainer {
    color:#5F6061;
    background-color: #F0F0F0;
}
#closeChat {
    color:#5F6061;
}
#chatInputWrapper {
    background-color: #F0F0F0;
}
#chatInputContainer {
    border:solid 1px #D8D6D6;
	border-radius:5px;
	-moz-border-radius: 5px;
}
#txtEmailChat {
    color:#666;
    border: 1px solid #D8D6D6;
}


/* chat suggestions */
#chatSuggestions {
    border:1px solid #D8D6D6;
    background:#fff;
}
.chatSuggestionHover {
    background: #DCE6F4;
}

/* chat quick answers */
.quickAnswer {
    color:#2D3F87;
}
.quickAnswerBody {
    border-left-color:#2D3F87;
}

/* translation tooltip */
.translationTooltip {
    border:solid 1px #c0c0c0;
    background-color: #f3f4f8;
}

/* logo in collapsed mode */
#logoInCollapsedMode
{
	position:absolute;
	top:29px;
	right:10px;
	left: auto;
}
#logoInCollapsedMode A
{
	font-weight:normal;
	font-size:16px;
	text-decoration:none;
	font-family:Times New Roman;
}
</style><style type="text/css">html.rtl_css_file {direction:rtl;/*keep this */}

#widgetTitleText {
	padding: 0px 10px 0 0;
}

#logoInCollapsedMode
{
	left:10px;
	right:auto;
}</style><style type="text/css">	 div#widgetTitleText {	 font-family: Arial;	 font-size: 16px;	 font-weight:bold;	 text-decoration:none;	 font-style:normal;	 color: White;}	 div#widgetTitleWrapper {	 background-color: #332773;}	 div#widgetFooterWrapper {	 background-color: #332773;}	 div#widgetMinimizedFooter {	 background-color: #332773;}	 td.answerTitle {	 font-family: Arial;	 font-size: 12px;	 font-weight:bold;	 text-decoration:none;	 font-style:normal;	 color: #00005A;}	 td.answerBody {	 font-family: Arial;	 font-size: 12px;	 font-weight:normal;	 text-decoration:none;	 font-style:normal;	 color: #333333;}	 .answerTable TD A, .answerBackLinkContainer A {	 color: #332773;}	 #customerBrandingText {	 font-family: Arial;	 font-size: 12px;	 font-weight:bold;	 text-decoration:none;	 font-style:normal;}</style></head>
<body onload="ISQ.Widget.init()" onunload="">
	
    <!-- widget container -->
    <div id="widgetContainer" style="display: block;">
        <!-- widget title -->
        <div id="widgetTitleWrapper">
            <div id="widgetTitleDecoration"></div>
            <div id="widgetTitleLeft"></div>
            <div id="widgetTitleText">  ?</div>
            <div id="widgetTitleRight"></div>
            <div id="minimizeButtonWrapper" onclick="ISQ.Widget.HTML.minimizeBtnClicked();" style="display: none;">
                <div id="minimizeButton">&nbsp;</div>
            </div>
        </div>
        <!-- /widget title -->

        <!-- chat status -->
        <div id="chatStatusWrapper">
            <div id="chatStatusContainer">
                <div id="chatStatusIcon"></div>
                <div id="chatStatus"></div>
                <a id="closeChat" onclick="ISQ.Widget.Chat.endChat();return false;" href="javascript:void(0);"></a> 
            </div>
        </div>
        <!-- /chat status -->

        <!-- search -->
        <div id="searchContainerWrapper">
            <div id="searchContainerLeft"></div>
            <div id="searchContainer"><div class=" searchAnim" style="display: none;"><div></div><div></div><div></div></div></div>
            <div id="searchTextboxContainer">
                <input type="text" id="txtSearch" maxlength="250" value="" onkeyup="ISQ.Widget.Query.keyUpHandler(event)" onkeypress="ISQ.Widget.Query.keyPressHandler(event)" onfocus="ISQ.Widget.Query.onFocusHandler(event)" onblur="ISQ.Widget.Query.onBlurHandler(event)" onclick="ISQ.Widget.Query.onclickHandler(event, true)" onkeydown="ISQ.Widget.Query.keyDownHandler(event)" onpaste="ISQ.Widget.Query.pasteHandler(event)" class=" initialText">
            </div>
            <div id="searchContainerRight"></div>
        </div>
        <!-- /search -->

        <!-- content area -->
        <div id="contentAreaWrapper" class="empty" style="height: 0px;">
            <div id="contentArea">
                <div id="answerPane" style="display: none;"></div>
                <div id="chatPane"></div>
                <div id="contactForm"></div>                
            </div>
            <div id="mobileScrollPadding"></div>
        </div>
        <!-- /content area -->

        <!-- chat input -->
        <div id="chatInputWrapper">
            <div id="chatInputContainer">
                <textarea id="txtChatInput" rows="2"></textarea>
                <input type="button" id="btnSendChat" onclick="ISQ.Widget.Chat.sendLine()">
            </div>
            <div id="chatSuggestions"></div>
        </div>
        <!-- /chat input -->

        <!-- action bar -->
        <div id="actionBarWrapper" style="display: none;">
            <div id="actionBarContainer" style="display: none;">
                <!-- query -->
                <div id="actionBarQuery" class="actionBar">
                    <div class="actionBarText" id="actionBarText"></div>
                    <a class="customLink" id="customLink" href="javascript:void(0)" onclick="if (this.target === &quot;_self&quot;) {_session().prepareToDie(false);} return ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.customEmail);"></a>
                    <a class="repByEmail" id="repByEmail" href="javascript:ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.email);"></a>
                    <div class="actionBarSep" id="actionBarSep">|</div>
                    <a class="customChat" id="customChat" href="javascript:void(0)" onclick="if (this.target === &quot;_self&quot;) {_session().prepareToDie(false);} return ISQ.Widget.Escalate.send(ISQ.Widget.Escalate.enumType.customChat, ISQ.Widget.enumChatEscalationActions.normal);"></a>
                    <a class="repByChat" id="repByChat" onclick="return ISQ.Widget.Chat.requestChat(false);" href="javascript:void(0);"></a>
                </div>
                <!-- chat -->
                <div id="actionBarChat" class="actionBar">
                    <!--<a href="javascript:void(0);">Print chat</a> 
                        <div class="actionBarSep" id='actionBarSep'>|</div>-->
                    <a id="emailChatLink" class="repByEmail" onclick="ISQ.Widget.Chat.emailChat_Show()" href="javascript:void(0);"></a>
                    <div id="emailChatContainer">
                        <input type="text" id="txtEmailChat" maxlength="60" onfocus="ISQ.Widget.Chat.emailChat_txtFocus()" onblur="ISQ.Widget.Chat.emailChat_txtBlur()">
                        <a id="ancEmailChatSend" onclick="ISQ.Widget.Chat.emailChat_Send()" href="javascript:void(0);"></a>
                        <a id="ancEmailChatCancel" onclick="ISQ.Widget.Chat.emailChat_Hide()" href="javascript:void(0);"></a>
                    </div>                    
                </div>
                <!-- chat survey -->
                <div id="actionBarChatSurvey" class="actionBar">
                    <table align="center" cellspacing="0" cellpadding="0">
                    <tbody><tr>
                        <td><a id="chatSurveyCloseButton" onclick="ISQ.Widget.Survey.closeSurvey();" href="javascript:void(0)"></a></td>
                        <td><a id="chatSurveySubmitButton" onclick="ISQ.Widget.Survey.submitSurvey()" href="javascript:void(0)"></a></td>
                    </tr>
                    </tbody></table>
                </div>
            </div>
        </div>
        <!-- /action bar -->
	
        <!-- widget footer -->
        <div id="widgetFooterWrapper" style="display: none;">
            <div class="widgetFooterDecoration"></div>
            <div id="widgetFooter">
                <img id="customerLogo" alt="">
                <div id="customerBrandingText"></div>
                <a id="footerNanoRepLink" target="_blank" href="http://www.nanorep.com/?s=poweredBy&aid=migdal"><i>powered by</i> <span class="large bold link_nano">nano</span><span class="large bold link_rep">Rep</span></a>
                <a id="footerChatLink" target="_blank" href="javascript:void(0);">Chat by <span class="normal bold">LivePerson</span></a>
            </div>
        </div>
        <div id="widgetMinimizedFooter" style="display: block;">
            <div class="widgetFooterDecoration"></div>
        </div>
        <!-- /widget footer -->

        <!-- blocker -->
        <div id="widgetBlocker">
            <div id="blockerOverlay"></div>
            <div id="blockerContent"></div>            
        </div>
        <!-- /blocker -->

    </div>
    <!-- widget container -->

    <!-- logo in collapsed mode -->
    <div id="logoInCollapsedMode" style="display: none;"><a href="http://www.nanorep.com/?s=logo&aid=migdal" id="nanoRepLogo_col" target="_blank" class="link_nano">nano<span class="link_rep">Rep</span></a></div>

    <!-- loading div -->
    <div id="widgetLoading" style="display: none;">
        Loading nanoRep...
    </div>

    <!-- debug popup -->
    <div id="debugPopup">
        <a href="javascript:void(0)" onclick="ISQ.Widget.Log.openPopup()">Open Log</a>
        <a href="javascript:void(0)" onclick="ISQ.Widget.Debug.closeSession()">Close session</a>
    </div>

    <!-- cdc iframe container -->
    <div id="iframeContainer"></div>


</body></html>